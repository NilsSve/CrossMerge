Use DfAllEnt.pkg
// COPYRIGHT (c) 2003-2012 RDC Tools International
//
// This program is free software; you can redistribute it and/or
// modify it under the terms of the GNU General Public License.

// This program is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.

// You should have received a copy of the GNU General Public License
// along with this program; (See the GPL.txt file in the Help directory) if not, write to the Free Software
// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.

//  Modifications:
//  ~~~~~~~~~~~~~
//  25/04/2012  PDC Commented out Set Client_ScrollBar_State to False as 
//                  oRdcView View is larger than size of oMain.
//Use RdsStartup.pkg
Compiler_Desktop_Method_Warnings On

Set_Attribute DF_HIGH_DATA_INTEGRITY to True
Send Ignore_Error of Error_Info_Object 4255 // "Can't load DLL"

Use Help_Ids.inc // Developer should provide this file of help context links.
Use cHtmlHelpNew.pkg
Use vsYNCconfirm.pkg  // Better data_loss message. Yes/No/Cancel.

Object oApplication is a cApplication
    Property Handle  phoSynchGrid 0 // Only set by the Engine program.
    Property Integer piUsers  1     // Will contain the decrypted max number of allowed concurrent users.
    Property String  psSerial ""    // Will contain the decrypted serial number from CrossMerge license file.
    Property String  psName   ""    // Decrypted license name.
    Property Integer piLicenseType 0
    Property String  psLicenseType "OPEN SOURCE VERSION"
    Property String  psActivationDaysText ""
    Property Integer piDaysLeft 0
    Property Integer piUserCode1 0
    Property Integer piUserCode2 0
    Property Boolean pbActivated False
    Property Integer piActivationDaysLeft 0
    Property Handle  phoLfile 0
    Property Handle  phoXmlHttpTransfer   0
    Property Handle  phoClient  0
    Property Handle  phoSDIView 0   // Set by SDI view object

    Set psCompany  to "RDC Tools International"
    Set psProduct  to "CrossMerge"
    Set psVersion  to "2012"
    Set psProgram  to "Builder"
    Set psHelpFile to "CrossMerge.chm"
    Set peHelpType to htHtmlHelp
    Set pbPreserveEnvironment to False //True

End_Object    

// Little trick to avoid that the Studio claims child objects cannot be modelled
{ DesignerClass = cDTView }
Class cPanel is a Panel
    Procedure Construct_Object
        Forward Send Construct_Object
        Set Locate_Mode to Center_On_Screen
    End_Procedure
End_Class

Use xxSoftwareKey.pkg     // Modified Software key plus software protection package.
Use Cli.pkg               // DAW CLI commands/functions for Connectivity kit drivers.
Use Working.pkg           // RDC "Working..." panel object
Use SyncFuncs.pkg         // Misc. global functions and other stuff.
Use ShellExecute.pkg      // Interface to Windows ShellExecute function for starting documents et.al via their file extention.
Use Start_UIExcl.pkg      // Do only allow one instance of this program running.

Object oMain is a cPanel
    Set Label to "CrossMerge Builder"
    Set Location to 4 3
    Set Size to 431 569

    // Rebar and toolbar properties:
    Property Handle  phoFindToolBar        0
    Property Handle  phoSearchToolBar      0
    Property Handle  phoSaveToolBar        0
    Property Handle  phoCutToolBar         0
    Property Handle  phoWizardToolBar      0
    Property Handle  phoConnectToolBar     0
    Property Handle  phoPropertiesToolBar  0
    Property Handle  phoFirst              0
    Property Handle  phoNext               0
    Property Handle  phoLast               0
    Property Handle  phoFind               0
    Property Handle  phoPrevious           0
    Property Handle  phoPrompt             0
    Property Handle  phoClear              0
    Property Handle  phoSave               0
    Property Handle  phoDelete             0
    Property Handle  phoCut                0
    Property Handle  phoCopy               0
    Property Handle  phoPaste              0
    Property Integer piVerRebar            0
    Property Integer piVerToolbar          0
    Property Integer piViewSize            0
    Property Integer piVerStatBar          0

Use RDCRebar.pkg  //  Tool-Bar object.
    //    Object oClientArea is a AppClientArea   
    //        Use Dd_debug.dg
Use ViewData.DG
Use Password.dg
Use DeletePassword.DG
Use RDCAboutNew.dg
Use Append.DG
Use PropertiesNew.DG

Use cControlPanel.pkg
Use Append.dg
Use cRDSDbView.pkg
Use cRDScImageList.pkg
Use cRDSDbTabDialog.pkg
Use cRDSDbTabPage.pkg
Use cRDSDbForm.pkg
Use cRDSDbCheckBox.pkg
Use cRDSDbGroup.pkg
Use cDbComboformFormat.pkg
Use cDbComboformServer.pkg
Use cRDSDbRadioGroup.pkg
Use cRDSRadio.pkg
Use cRDSTextbox.pkg
Use cFileDSNButton.pkg
Use cODBCAdminButton.pkg
Use cDbComboFormDatabase.pkg
Use cDbCheckBoxNtAuth.pkg
Use cDbFormUser.pkg
Use cDbFormPassword.pkg
Use cDbFormSchema.pkg
Use cLoginButton.pkg
Use cDbFormPath.pkg
Use cPathButton.pkg
Use cDbComboformDataTable.pkg
Use cViewDataButton.pkg
Use cRDSForm.pkg
Use cBitmapButton.pkg
Use cDbComboformDriver.pkg
Use cRDSDbComboForm.pkg
Use cRDSGrid.pkg
Use cDbFieldComboform.pkg
Use cParentFieldsTreeView.pkg
Use cChildFieldsTreeView.pkg
Use cDbIndexComboform.pkg
Use cRDSTreeView.pkg
Use cRDSComboForm.pkg
Use cRDSList.pkg
Use cRDSGroup.pkg
Use cRDSDbGrid.pkg
Use cRDSContainer3d.pkg
Use cRDSDbEdit.pkg
Use cSyncTableCheckBoxGrid.pkg
Use cSysDbCheckBox.pkg
Use cRDSDbList.pkg
Use cZeroLogBn.pkg
Use SNCSYS.DD
Use SNCTABLE.DD
Use SNCSCHEM.DD
Use SNCLOG.DD
Use SNCTHEA.DD
Use SNCTROW.DD

    //ACTIVATE_VIEW Activate_oRdcView FOR oRdcView

    //Object oRdcView is a cRDSDbView
    //Use LFFile.pkg // *** License check package ***
    //    Set Border_Style to Border_None
    Set Help_Id to GeneralHelpId
    //    Set Label to "CrossMerge Builder"
    //    Set Location to 0 0
    //    Set Size to 369 558
    //    Set piMinSize to 369 558
    //    Set phoSDIView of ghoApplication to Self
    //    Set peAnchors to anAll
    //    Delegate Set piViewSize to (GuiSize(Self)) // oMain property.
    
    Property Handle phoDD 0
    Property Handle phoSnctable_Recid 0

    Object Sncsys_DD is a Sncsys_DataDictionary
    End_Object    

    Object Snctable_DD is a SncTable_DataDictionary
        //Define MODE_WAITING  for 0  //wait-mode
        //Define MODE_FINDING  For 1  //find-mode
        //Define MODE_CLEARING For 2  //clear-mode
        //Define MODE_CREATING For 3  //create-mode
        //Define MODE_SAVING   For 4  //save-mode
        //Define MODE_DELETING For 5  //delete-mode
        //Define MODE_ABORTING For 6  //abort-mode
        //Define MODE_VALIDATING For 7  //request_validate-mode : added for VDF7
        //Define MODE_CLEARINGALL For 8 //clear-all mode (added in VDF8)

        Delegate Set phoDD to (Self)

        Procedure New_Current_Record Integer iOld Integer iNew
            Integer iState iFromFile iToFile

            Forward Send New_Current_Record iOld iNew
            If (Operation_Mode = Mode_Finding) Begin
                // This will be received by the cDbComboformFormat and cDbComboformServer classes.
                // and cDbComboformServer sends a message to cDbComboformDataTable to open
                // the tables and then update other DEO's:
                Broadcast Recursive Send DoFindData of (Parent(Self))
            End  
        End_Procedure  

        // Update toolbar buttons:
        Procedure Set Changed_State Integer iState
            Forward Set Changed_State to iState
            Send DoFlipToobarButtonState of oToolbar iState Self
        End_Procedure  

        Procedure Set Field_Changed_State Integer iField Boolean bState
            Handle hoDD
            Boolean bFromTableChanged bToTableChanged
            String sFromTo

            Forward Set Field_Changed_State to iField bState

            Move (SncTHea_DD(Self)) to hoDD
            // If table has been changed for an existing record and SncTHea (and rows) exist,
            // warn user that the Value Transformation tables are not valid any longer:
            If (pbGetHasCurrRowId(Self) and pbGetHasCurrRowId(hoDD)) Begin
                Get Field_Changed_State Field SncTable.FromDataTable to bFromTableChanged
                Get Field_Changed_State Field SncTable.ToDataTable   to bToTableChanged
                If (bFromTableChanged or bToTableChanged) Begin
                    If (bFromTableChanged and not(bToTableChanged)) Move "Source"                 to sFromTo
                    Else If (not(bFromTableChanged) and bToTableChanged) Move "Destination"       to sFromTo
                    Else If (bFromTableChanged and bToTableChanged) Move "Source and Destination" to sFromTo
                    Send Info_Box ("WARNING! The Table Name has been changed for the" * sFromTo * "database(s) and Value Conversion table(s) exists for the old Table Name. You need to delete them on the 'Value Conversion' tab page.")
                End  
            End  
        End_Procedure  

        Procedure Clear
            Integer iFile iOpen
            Forward Send Clear
            Move 10 to iFile                                // From File
            Get_Attribute DF_FILE_OPENED of iFile  to iOpen
            If iOpen Close iFile
            Move 20 to iFile                                // to File
            Get_Attribute DF_FILE_OPENED of iFile  to iOpen
            If iOpen Close iFile
            Move 100 to iFile                               // From DDF File
            Get_Attribute DF_FILE_OPENED of iFile to iOpen
            If iOpen Close iFile
            Move 110 to iFile                               // to DDF File
            Get_Attribute DF_FILE_OPENED of iFile to iOpen
            If iOpen Close iFile
            Broadcast Recursive Send DoCheckClear of (Parent(Self))
            // Must be after Recursive Send DoCheckClear...
            Set Changed_State to False
        End_Procedure  

        Procedure Clear_All
            Forward Send Clear_All
            Send Clear
        End_Procedure 

        Procedure Request_Save
            Integer iRetval iFormat
            String sValue
            Get Field_Current_Value Field SncTable.ToIdxSelCount to iRetval
            If not iRetval Begin
                Get YesNo_Box "Warning. You have not specified any index fields on the 'Index/Sorting' tab page. This will probably lead to an unsuccessful connection. Would you like to adjust before saving?" ;
                to iRetval
                If (iRetval = MBR_Yes) Procedure_Return
            End  
            Get Field_Current_Value Field SncTable.ToDefaults    to sValue
            Get Field_Current_Value Field SncTable.ToDbType      to iFormat
            Move (Trim(sValue)) to sValue
            If (iFormat <> 1 and iFormat <> 6 and not(Length(sValue))) Begin // 1=DataFlex, 6=P.SQL
                Get YesNo_Box "Warning. You have not specified any null defaults on the 'Null Defaults' tab page. This will probably lead to an unsuccessful connection. Would you like to adjust before saving?" ;
                to iRetval
                If (iRetval = MBR_Yes) Procedure_Return
            End  
            Forward Send Request_Save
        End_Procedure  

    End_Object  

    Object Sncschem_DD is a Sncschem_DataDictionary
    End_Object    

    Object Snclog_DD is a Snclog_DataDictionary
    End_Object    

    Object Sncthea_DD is a Sncthea_DataDictionary
        Set Auto_Fill_State to True
        Set Ordering to 1
        // TEST THIS!
        //Set Allow_Foreign_New_Save_State to True

        Set DDO_Server to Snctable_DD
        Set Constrain_File to Snctable.File_Number

        Procedure Request_Save
            Integer iSncTable_Recid iRecid
            Get File_Field_Current_Value File_Field SncTable.Recid to iRecid
            If not (pbGetHasCurrRowId(Self)) ;
                Set Field_Changed_Value Field SncTHea.SncTable_Recid to iRecid
            Forward Send Request_Save
        End_Procedure  

        Procedure DoCreateNewRecord  // Initialize new SncTHea record.
            Integer iRecid
            Get File_Field_Current_Value File_Field SncTable.Recid to iRecid
            Send Clear
            Set Field_Changed_Value Field SncTHea.SncTable_Recid to iRecid
        End_Procedure  

        // Send from field value transformation table:
        Procedure DoFindRecord Integer iMode
            Integer iRecnum iOrdering
            Move SncTHea.Recnum to iRecnum
            Get Ordering to iOrdering
            Constraint_Set Self
            Constrain SncTHea Relates to SncTable
            If (iMode >= 0)      Constrained_Find iMode SncTHea.File_Number by iOrdering
            Else If (iMode = -1) Constrained_Find First SncTHea.File_Number by iOrdering
            Else If (iMode = -2) Constrained_Find Last  SncTHea.File_Number by iOrdering
            If (Found) Send Find_By_Recnum SncTHea.File_Number SncTHea.Recnum
            Else Begin        // Reset record buffer.
                Clear SncTHea
                Move iRecnum to SncTHea.Recnum
                Find Eq SncTHea by Recnum
            End 
        End_Procedure  

    End_Object  

    Object Snctrow_DD is a Snctrow_DataDictionary
        Set DDO_Server to Sncthea_DD
        Set Constrain_File to Sncthea.File_Number
    End_Object    

    //    Set Main_DD to Snctable_DD
    //    Set Server to Snctable_DD
    //    Set Auto_Clear_DEO_State to False
    //    Set Maximize_Icon to True
    //    Set Minimize_Icon to False
    //    Set Caption_Bar to False

    Object oImage_lst is a cRDScImageList
        Set piMaxImages to 11

        Procedure OnCreate
            Integer iIndex
            // Top tab-pages
            Get AddTransparentImage "File16.bmp"       clFuchsia to iIndex
            Get AddTransparentImage "Collection16.bmp" clFuchsia to iIndex
            Get AddTransparentImage "CmEngine16.bmp"   clFuchsia to iIndex
            Get AddTransparentImage "Log16.bmp"        clFuchsia to iIndex
            // Tables Setup tab-pages:
            Get AddTransparentImage "Tables16.bmp"     clFuchsia to iIndex
            Get AddTransparentImage "FindSmall.bmp"    clFuchsia to iIndex // For prompt button on a dbform.
            Get AddTransparentImage "Fields16.bmp"     clFuchsia to iIndex
            Get AddTransparentImage "Index16.bmp"      clFuchsia to iIndex
            Get AddTransparentImage "Constrain16.bmp"  clFuchsia to iIndex
            Get AddTransparentImage "Nulls16.bmp"      clFuchsia to iIndex
            Get AddTransparentImage "ValTran16.bmp"    clFuchsia to iIndex
            Get AddTransparentImage "Flags16.bmp"      clFuchsia to iIndex
            Get AddTransparentImage "Other16.bmp"      clFuchsia to iIndex
            Get AddTransparentImage "Info.bmp"         clFuchsia to iIndex
            Get AddTransparentImage "Warning.bmp"      clFuchsia to iIndex
            Get AddTransparentImage "Error.bmp"        clFuchsia to iIndex
        End_Procedure 

    End_Object    

    Object oRDS_td is a cRDSDbTabDialog
        Set Size to 365 558
        Set Location to 4 0
        Set Rotate_Mode to RM_Rotate_in_Ring
        Set phoImageList to oImage_lst
        Set peAnchors to anAll
        Set Pointer_only_state to True
        Set Auto_Clear_DEO_state to False
        Set piMinSize to 343 558
        Set Popup_State to False
        
        Object oTable_tp is a cRDSDbTabPage
            Set Label to "1. Database Connections"
            Set Tab_ToolTip_Value to "Create/Edit/Delete Connection records for Source and Destination Data Tables"
            Object oSnctable_Recid is a cRDSDbForm

                Delegate Set phoSnctable_Recid to (Self)  // Panel property.

                Entry_Item Snctable.Recid
                Set Label to "Id (Auto generated)"
                Set Size to 13 70
                Set Location to 4 83
                Set Label_Col_Offset to 2
                Set Label_Justification_Mode to jMode_Right
                Set Prompt_Button_Mode to pb_PromptOn

                Set Form_Button_Bitmap 0 to 'FindSmall.bmp/T/3D'

                Procedure Entering Returns Integer
                    Forward Send Entering
                    Send DoFlipToobarPromptState of oToolbar True
                End_Procedure

                Procedure Exiting Integer iTo Returns Integer
                    Forward Send Exiting iTo
                    Send DoFlipToobarPromptState of oToolbar False
                End_Procedure
            End_Object    

            Object oSnctable_Sortfield is a cRDSDbForm
                Entry_Item Snctable.Sortfield
                Set Label to "Sort Name"
                Set Size to 13 79
                Set Location to 4 194
                Set Label_Col_Offset to 2
                Set Label_Justification_Mode to jMode_Right

                Set Form_Button_Bitmap 0 to 'FindSmall.bmp/T/3D'

                Procedure Entering Returns Integer
                    Forward Send Entering
                    Send DoFlipToobarPromptState of oToolbar True
                End_Procedure

                Procedure Exiting Integer iTo Returns Integer
                    Forward Send Exiting iTo
                    Send DoFlipToobarPromptState of oToolbar False
                End_Procedure
            End_Object    

            Object oSnctable_Hide is a cRDSDbCheckBox
                Entry_Item Snctable.Hide
                Set Label to "Hide record"
                Set Size to 13 50
                Set Location to 4 278
            End_Object    

            Object oSnctable_Datetime is a cRDSDbForm
                Entry_Item Snctable.DateTime
                Set Label to "Record Created"
                Set Size to 13 72
                Set Location to 4 411
                Set peAnchors to anTopRight
                Set Label_Col_Offset to 2
                Set Label_Justification_Mode to jMode_Right
            End_Object    

            Object oSnctable_Createdby is a cRDSDbForm
                Entry_Item Snctable.Createdby
                Set Label to "By"
                Set Size to 13 53
                Set Location to 4 496
                Set peAnchors to anTopRight
                Set Label_Col_Offset to 0
                Set Label_Justification_Mode to jMode_Right
            End_Object    

            Object oSnctable_Text is a cRDSDbForm
                Entry_Item Snctable.Text
                Set Label to "Name"
                Set Size to 13 287
                Set Location to 19 83
                Set peAnchors to anTopLeftRight
                Set Label_Col_Offset to 2
                Set Label_Justification_Mode to jMode_Right
            End_Object    

            Object oSnctable_Lastedited is a cRDSDbForm
                Entry_Item Snctable.Lastedited
                Set Label to "Last Edited"
                Set Size to 13 72
                Set Location to 19 411
                Set peAnchors to anTopRight
                Set Label_Col_Offset to 2
                Set Label_Justification_Mode to jMode_Right
            End_Object    

            Object oSnctable_Editedby is a cRDSDbForm
                Entry_Item Snctable.Editedby
                Set Label to "By"
                Set Size to 13 53
                Set Location to 19 496
                Set peAnchors to anTopRight
                Set Label_Col_Offset to 0
                Set Label_Justification_Mode to jMode_Right
            End_Object 

            Object oDbTables_TD is a cRDSDbTabDialog
                Set Size to 315 551
                Set Location to 34 0
                Set TabWidth_Mode to twRightJustify
                Set Rotate_Mode to RM_Rotate
                Set phoImageList to oImage_lst
                Set peAnchors to anAll
                Set Auto_Clear_DEO_state to False   
                
                Object oDbTabPage1 is a cRDSDbTabPage
                    Set Label to "Database Tables"
                    Set Tab_ToolTip_Value to "Source and target database table details"
                    Set piImageIndex to 4    
                    
                    Object oFromDatabase_grp is a cRDSDbGroup
                        Set Size to 149 540
                        Set Location to 1 3
                        Set peAnchors to anTopLeftRight
                        Set Label to "Source Database"
                    
                        Object oSnctable_Fromdbtype is a cDbComboformFormat
                            Entry_Item Snctable.Fromdbtype
                            Set Label to "Database Format"
                            Set Size to 13 150
                            Set Location to 10 78
                            Set Form_Border to 0
                            Set Label_Row_Offset to 0
                            Set Label_Col_Offset to 2
                            Set Label_Justification_Mode to jMode_Right
                            Set Entry_State to False
                            Set Combo_Sort_State to False
                            Set pbFrom to True
                        End_Object    

                        Object oSnctable_Fromserver is a cDbComboformServer
                            Entry_Item Snctable.Fromserver
                            Set Label to "Server"
                            Set Size to 13 150
                            Set Location to 25 78
                            Set Form_Border to 0
                            Set Label_Row_Offset to 0
                            Set Label_Col_Offset to 2
                            Set Label_Justification_Mode to jMode_Right
                            //                            Set Entry_State to False
                            Set Combo_Sort_State to True
                            Set pbFrom to True
                        End_Object    

                        Object oFromDSN_grp is a cRDSDbRadioGroup
                            Entry_Item Snctable.Fromdsntype
                            Set Size to 66 244
                            Set Location to 7 290
                            Set peAnchors to anTopRight
                            Set Label to "Select the ODBC Data Source Type"

                            Property Handle  phoServerObject (oSnctable_FromServer(Self))
                            Property Handle  phoFileDSN_bn   0        // Set by the object itself.
                            Property Integer piDbType 0
                            Property Boolean pbFrom   True
                            Property String  psRadio1 ;
                            ("An ODBC User data source stores information about how to connect to" * ;
                            "the indicated data provider. A User data source is only visible to you," * ;
                            "and can only be used on the current machine.")
                            Property String  psRadio2 ;
                            ("An ODBC System data source stores information about how to connect to" * ;
                            "the indicated data provider. A System data source is visible to all users" * ;
                            "on this machine, including NT services.")
                            Property String  psRadio3 ;
                            ("An ODBC File data source allows you to connect to a data provider. File" *  ;
                            "DSNs can be shared by users who have the same drivers installed." * ;
                            "Note: Press the 'Select File' button below to select the file.")

                            Object oFromRadio1 is a cRDSRadio
                                Set Label to "User Data Sources"
                                Set Size to 10 74
                                Set Location to 10 5

                                Set Status_Help to (psRadio1(Self))

                                Function Next_Object_Id Boolean bState Returns Integer
                                    Handle ho
                                    Move (oFromRadio2(Self)) to ho
                                    Function_Return ho
                                End_Function 

                                Function Prior_Object_Id Boolean bState Returns Integer
                                    Handle ho
                                    Move (oSnctable_FromServer(Self)) to ho
                                    Function_Return ho
                                End_Function  

                                On_Key kNext_Item        Send Switch
                                On_Key kPrevious_Item    Send Switch_Back
                                On_Key Key_Tab           Send Switch
                                On_Key Key_Shift+Key_Tab Send Switch_Back
                            End_Object   

                            Object oFromRadio2 is a cRDSRadio
                                Set Label to "System Data Sources"
                                Set Size to 10 82
                                Set Location to 10 83

                                Set Status_Help to (psRadio2(Self))

                                Function Next_Object_Id Boolean bState Returns Integer
                                    Handle ho
                                    Move (oFromRadio3(Self)) to ho
                                    Function_Return ho
                                End_Function 

                                Function Prior_Object_Id Boolean bState Returns Integer
                                    Handle ho
                                    Move (oFromRadio1(Self)) to ho
                                    Function_Return ho
                                End_Function  

                                On_Key kNext_Item        Send Switch
                                On_Key kPrevious_Item    Send Switch_Back
                                On_Key Key_Tab           Send Switch
                                On_Key Key_Shift+Key_Tab Send Switch_Back
                            End_Object  

                            Object oFromRadio3 is a cRDSRadio
                                Set Label to "File Data Sources"
                                Set Size to 10 69
                                Set Location to 10 170

                                Set Status_Help to (psRadio3(Self))

                                Function Prior_Object_Id Boolean bState Returns Integer
                                    Handle ho
                                    Move (oFromRadio2(Self)) to ho
                                    Function_Return ho
                                End_Function  

                                On_Key kNext_Item        Send Switch
                                On_Key kPrevious_Item    Send Switch_Back
                                On_Key Key_Tab           Send Switch
                                On_Key Key_Shift+Key_Tab Send Switch_Back

                            End_Object    

                            Object oFromODBCText is a cRDSTextbox
                                Set Label to "An ODBC File data source allows you to connect to a data provider. File DSNs can be shared by users who have the same drivers installed. Note: You can now press the 'Select File' button."
                                Set Auto_Size_State to False
                                Set Location to 22 7
                                Set Size to 26 233
                                Set Justification_Mode to jMode_Left
                                Set Label_Shadow_Display_Mode to TBSHADOW_ON_ALL
                            End_Object    

                            Object oFromFileDSN_bn is a cFileDSNButton
                                Set Label to "&Select File"
                                Set Size to 13 60
                                Set Location to 49 108
                                Set Status_Help to "Button is only enabled when the 'File Data Sources' radio button has been selected."
                                Set peAnchors to anTopRight
                                Set Bitmap to "FolderO16.bmp"
                                Set piTransparentColor to clFuchsia
                                Set pbFrom to True
                                Set phoFileDSN_bn of (oFromDSN_grp(Self)) to Self    // Group property.

                                On_Key kRightArrow Send Switch
                                On_Key kLeftArrow  Send Switch_Back
                            End_Object    

                            Object oFromODBCAdmin_bn is a cODBCAdminButton
                                Set Label to "&ODBC Admin"
                                Set Size to 13 70
                                Set Location to 49 170
                                Set Status_Help to "Start Windows 'ODBC Data Source Administrator' to create/edit ODBC data sources."
                                Set peAnchors to anTopRight
                                Set Bitmap to "ODBC16.bmp"
                                Set piTransparentColor to clFuchsia

                                Function Next_Object_Id Boolean bState Returns Integer
                                    Handle ho
                                    Move (oSncTable_FromUser(Self)) to ho
                                    Function_Return ho
                                End_Function 
                                
                                On_Key kRightArrow Send Switch
                                On_Key kLeftArrow  Send Switch_Back
                            End_Object    

                            Procedure DoEnableDisable Integer iValue
                                Set piDbType      to iValue
                                Set Enabled_State to (iValue = 4)
                                Set Enabled_State of (oFromFileDSN_bn(Self))   to (iValue = 4)
                                Set Current_Radio to 0
                            End_Procedure 

                            Procedure Notify_Select_State Integer iToItem Integer iFromItem
                                Handle ho
                                Integer iFile iField
                                Forward Send Notify_Select_State iToItem iFromItem

                                Get Data_File  to iFile
                                Get Data_Field to iField
                                Set File_Field_Changed_Value of (Server(Self)) iFile iField to iToItem

                                Move (oFromODBCText(Self)) to ho
                                If (iToItem = 0) Set Value of ho Item 0 to (psRadio1(Self))
                                If (iToItem = 1) Set Value of ho Item 0 to (psRadio2(Self))
                                If (iToItem = 2) Set Value of ho Item 0 to (psRadio3(Self))
                                If (phoFileDSN_bn(Self)) Set Enabled_State of (phoFileDSN_bn(Self)) to (iToItem = 2)
                                If (iToItem <> 2) Begin
                                    If (pbFrom(Self)) Set Field_Changed_Value of (Main_DD(Self)) Field SncTable.FromFilePath to ""
                                    Else              Set Field_Changed_Value of (Main_DD(Self)) Field SncTable.ToFilePath   to ""
                                End 
                                If (iToItem <> iFromItem and iToItem <> 2) Send DoEnableDisable of (phoServerObject(Self)) (piDbType(Self))
                            End_Procedure 

                            On_Key Key_Alt+Key_S Send KeyAction of oFromFileDSN_bn
                            On_Key Key_Alt+Key_O Send KeyAction of oFromODBCAdmin_bn
                        End_Object    

                        Object oSnctable_Fromdatabase is a cDbComboFormDatabase
                            Entry_Item Snctable.Fromdatabase
                            Set Label to "Database Name"
                            Set Size to 13 150
                            Set Location to 40 78
                            Set Form_Border to 0
                            Set Label_Row_Offset to 0
                            Set Label_Col_Offset to 2
                            Set Label_Justification_Mode to jMode_Right
                            //                            Set Entry_State to FALSE
                            Set Combo_Sort_State to True
                            Set pbFrom to True
                        End_Object    

                        Object oSnctable_Fromntauth is a cDbCheckBoxNtAuth
                            Entry_Item Snctable.Fromntauth
                            Set Label to "Use Windows Authentication"
                            Set Size to 13 120
                            Set Location to 56 78
                        End_Object    

                        Object oSnctable_Fromuser is a cDbFormUser
                            Entry_Item Snctable.Fromuser
                            Set Label to "User Name"
                            Set Size to 13 150
                            Set Location to 70 78
                            Set Label_Col_Offset to 2
                            Set Label_Justification_Mode to jMode_Right
                            Set pbFrom to True
                        End_Object    

                        Object oSnctable_Frompv is a cDbFormPassword
                            Entry_Item Snctable.Frompv
                            Set Label to "Password"
                            Set Size to 13 150
                            Set Location to 85 78
                            Set Label_Col_Offset to 2
                            Set Label_Justification_Mode to jMode_Right
                            Set pbFrom to True
                        End_Object    

                        Object oSnctable_Fromowner is a cDbFormSchema
                            Entry_Item Snctable.Fromowner
                            Set Label to "Schema Name"
                            Set Size to 13 150
                            Set Location to 100 78
                            Set Label_Col_Offset to 2
                            Set Label_Justification_Mode to jMode_Right
                            Set pbFrom to True
                        End_Object    

                        Object oFromLogin_bn is a cLoginButton
                            Set Label to "&Login"
                            Set Size to 13 60
                            Set Location to 100 230
                            Set Status_Help to "Click to login to the selected database server/data source."
                            Set Bitmap to "Keys16.bmp"
                            //                            Set Enabled_State to FALSE
                            Set piTransparentColor to clFuchsia
                            Set pbFrom to True
                            Set phoViewButton to (oViewFromData_bn(Self))
                        End_Object    

                        Object oSnctable_Fromfilepath is a cDbFormPath
                            Entry_Item Snctable.Fromfilepath
                            Set Label to "Table Path"
                            Set Size to 13 378
                            Set Location to 116 78
                            Set peAnchors to anTopLeftRight
                            Set Label_Col_Offset to 2
                            Set Label_Justification_Mode to jMode_Right
                            Set pbFrom to True
                        End_Object    

                        Object oFromPath_bn is a cPathButton
                            Set Label to "&Select File"
                            Set Size to 13 60
                            Set Location to 116 458
                            Set Status_Help to "Click to activate the Open File Dialog and select a database table. Only available for database format 'DataFlex' and 'Pervasive'"
                            Set peAnchors to anTopRight
                            Set Bitmap to "FolderO16.bmp"
                            Set piTransparentColor to clWhite
                            Set pbFrom to True

                            Procedure OnClick
                                Send DoOpenFileDialog
                            End_Procedure 
                            // PDC 25/04/2012 Added:
                            Procedure DoEnableDisable Integer iValue
                                Forward Send DoEnableDisable iValue
                                If (iValue = 1 or iValue = 6) Begin
                                    Set Location to 116 78
                                    Set Location of oSnctable_Fromfilepath to 116 176
                                    Set Size of oSnctable_Fromfilepath to 13 358
                                    Set peAnchors to anTopLeft
                                End
                                Else Begin
                                    Set Location to 116 458
                                    Set Location of oSnctable_Fromfilepath to 116 78
                                    Set Size of oSnctable_Fromfilepath to 13 378
                                    Set peAnchors to anTopRight
                                End
                            End_Procedure 
                            // End PDC
                        End_Object    

                        Object oSnctable_FromDataTable is a cDbComboformDataTable
                            Entry_Item Snctable.Fromdatatable
                            Set Label to "Table Name"
                            Set Size to 13 150
                            Set Location to 132 78
                            Set Form_Border to 0
                            Set Label_Row_Offset to 0
                            Set Label_Col_Offset to 2
                            Set Label_Justification_Mode to jMode_Right
                            Set Entry_State to False
                            Set Combo_Sort_State to True
                            Set pbFrom to True

                            Function Prior_Object_Id Returns Integer
                                Handle ho
                                Forward Get Prior_Object_Id 0 to ho
                                If (ho = 0) Move (oSnctable_Fromdbtype(Self)) to ho
                                Function_Return ho
                            End_Function 
                        End_Object    

                        Object oViewFromData_bn is a cViewDataButton
                            Set Label to "&View Data"
                            Set Size to 13 60
                            Set Location to 132 230
                            Set Status_Help to "View data for the Source database table."
                            Set Bitmap to "ViewData16.bmp"
                            Set Enabled_State to False
                            Set piTransparentColor to clFuchsia
                            Set pbFrom to True

                            Procedure OnClick
                                Send DoViewData True -1
                            End_Procedure 
                        End_Object    

                        Object oSnctable_Frfileoemtoansi is a cRDSDbCheckBox
                            Entry_Item Snctable.Frfileoemtoansi
                            Set Label to "Data saved in ANSI format"
                            Set Size to 10 97
                            Set Location to 134 293

                            Procedure DoEnableDisable Integer iValue
                                If (not(pbGetHasCurrRowId(Main_DD(Self))) and iValue > 1 and iValue < 6) ;
                                    Set Checked_State to True
                            End_Procedure 

                            // We _must_ have this, else the program will hang while trying
                            // to figure out the next_object_id with the cBitmap objects:
                            //Function Next_Object_Id Returns Integer
                            //  Handle ho
                            //  Move (oSnctable_Todbtype(oToDatabase_grp(Self))) to ho
                            //  Function_Return ho
                            //End_Function // Next_Object_Id
                        End_Object    

                        Object oNoOfFromRecords_fm is a cRDSForm
                            Set Label to "Number of Records"
                            Set Size to 13 60
                            Set Location to 132 458
                            Set Status_Help to "Current number of physical records for the selected database table. For other formats then DataFlex and Pervasive you need to press the Refresh button to the right."
                            Set peAnchors to anTopRight
                            Set Label_Col_Offset to 0
                            Set Label_Justification_Mode to jMode_Right
                            Set Form_DataType to mask_numeric_window

                            Set Form_Mask     Item 0 to "#,###########"
                            Set Enabled_State to False
                        End_Object    

                        Object oFromRecordRefresh_bn is a cBitmapButton
                            Set Size to 13 16
                            Set Location to 132 520
                            Set Status_Help to "Refresh the number of records. (Alt+R)"
                            Set peAnchors to anTopRight
                            Set Bitmap to "Refresh16.bmp"
                            Set piTransparentColor to clFuchsia

                            Procedure DoUpdateData Integer iFromFile Integer iToFile Boolean bFrom
                                Integer iOpen iRecords
                                String sDriver
                                If iFromFile Get_Attribute DF_FILE_OPENED of iFromFile to iOpen
                                Set Enabled_State to iOpen
                                If iOpen Begin
                                    Get_Attribute DF_FILE_DRIVER            of iFromFile to sDriver
                                    If (sDriver = FLEX_DRV_ID or sDriver = DFBTRDRV_ID) ;
                                        Get_Attribute DF_FILE_RECORDS_USED    of iFromFile to iRecords
                                End 
                                Set Value of oNoOfFromRecords_fm to iRecords
                            End_Procedure 

                            Procedure OnClick
                                Integer iFile iOpen iRecords
                                Get Field_Current_Value of (Main_DD(Self)) Field SncTable.FromFile to iFile
                                If iFile Get_Attribute DF_FILE_OPENED       of iFile to iOpen
                                If iOpen Get_Attribute DF_FILE_RECORDS_USED of iFile to iRecords
                                Set Value of oNoOfFromRecords_fm to iRecords
                            End_Procedure 

                        End_Object    

                        Object oSnctable_Fromdriver is a cDbComboformDriver
                            Entry_Item Snctable.Fromdriver
                            Set Label to "Database Driver"
                            Set Size to 13 78
                            Set Location to 100 456
                            Set Form_Border to 0
                            Set Label_Row_Offset to 0
                            Set Label_Col_Offset to 2
                            Set Label_Justification_Mode to jMode_Right
                            Set Entry_State to False
                            Set Combo_Sort_State to False
                            Set pbHidden to True
                        End_Object    

                        //Use LFFile.pkg // *** License check package ***
                        On_Key Key_Alt+Key_R Send KeyAction of oFromRecordRefresh_bn
                    End_Object    

                    Object oToDatabase_grp is a cRDSDbGroup
                        Set Size to 149 540
                        Set Location to 150 3
                        Set peAnchors to anAll
                        Set Label to "Target Database"
                        
                        Object oSnctable_Todbtype is a cDbComboformFormat
                            Entry_Item Snctable.Todbtype
                            Set Label to "Database Format"
                            Set Size to 13 150
                            Set Location to 10 78
                            Set Form_Border to 0
                            Set Label_Row_Offset to 0
                            Set Label_Col_Offset to 2
                            Set Label_Justification_Mode to jMode_Right
                            Set Entry_State to False
                            Set Combo_Sort_State to False
                            Set pbFrom to False

                            // We need this to return to the correct object if Shift+Tab
                            // is pressed.
                            Function Prior_Object_Id Returns Integer
                                Handle ho
                                Move (oSnctable_Frfileoemtoansi(oFromDatabase_grp(Self))) to ho
                                Function_Return ho
                            End_Function 
                        End_Object    

                        Object oSnctable_Toserver is a cDbComboformServer
                            Entry_Item Snctable.Toserver
                            Set Label to "Server"
                            Set Size to 13 150
                            Set Location to 25 78
                            Set Form_Border to 0
                            Set Label_Row_Offset to 0
                            Set Label_Col_Offset to 2
                            Set Label_Justification_Mode to jMode_Right
                            //                            Set Entry_State to FALSE
                            Set Combo_Sort_State to False
                            Set pbFrom to False
                        End_Object    

                        Object oToDSN_grp is a cRDSDbRadioGroup
                            Entry_Item Snctable.Todsntype
                            Set Size to 66 244
                            Set Location to 7 290
                            Set peAnchors to anTopRight
                            Set Label to "Select the ODBC Data Source Type"

                            Property Handle  phoServerObject (oSnctable_ToServer(Self))
                            Property Handle  phoFileDSN_bn   0 // Set by object itself.
                            Property Integer piDbType 0
                            Property Boolean pbFrom   False
                            Property String  psRadio1 ;
                            ("An ODBC User data source stores information about how to connect to" * ;
                            "the indicated data provider. A User data source is only visible to you," * ;
                            "and can only be used on the current machine.")
                            Property String  psRadio2 ;
                            ("An ODBC System data source stores information about how to connect to" * ;
                            "the indicated data provider. A System data source is visible to all users" * ;
                            "on this machine, including NT services.")
                            Property String  psRadio3 ;
                            ("An ODBC File data source allows you to connect to a data provider. File" *  ;
                            "DSNs can be shared by users who have the same drivers installed." * ;
                            "Note:Press the 'Select File' button below to select the file.")

                            Object oToRadio1 is a cRDSRadio
                                Set Label to "User Data Sources"
                                Set Size to 10 77
                                Set Location to 10 5
                                Set Status_Help to (psRadio1(Self))

                                Function Next_Object_Id Boolean bState Returns Integer
                                    Handle ho
                                    Move (oToRadio2(Self)) to ho
                                    Function_Return ho
                                End_Function 

                                Function Prior_Object_Id Boolean bState Returns Integer
                                    Handle ho
                                    Move (oSnctable_ToServer(Self)) to ho
                                    Function_Return ho
                                End_Function 

                                On_Key kNext_Item     Send Next_Item
                                On_Key kPrevious_Item Send Previous_Item
                            End_Object    

                            Object oToRadio2 is a cRDSRadio
                                Set Label to "System Data Sources"
                                Set Size to 10 85
                                Set Location to 10 83
                                Set Status_Help to (psRadio2(Self))

                                Function Next_Object_Id Boolean bState Returns Integer
                                    Handle ho
                                    Move (oToRadio3(Self)) to ho
                                    Function_Return ho
                                End_Function 

                                Function Prior_Object_Id Boolean bState Returns Integer
                                    Handle ho
                                    Move (oToRadio1(Self)) to ho
                                    Function_Return ho
                                End_Function 

                                On_Key kNext_Item     Send Next_Item
                                On_Key kPrevious_Item Send Previous_Item
                            End_Object    

                            Object oToRadio3 is a cRDSRadio
                                Set Label to "File Data Sources"
                                Set Size to 10 73
                                Set Location to 10 170
                                Set Status_Help to (psRadio3(Self))

                                Function Prior_Object_Id Boolean bState Returns Integer
                                    Handle ho
                                    Move (oToRadio2(Self)) to ho
                                    Function_Return ho
                                End_Function 

                                On_Key kNext_Item     Send Next_Item
                                On_Key kPrevious_Item Send Previous_Item
                            End_Object    

                            Object oToODBCText is a cRDSTextbox
                                Set Label to "An ODBC File data source allows you to connect to a data provider. File DSNs can be shared by users who have the same drivers installed. Note: You can now press the 'Select File' button."
                                Set Auto_Size_State to False
                                Set Location to 22 7
                                Set Size to 24 233
                                Set Justification_Mode to jMode_Left
                                Set Label_Shadow_Display_Mode to TBSHADOW_ON_ALL
                            End_Object    

                            Object oToFileDSN_bn is a cFileDSNButton
                                Set Label to "&Select File"
                                Set Size to 13 60
                                Set Location to 49 108
                                Set Status_Help to "Button is only enabled when the 'File Data Sources' radio button has been selected."
                                Set peAnchors to anTopRight
                                Set Bitmap to "FolderO16.bmp"
                                Set piTransparentColor to clFuchsia
                                Set pbFrom to False
                                Set phoFileDSN_bn of (oToDSN_grp(Self)) to Self  // Group property.

                                On_Key kRightArrow Send Switch
                                On_Key kLeftArrow  Send Switch_Back
                            End_Object    

                            Object oToODBCAdmin_bn is a cODBCAdminButton
                                Set Label to "&ODBC Admin"
                                Set Size to 13 70
                                Set Location to 49 170
                                Set Status_Help to "Start Windows 'ODBC Data Source Administrator' to create/edit ODBC data sources."
                                Set peAnchors to anTopRight
                                Set Bitmap to "ODBC16.bmp"
                                Set piTransparentColor to clFuchsia

                                Function Next_Object_Id Boolean bState Returns Integer
                                    Handle ho
                                    Move (oSncTable_ToUser(Self)) to ho
                                    Function_Return ho
                                End_Function 

                                On_Key kRightArrow Send Switch
                                On_Key kLeftArrow  Send Switch_Back
                            End_Object    

                            Procedure DoEnableDisable Integer iValue
                                Set piDbType      to iValue
                                Set Enabled_State to (iValue = 4)
                                Set Enabled_State of (oToFileDSN_bn(Self))   to (iValue = 4)
                                Set Current_Radio to 0
                            End_Procedure 

                            Procedure Notify_Select_State Integer iToItem Integer iFromItem
                                Handle ho
                                Integer iFile iField

                                Forward Send Notify_Select_State iToItem iFromItem
                                Get Data_File  to iFile
                                Get Data_Field to iField
                                Set File_Field_Changed_Value of (Server(Self)) iFile iField to iToItem

                                Move (oToODBCText(Self)) to ho
                                If (iToItem = 0) Set Value of ho Item 0 to (psRadio1(Self))
                                If (iToItem = 1) Set Value of ho Item 0 to (psRadio2(Self))
                                If (iToItem = 2) Set Value of ho Item 0 to (psRadio3(Self))
                                If (phoFileDSN_bn(Self)) Set Enabled_State of (phoFileDSN_bn(Self)) to (iToItem = 2)
                                If (iToItem <> 2) Begin
                                    If (pbFrom(Self)) Set Field_Changed_Value of (Main_DD(Self)) Field SncTable.FromFilePath to ""
                                    Else              Set Field_Changed_Value of (Main_DD(Self)) Field SncTable.ToFilePath   to ""
                                End 
                                If (iToItem <> iFromItem and iToItem <> 2) Send DoEnableDisable of (phoServerObject(Self)) (piDbType(Self))
                            End_Procedure 

                            On_Key Key_Alt+Key_S Send KeyAction of oFromFileDSN_bn
                            On_Key Key_Alt+Key_O Send KeyAction of oFromODBCAdmin_bn
                        End_Object    

                        Object oSnctable_Todatabase is a cDbComboFormDatabase
                            Entry_Item Snctable.Todatabase
                            Set Label to "Database Name"
                            Set Size to 13 150
                            Set Location to 40 78
                            Set Form_Border to 0
                            Set Label_Row_Offset to 0
                            Set Label_Col_Offset to 2
                            Set Label_Justification_Mode to jMode_Right
                            //                            Set Entry_State to FALSE
                            Set Combo_Sort_State to True
                            Set pbFrom to False
                            Set Label_Shadow_Display_Mode to TBSHADOW_ON_NONE
                        End_Object    

                        Object oSnctable_Tontauth is a cDbCheckBoxNtAuth
                            Entry_Item Snctable.Tontauth
                            Set Label to "Use Windows NT Authentication"
                            Set Size to 13 120
                            Set Location to 56 78
                            Set pbFrom to False
                        End_Object    

                        Object oSnctable_Touser is a cDbFormUser
                            Entry_Item Snctable.Touser
                            Set Label to "User Name"
                            Set Size to 13 150
                            Set Location to 70 78
                            Set Label_Col_Offset to 2
                            Set Label_Justification_Mode to jMode_Right
                            Set pbFrom to False
                        End_Object    

                        Object oSnctable_Topv is a cDbFormPassword
                            Entry_Item Snctable.Topv
                            Set Label to "Password"
                            Set Size to 13 150
                            Set Location to 85 78
                            Set Label_Col_Offset to 2
                            Set Label_Justification_Mode to jMode_Right
                            Set pbFrom to False
                        End_Object    

                        Object oSnctable_Toowner is a cDbFormSchema
                            Entry_Item Snctable.Toowner
                            Set Label to "Schema Name"
                            Set Size to 13 150
                            Set Location to 100 78
                            Set Label_Col_Offset to 2
                            Set Label_Justification_Mode to jMode_Right
                            Set pbFrom to False
                        End_Object    

                        Object oToLogin_bn is a cLoginButton
                            Set Label to "L&ogin"
                            Set Size to 13 60
                            Set Location to 100 230
                            Set Status_Help to "Click to login to the selected database server/data source. You only need to do this if you get a login error."
                            Set Bitmap to "Keys16.bmp"
                            //                            Set Enabled_State to FALSE
                            Set piTransparentColor to clFuchsia
                            Set pbFrom to False
                            Set phoViewButton to (oViewToData_bn(Self))
                        End_Object    

                        Object oSnctable_Tofilepath is a cDbFormPath
                            Entry_Item Snctable.Tofilepath
                            Set Label to "Table Path"
                            Set Size to 13 379
                            Set Location to 116 78
                            Set peAnchors to anTopLeftRight
                            Set Label_Col_Offset to 2
                            Set Label_Justification_Mode to jMode_Right
                            Set pbFrom to False
                        End_Object    

                        Object oToPath_bn is a cPathButton
                            Set Label to "Select &File"
                            Set Size to 13 60
                            Set Location to 116 458
                            Set Status_Help to "Click to activate the Open File Dialog and select a database table. Only available for database format 'DataFlex' and 'Pervasive'"
                            Set peAnchors to anTopRight
                            Set Bitmap to "FolderO16.bmp"
                            Set piTransparentColor to clFuchsia
                            Set pbFrom to False

                            Procedure OnClick
                                Send DoOpenFileDialog
                            End_Procedure 
                            // PDC 25/04/2012 Added:
                            Procedure DoEnableDisable Integer iValue
                                Forward Send DoEnableDisable iValue
                                If (iValue = 1 or iValue = 6) Begin
                                    Set Location to 116 78
                                    Set Location of oSnctable_Tofilepath to 116 176
                                    Set Size of oSnctable_Tofilepath to 13 358
                                    Set peAnchors to anTopLeft
                                End
                                Else Begin
                                    Set Location to 116 458
                                    Set Location of oSnctable_Tofilepath to 116 78
                                    Set Size of oSnctable_Tofilepath to 13 378
                                    Set peAnchors to anTopRight
                                End
                            End_Procedure 
                            // End PDC
                        End_Object    

                        Object oSnctable_ToDataTable is a cDbComboformDataTable
                            Entry_Item Snctable.Todatatable
                            Set Label to "Table Name"
                            Set Size to 13 150
                            Set Location to 132 78
                            Set Form_Border to 0
                            Set Label_Row_Offset to 0
                            Set Label_Col_Offset to 2
                            Set Label_Justification_Mode to jMode_Right
                            Set Entry_State to False
                            Set Combo_Sort_State to True
                            Set pbFrom to False

                            Function Prior_Object_Id Returns Integer
                                Handle ho
                                Forward Get Prior_Object_Id 0 to ho
                                If (ho = 0) Move (oSnctable_Todbtype(Self)) to ho
                                Function_Return ho
                            End_Function 
                        End_Object    

                        Object oViewToData_bn is a cViewDataButton
                            Set Label to "View &Data"
                            Set Size to 13 60
                            Set Location to 132 230
                            Set Status_Help to "View data for the Target database table."
                            Set Bitmap to "ViewData16.bmp"
                            Set Enabled_State to False
                            Set piTransparentColor to clFuchsia
                            Set pbFrom to False

                            Procedure OnClick
                                Send DoViewData True -1
                            End_Procedure 
                        End_Object    

                        Object oSnctable_Tofileoemtoansi is a cRDSDbCheckBox
                            Entry_Item Snctable.Tofileoemtoansi
                            Set Label to "Save data in ANSI format"
                            Set Size to 10 95
                            Set Location to 134 293

                            Procedure DoEnableDisable Integer iValue
                                If (not(pbGetHasCurrRowId(Main_DD(Self))) and iValue > 1 and iValue < 6) ;
                                    Set Checked_State to True
                            End_Procedure 

                            // We _must_ have this, else the program will hang while trying
                            // to figure out the next_object_id with the cBitmap objects:
                            //Function Next_Object_Id Returns Integer
                            //  Handle ho
                            //  Move (oDbTabPage2(oDbTables_TD(Self))) to ho
                            //  Function_Return ho
                            //End_Function // Next_Object_Id
                        End_Object    

                        Object oNoOfToRecords_fm is a cRDSForm
                            Set Label to "Number of Records"
                            Set Size to 13 60
                            Set Location to 132 458
                            Set Status_Help to "Current number of physical records for the selected database table. For other formats then DataFlex and Pervasive you need to press the Refresh button to the right."
                            Set peAnchors to anTopRight
                            Set Label_Col_Offset to 0
                            Set Label_Justification_Mode to jMode_Right
                            Set Form_DataType to mask_numeric_window
                            Set Form_Mask     Item 0 to "#,###########"
                            Set Enabled_State to False
                        End_Object    

                        Object oToRecordRefresh_bn is a cBitmapButton
                            Set Size to 13 16
                            Set Location to 132 520
                            Set Status_Help to "Refresh the number of records. (Alt+R)"
                            Set peAnchors to anTopRight
                            Set Bitmap to "Refresh16.bmp"
                            Set piTransparentColor to clFuchsia

                            Procedure DoUpdateData Integer iFromFile Integer iToFile Boolean bFrom
                                Integer iOpen iRecords
                                String sDriver
                                If iToFile Get_Attribute DF_FILE_OPENED of iToFile to iOpen
                                Set Enabled_State to iOpen
                                If iOpen Begin
                                    Get_Attribute DF_FILE_DRIVER          of iToFile to sDriver
                                    If (sDriver = FLEX_DRV_ID or sDriver = DFBTRDRV_ID) ;
                                        Get_Attribute DF_FILE_RECORDS_USED  of iToFile to iRecords
                                End 
                                Set Value of oNoOfToRecords_fm to iRecords
                            End_Procedure 

                            Procedure OnClick
                                Integer iFile iOpen iRecords
                                Get Field_Current_Value of (Main_DD(Self)) Field SncTable.ToFile to iFile
                                If iFile Get_Attribute DF_FILE_OPENED       of iFile to iOpen
                                If iOpen Get_Attribute DF_FILE_RECORDS_USED of iFile to iRecords
                                Set Value of oNoOfToRecords_fm to iRecords
                            End_Procedure 
                        End_Object    

                        Object oSnctable_Todriver is a cDbComboformDriver
                            Entry_Item Snctable.Todriver
                            Set Label to "Database Driver"
                            Set Size to 13 78
                            Set Location to 98 457
                            Set Form_Border to 0
                            Set Label_Row_Offset to 0
                            Set Label_Col_Offset to 2
                            Set Label_Justification_Mode to jMode_Right
                            Set Entry_State to False
                            Set Combo_Sort_State to False
                            Set pbHidden to True
                        End_Object    

                        On_Key Key_Alt+Key_R Send KeyAction of oToRecordRefresh_bn
                    End_Object    


                    On_Key Key_Alt+Key_S Send KeyAction of oFromPath_bn
                    On_Key Key_Alt+Key_L Send KeyAction of oFromLogin_bn
                    On_Key Key_Alt+Key_V Send KeyAction of oViewFromData_bn

                    On_Key Key_Alt+Key_F Send KeyAction of oToPath_bn
                    On_Key Key_Alt+Key_O Send KeyAction of oToLogin_bn
                    On_Key Key_Alt+Key_D Send KeyAction of oViewToData_bn
                End_Object    

                Object oDbTabPage2 is a cRDSDbTabPage
                    Set Label to "Fields/Columns"
                    Set Tab_ToolTip_Value to "Field selection method and fields to include for the two tables"
                    Set piImageIndex to 5
                    
                    Object oSnctable_Synchtype is a cRDSDbComboForm
                        Entry_Item Snctable.Synchtype
                        Set Label to "Field Selection Type"
                        Set Size to 13 150
                        Set Location to 10 81
                        Set Form_Border to 0
                        Set Label_Col_Offset to 2
                        Set Label_Justification_Mode to jMode_Right
                        Set Entry_State Item 0 to False
                        Set Code_Display_Mode to cb_code_display_both

                        Procedure OnChange
                            Integer iType
                            Forward Send OnChange
                            Get Field_Current_Value of (Main_DD(Self)) Field SncTable.Synchtype to iType
                            Broadcast Recursive Send DoEnableDisable of (Parent(Self)) iType
                        End_Procedure 

                        Function Next_Object_Id Boolean bState Returns Integer
                            Handle ho
                            Integer iType
                            Get Field_Current_Value of (Main_DD(Self)) Field SncTable.Synchtype   to iType
                            If (iType = 1) Move (oFieldNames_grd(Self))                           to ho
                            If (iType = 2) Move (oFromStartField_cf(oFieldRange_grp(Self)))       to ho
                            If (iType = 3) Move (oFromParentFields_tv(oSelectedFields_grp(Self))) to ho
                            Function_Return ho
                        End_Function 
                    End_Object    

                    Object oFromDataTable_fm is a cRDSDbForm
                        Entry_Item Snctable.Fromdatatable
                        Set Label to "Source Table"
                        Set Size to 13 150
                        Set Location to 198 80
                        Set Label_Col_Offset to 2
                        Set Label_Justification_Mode to jMode_Right

                        Set Enabled_State to False
                        Procedure DoUpdateData Integer iFromFile Integer iToFile Boolean bFrom
                            Send Enable_Window of (Label_Object(Self)) (iFromFile and iToFile)
                        End_Procedure 
                    End_Object    

                    Object oViewFromData_bn is a cViewDataButton
                        Set Label to "&View Data"
                        Set Size to 13 55
                        Set Location to 213 80
                        Set Status_Help to "View data for the Source database table."
                        Set Bitmap to "ViewData16.bmp"
                        Set Enabled_State to False
                        Set piTransparentColor to clFuchsia
                        Set pbFrom to True

                        Procedure OnClick
                            Send DoViewData True -1
                        End_Procedure 
                    End_Object    

                    Object oToDataTable_fm is a cRDSDbForm
                        Entry_Item Snctable.Todatatable
                        Set Label to "Target Table"
                        Set Size to 13 150
                        Set Location to 229 80
                        Set Label_Col_Offset to 2
                        Set Label_Justification_Mode to jMode_Right

                        Set Enabled_State to False
                        Procedure DoUpdateData Integer iFromFile Integer iToFile Boolean bFrom
                            Send Enable_Window of (Label_Object(Self)) (iFromFile and iToFile)
                        End_Procedure 
                    End_Object    

                    Object oViewToData_bn is a cViewDataButton
                        Set Label to "View &Data"
                        Set Size to 13 55
                        Set Location to 244 80
                        Set Status_Help to "View data for the Target database table."
                        Set Bitmap to "ViewData16.bmp"
                        Set Enabled_State to False
                        Set piTransparentColor to clFuchsia
                        Set pbFrom to False

                        Procedure OnClick
                            Send DoViewData True -1
                        End_Procedure 
                    End_Object    

                    Object oMatchingFields_grp is a cRDSDbGroup
                        Set Size to 88 540
                        Set Location to 26 3
                        Set peAnchors to anLeftRight
                        Set Label to "1 - Matching Field Names"
                        
                        Object oFieldNames_grd is a cRDSGrid
                            Property String psItemHelpText ;
                            "Red color denotes that the field length and/or type is not the same for the Source and Target tables."

                            Set Color to cl3dLight
                            Set CurrentCellColor to clYellow
                            Set CurrentCellTextColor to clWhite
                            Set Size to 63 527
                            Set Location to 9 6
                            Set Autosize_height_state to True
                            Set peAnchors to anLeftRight
                            Set peResizeColumn to rcAll
                            Set GridLine_Mode to GRID_VISIBLE_VERT
                            Set peDisabledColor to clNavy
                            Set peDisabledTextColor to clWindowText

                            Set Line_Width to 8 0

                            Set Form_Width    Item 0 to 35
                            Set Header_Label  Item 0 to "Number"

                            Set Form_Width    Item 1 to 126
                            Set Header_Label  Item 1 to "Source Table Field Name"

                            Set Form_Width    Item 2 to 60
                            Set Header_Label  Item 2 to "Field Type"

                            Set Form_Width    Item 3 to 40
                            Set Header_Label  Item 3 to "Length"

                            Set Form_Width    Item 4 to 35
                            Set Header_Label  Item 4 to "Number"

                            Set Form_Width    Item 5 to 126
                            Set Header_Label  Item 5 to "Target Table Field Name"

                            Set Form_Width    Item 6 to 60
                            Set Header_Label  Item 6 to "Field Type"

                            Set Form_Width    Item 7 to 40
                            Set Header_Label  Item 7 to "Length"


                            Set Select_Mode        to No_Select
                            Set psToolTipTitle to "Matching Field Names"
                            Set psToolTip      to (psItemHelpText(Self))

                            Procedure DoUpdateData Integer iFromFile Integer iToFile Boolean bFrom
                                Send DoFillGrid iFromFile iToFile
                            End_Procedure 

                            Procedure DoFillGrid Integer iFromFile Integer iToFile
                                Handle ho
                                Integer iCount iFromFields iToField iFrField iStart
                                Integer iFromLength iToLength iFromType iToType iFromPrec iToPrec iMatch
                                Boolean bIsOpen
                                String sFieldName sType sChar sRootName sFromDriver sToDriver

                                Send Delete_Data  
                                Set Value of oNoOfMatchingNames_fm to ""
                                Set Value of oTotFields_fm         to ""
                                If (iFromFile = 0 or iToFile = 0) Procedure_Return

                                Send Ignore_Error of Error_Info_Object 4100 // "Cannot find field". Used to not trigger error while trying to find a matching field name in ToFile.
                                Send Ignore_Error of Error_Info_Object 77   // "Field number out of range"
                                Set Dynamic_Update_State to False

                                Get_Attribute DF_FILE_OPENED           of iFromFile          to bIsOpen
                                If not bIsOpen Procedure_Return
                                Get_Attribute DF_FILE_OPENED           of iToFile            to bIsOpen
                                If not bIsOpen Procedure_Return

                                Get_Attribute DF_FILE_NUMBER_FIELDS    of iFromFile          to iFromFields
                                Get_Attribute DF_FILE_DRIVER           of iFromFile          to sFromDriver
                                Get_Attribute DF_FILE_DRIVER           of iToFile            to sToDriver
                                If (sFromDriver = FLEX_DRV_ID) Move 0                        to iStart      // Then start at Recnum.
                                Else                           Move 1                        to iStart

                                For iCount From iStart to iFromFields
                                    Get_Attribute DF_FIELD_NUMBER        of iFromFile iCount   to iFrField
                                    Get_Attribute DF_FIELD_TYPE          of iFromFile iFrField to iFromType

                                    If (iFromType <> DF_OVERLAP) Begin
                                        Get FieldType iFromType                                  to sType        // Function in SyncFuncs.pkg
                                        Get_Attribute DF_FIELD_NAME        of iFromFile iFrField to sFieldname
                                        Indicate Err False
                                        Get FieldMap iToFile sFieldName                          to iToField
                                        Get UpperFirstChar sFieldName                            to sFieldName   // Function in SyncFuncs.pkg

                                        If (iToField <> - 1)  Begin
                                            // iFromFile:
                                            Send Add_Item msg_None iFrField                                        // Item "0" = iFromFile field number
                                            Send Add_Item msg_None sFieldName                                      // Item "1" = iFromFile field name
                                            Send Add_Item msg_None sType                                           // Item "2" = iFromFile field type
                                            Get_Attribute DF_FIELD_LENGTH    of iFromFile iFrField to iFromLength
                                            Get_Attribute DF_FIELD_PRECISION of iFromFile iFrField to iFromPrec
                                            If (iFromType = DF_BCD) ;
                                                Move (iFromLength - iFromPrec)                       to iFromLength
                                            Else Move 0                                            to iFromPrec
                                            Send Add_Item msg_None (String(iFromLength) + "," + String(iFromPrec)) // Item "3" = iFromFile field length

                                            // iToFile:
                                            Send Add_Item msg_None iToField                                        // Item "4" = iToFile field number
                                            Get_Attribute DF_FIELD_NAME      of iToFile iToField   to sFieldname
                                            Get UpperFirstChar sFieldName                          to sFieldName   // Function in SyncFuncs.pkg
                                            Send Add_Item msg_None sFieldName                                      // Item "5" = iToFile field name
                                            Get_Attribute DF_FIELD_TYPE      of iToFile iToField   to iToType
                                            Get FieldType iToType                                  to sType        // Function in SyncFuncs.pkg
                                            Send Add_Item msg_None sType                                           // Item "6" = iToFile field type
                                            Get_Attribute DF_FIELD_LENGTH    of iToFile iToField   to iToLength
                                            Get_Attribute DF_FIELD_PRECISION of iToFile iToField   to iToPrec
                                            If (iToType = DF_BCD) ;
                                                Move (iToLength - iToPrec)                           to iToLength
                                            Else Move 0                                            to iToPrec
                                            Send Add_Item msg_None (String(iToLength) + "," + String(iToPrec))     // Item "7" = iToFile field length

                                            If (iFromType <> iToType) Begin
                                                Set ItemColor Item (Item_Count(Self) -2) to clRed
                                                Set ItemColor Item (Item_Count(Self) -6) to clRed
                                            End 
                                            If (iFromLength <> iToLength or iFromPrec <> iToPrec) Begin
                                                Set ItemColor Item (Item_Count(Self) -1) to clRed
                                                Set ItemColor Item (Item_Count(Self) -5) to clRed
                                            End 
                                        End 
                                    End 
                                Loop  
                              
                                Get Item_Count to iMatch
                                For iCount From 0 to (iMatch -1)
                                    Set Entry_State Item iCount to False
                                Loop
                                Move (iMatch / 8)                    to iMatch
                                Set Value of oNoOfMatchingNames_fm   to iMatch
                                If (sFromDriver = FLEX_DRV_ID) Add 1 to iFromFields
                                Set Value of oTotFields_fm           to iFromFields
                                Send Trap_Error of Error_Info_Object 4100
                                Send Trap_Error of Error_Info_Object 77
                                Set Dynamic_Update_State to True
                            End_Procedure  

                            Function FieldMap Integer iFile String sFieldName Returns String
                                Integer iFields iField iStart
                                String sTableFieldName sDriver

                                Move (Uppercase(sFieldName))           to sFieldName
                                Get_Attribute DF_FILE_DRIVER of iFile  to sDriver
                                If (sDriver = FLEX_DRV_ID)   Move 0    to iStart      // Then start at Recnum.
                                Else                         Move 1    to iStart

                                Get_Attribute DF_FILE_NUMBER_FIELDS of iFile to iFields
                                For iField From iStart to iFields
                                    Get_Attribute DF_FIELD_NAME of iFile iField to sTableFieldName
                                    If (Uppercase(sTableFieldName) = sFieldName) Function_Return iField
                                Loop
                                Indicate Err False
                                Function_Return -1
                            End_Function 

                            Function Next_Object_Id Boolean bState Returns Integer
                                Handle ho
                                Move (oSnctable_Synchtype(Self)) to ho
                                Function_Return ho
                            End_Function 
                        End_Object    

                        Object oNoOfMatchingNames_fm is a cRDSForm
                            Set Label to "Matching Field Names"
                            Set Size to 13 23
                            Set Location to 72 472
                            Set Status_Help to "Number of fields/columns with the same name"
                            Set peAnchors to anBottomRight
                            Set Label_Col_Offset to 2
                            Set Label_Justification_Mode to jMode_Right
                            Set Enabled_State to False

                            Procedure Set Enabled_State Boolean bState
                                Forward Set Enabled_State to False
                            End_Procedure 
                        End_Object    

                        Object oTotFields_fm is a cRDSForm
                            Set Label to "Of"
                            Set Size to 13 23
                            Set Location to 72 511
                            Set Status_Help to "Total number of fields for the Source data table."
                            Set peAnchors to anBottomRight
                            Set Label_Col_Offset to 0
                            Set Label_Justification_Mode to jMode_Right
                            Set Enabled_State to False

                            Procedure Set Enabled_State Boolean bState
                                Forward Set Enabled_State to False
                            End_Procedure 
                        End_Object    

                        Procedure DoUpdateData Integer iFromFile Integer iToFile Boolean bFrom
                            Set Enabled_State to (iFromFile and iToFile)
                            Set Enabled_State of oSnctable_Synchtype to (iFromFile and iToFile)
                        End_Procedure 

                        Procedure DoEnableDisable Integer iType
                            Handle ho
                            Integer iItems
                            Move (oFieldNames_grd(Self)) to ho
                            Get Item_Count         of ho to iItems
                            Set Enabled_State to (iType = 1 and iItems)
                        End_Procedure 

                        Procedure Set Enabled_State Boolean bState
                            Handle ho
                            Move (oFieldNames_grd(Self)) to ho
                            Forward Set Enabled_State    to bState
                            If bState Set Color of ho    to clWindow
                            Else      Set Color of ho    to cl3dLight
                            Get Label_Object    of oNoOfMatchingNames_fm to ho
                            Set Enabled_State   of ho    to bState
                            Get Label_Object    of oTotFields_fm         to ho
                            Set Enabled_State   of ho    to bState
                        End_Procedure 
                    End_Object    

                    Object oFieldRange_grp is a cRDSDbGroup
                        Set Size to 75 234
                        Set Location to 118 3
                        Set peAnchors to anTopLeft
                        Set Label to "2 - Range of Field Numbers"
                        
                        Object oFromStartField_cf is a cDbFieldComboform
                            Entry_Item Snctable.Fromstartfield
                            Set Label to "Source Start Field"
                            Set Size to 13 150
                            Set Location to 22 78
                            Set Form_Border to 0
                            Set Label_Row_Offset to 0
                            Set Label_Col_Offset to 2
                            Set Label_Justification_Mode to jMode_Right
                            Set Entry_State to False
                            Set Combo_Sort_State to False
                            Set Code_Display_Mode to cb_Code_Display_Description
                            Set pbFrom to True
                        End_Object    

                        Object oFromStopField_cf is a cDbFieldComboform
                            Entry_Item Snctable.Fromstopfield
                            Set Label to "Source Stop Field"
                            Set Size to 13 150
                            Set Location to 37 78
                            Set Form_Border to 0
                            Set Label_Row_Offset to 0
                            Set Label_Col_Offset to 2
                            Set Label_Justification_Mode to jMode_Right
                            Set Entry_State to False
                            Set Combo_Sort_State to False
                            Set Code_Display_Mode to cb_Code_Display_Description
                            Set pbFrom to True
                        End_Object    

                        Object oToStartField_cf is a cDbFieldComboform
                            Entry_Item Snctable.Tostartfield
                            Set Label to "Target Start Field"
                            Set Size to 13 150
                            Set Location to 52 78
                            Set Form_Border to 0
                            Set Label_Row_Offset to 0
                            Set Label_Col_Offset to 2
                            Set Label_Justification_Mode to jMode_Right
                            Set Entry_State to False
                            Set Combo_Sort_State to False
                            Set Code_Display_Mode to cb_Code_Display_Description
                            Set pbFrom to False
                        End_Object    

                        Procedure DoEnableDisable Integer iType
                            Set Enabled_State to (iType = 2)
                        End_Procedure 
                    End_Object    

                    Object oSelectedFields_grp is a cRDSDbGroup
                        Set Size to 181 301
                        Set Location to 118 242
                        Set peAnchors to anAll
                        Set Label to "3 - Selected Field Numbers"
                        
                        Object oFromParentFields_tb is a cRDSTextbox
                            Set Label to "Available Source Fields:"
                            Set Location to 10 7
                            Set Size to 10 77
                        End_Object    

                        Object oFromParentFields_tv is a cParentFieldsTreeView
                            Set pbFrom to True
                            Set peAnchors to anTopLeftRight
                            Set Size to 54 140
                            Set Location to 21 7
                            Set pbFullRowSelect to True
                            Set TreeButtonsState to False
                            Set TreeRetainSelState to True
                            Set Status_Help to "Double-click or press space-bar to select a Source field or the Ins key to insert a Source field"
                            Set psToolTipTitle to (Label(oFromParentFields_tb(Self)))

                            Procedure DoEnableDisable Integer iType
                                If (iType = 3) Begin
                                    Set piBackColor to clNone
                                    Set piTextColor to clNone
                                End 
                                Else Begin
                                    Set piBackColor to clLtGray
                                    Set piTextColor to clGray
                                End 
                            End_Procedure 

                            Procedure DoUpdateData Integer iFromFile Integer iToFile Boolean bFrom
                                Set piFile to iFromFile
                            End_Procedure 
                        End_Object    

                        Object oToParentFields_tb is a cRDSTextbox
                            Set Label to "Available Target Fields:"
                            Set Location to 10 154
                            Set Size to 10 75
                            Set peAnchors to anTopRight
                        End_Object    

                        Object oToParentFields_tv is a cParentFieldsTreeView
                            Set pbFrom to False
                            Set peAnchors to anTopRight
                            Set Size to 54 140
                            Set Location to 21 154
                            Set pbFullRowSelect to True
                            Set TreeButtonsState to False
                            Set TreeRetainSelState to True
                            Set Status_Help to "Double-click or press space-bar to select a Target field or the Ins key to insert a Target field"
                            Set psToolTipTitle to (Label(oToParentFields_tb(Self)))

                            Procedure DoEnableDisable Integer iType
                                If (iType = 3) Begin
                                    Set piBackColor to clNone
                                    Set piTextColor to clNone
                                End 
                                Else Begin
                                    Set piBackColor to clLtGray
                                    Set piTextColor to clGray
                                End 
                            End_Procedure 

                            Procedure DoUpdateData Integer iFromFile Integer iToFile Boolean bFrom
                                Set piFile to iToFile
                            End_Procedure 
                        End_Object    

                        Object oFromChildFields_tb is a cRDSTextbox
                            Set Label to "Selected Source Fields:"
                            Set Location to 79 7
                            Set Size to 10 76
                            Set peAnchors to anTopLeft
                        End_Object    

                        Object oFromChildFields_tv is a cChildFieldsTreeView
                            Set peAnchors to anAll
                            Set Size to 70 140
                            Set Location to 90 7
                            Set pbFullRowSelect to True
                            Set TreeButtonsState to False
                            Set TreeRetainSelState to True
                            Set phoParent to (oFromParentFields_tv(Self))
                            Set psFieldName to "SelFromFields"
                            Set Status_Help to "Double-click or press the Del key to de-select a Source field."
                            Set pbFrom to True
                            Set Server to (Main_DD(Self))
                            Set psToolTipTitle to (Label(oFromChildFields_tb(Self)))

                            Procedure DoEnableDisable Integer iType
                                If (iType = 3) Begin
                                    Set piBackColor to clNone
                                    Set piTextColor to clNone
                                End 
                                Else Begin
                                    Set piBackColor to clLtGray
                                    Set piTextColor to clGray
                                End 
                            End_Procedure 

                            Procedure DoUpdateData Integer iFromFile Integer iToFile Boolean bFrom
                                Set piFile to iFromFile
                                Send OnCreateTree
                            End_Procedure 

                            Procedure UpdateDDO
                                Send DoUpdateDDBuffer (Main_DD(Self)) "SelFromFields" "SelFieldCount"  // Class procedure.
                            End_Procedure 

                            Procedure DoAddItem String sLabel Integer iData
                                Integer iItems
                                Forward Send DoAddItem sLabel iData
                                Get ItemCount to iItems
                                Set Value of oSelFromCount_fm to iItems
                                Set Enabled_State of oAppend_bn to True
                                Send UpdateDDO
                            End_Procedure 

                            Procedure DoInsertItem String sLabel Integer iData
                                Integer iItems
                                Forward Send DoInsertItem sLabel iData
                                Get ItemCount                   to iItems
                                Set Value of oSelFromCount_fm   to iItems
                                Send UpdateDDO
                            End_Procedure 

                            Procedure DoCutItem
                                Integer iItems
                                Forward Send DoCutItem
                                Get ItemCount to iItems
                                Set Value of oSelFromCount_fm to iItems
                                Send UpdateDDO
                            End_Procedure 

                            Procedure DoCreateTree
                                Integer iItems
                                Forward Send DoCreateTree
                                Get ItemCount to iItems
                                Set Value of oSelFromCount_fm   to iItems
                                Set Enabled_State of oAppend_bn to iItems
                            End_Procedure 

                            Procedure OnItemChanged Handle hItem Handle hItemOld
                                Integer iData iItem
                                Get ItemNumber hItem to iItem // New class function.
                                Send DoFindMatchingItem of oToChildFields_tv iItem
                            End_Procedure 
                        End_Object    

                        Object oToChildFields_tb is a cRDSTextbox
                            Set Label to "Selected Target Fields:"
                            Set Location to 80 154
                            Set Size to 10 74
                            Set peAnchors to anTopRight
                        End_Object    

                        Object oToChildFields_tv is a cChildFieldsTreeView
                            Set peAnchors to anTopBottomRight
                            Set Size to 70 140
                            Set Location to 91 154
                            Set pbFullRowSelect to True
                            Set TreeButtonsState to False
                            Set TreeRetainSelState to True
                            Set phoParent to (oToParentFields_tv(Self))
                            Set psFieldName to "SelToFields"
                            Set Status_Help to "Double-click or press the Del key to de-select a Target field."
                            Set pbFrom to False
                            Set Server to (Main_DD(Self))
                            Set psToolTipTitle to (Label(oToChildFields_tb(Self)))

                            Procedure DoEnableDisable Integer iType
                                If (iType = 3) Begin
                                    Set piBackColor to clNone
                                    Set piTextColor to clNone
                                End 
                                Else Begin
                                    Set piBackColor to clLtGray
                                    Set piTextColor to clGray
                                End 
                            End_Procedure 

                            Procedure DoUpdateData Integer iFromFile Integer iToFile Boolean bFrom
                                Set piFile to iToFile
                                Send OnCreateTree
                            End_Procedure 

                            Procedure UpdateDDO
                                Send DoUpdateDDBuffer (Main_DD(Self)) "SelToFields"   ""  // Class procedure.
                            End_Procedure 

                            Procedure DoAddItem String sLabel Integer iData
                                Integer iItems
                                Forward Send DoAddItem sLabel iData
                                Get ItemCount to iItems
                                Set Value of oSelToCount_fm to iItems
                                Send UpdateDDO
                            End_Procedure 

                            Procedure DoInsertItem String sLabel Integer iData
                                Integer iItems
                                Forward Send DoInsertItem sLabel iData
                                Get ItemCount to iItems
                                Set Value of oSelFromCount_fm to iItems
                                Send UpdateDDO
                            End_Procedure 

                            Procedure DoCutItem
                                Integer iItems
                                Forward Send DoCutItem
                                Get ItemCount to iItems
                                Set Value of oSelToCount_fm to iItems
                                Send UpdateDDO
                            End_Procedure 

                            Procedure DoCreateTree
                                Integer iItems
                                Forward Send DoCreateTree
                                Get ItemCount to iItems
                                Set Value of oSelToCount_fm to iItems
                            End_Procedure 

                            Procedure DoFindMatchingItem Integer iItem
                                Handle hNew
                                Get ItemHandle iItem to hNew // New class function.
                                Set CurrentTreeItem  to hNew
                            End_Procedure 
                        End_Object    

                        Object oAppend_bn is a cBitmapButton
                            Set Label to "&Append Field"
                            Set Size to 13 71
                            Set Location to 164 7
                            Set Status_Help to "Append a field to the currently selected Source data table field number"
                            Set peAnchors to anBottomLeft
                            Set Bitmap to "Append16.bmp"
                            Set piTransparentColor to clFuchsia

                            Procedure OnClick
                                Handle ho hItem
                                Integer iFile
                                String sLabel sField
                                Move (oFromChildFields_tv(Self)) to ho
                                Get piFile of ho to iFile
                                Get CurrentTreeItem of ho to hItem
                                If not hItem Get RootItem of ho to hItem
                                Get ItemLabel of ho hItem to sLabel
                                If (not(iFile) or (Length(sLabel) = 0)) Procedure_Return
                                Send Activate of ho
                                Get IsStartoAppend_dg (Main_DD(Self)) iFile sLabel to sField
                                If (sField <> "") Begin
                                    Set ItemLabel  of ho hItem to (String(sLabel) * "+" * String(sField))
                                    Send UpdateDDO of ho
                                End 
                            End_Procedure 
                        End_Object    

                        Object oSelFromCount_fm is a cRDSForm
                            Set Label to "Select Count"
                            Set Size to 13 21
                            Set Location to 164 126
                            Set Status_Help to "Number of selected fields/columns for the source table"
                            Set peAnchors to anBottomRight
                            Set Label_Col_Offset to 0
                            Set Label_Justification_Mode to jMode_Right
                            Set Enabled_State to False

                            Procedure Set Enabled_State Boolean bState
                                Forward Set Enabled_State to False
                            End_Procedure 
                        End_Object    

                        Object oSelToCount_fm is a cRDSForm
                            Set Label to "Select Target Count"
                            Set Size to 13 21
                            Set Location to 164 273
                            Set Status_Help to "Number of selected fields/columns for the Target table"
                            Set peAnchors to anBottomRight
                            Set Label_Col_Offset to 0
                            Set Label_Justification_Mode to jMode_Right
                            Set Enabled_State to False

                            Procedure Set Enabled_State Boolean bState
                                Forward Set Enabled_State to False
                            End_Procedure 
                        End_Object    

                        Object oTextBox1 is a cRDSTextbox
                            Set Label to "->"
                            Set Location to 92 147
                            Set Size to 10 7
                            Set peAnchors to anTopRight
                        End_Object    

                        Object oTextBox2 is a cRDSTextbox
                            Set Label to "->"
                            Set Location to 102 147
                            Set Size to 10 7
                            Set peAnchors to anTopRight
                        End_Object    

                        Object oTextBox3 is a cRDSTextbox
                            Set Label to "->"
                            Set Location to 112 147
                            Set Size to 10 7
                            Set peAnchors to anTopRight
                        End_Object    

                        Object oTextBox4 is a cRDSTextbox
                            Set Label to "->"
                            Set Location to 122 147
                            Set Size to 10 7
                            Set peAnchors to anTopRight
                        End_Object    

                        Object oTextBox7 is a cRDSTextbox
                            Set Label to "->"
                            Set Location to 131 147
                            Set Size to 10 7
                            Set peAnchors to anTopRight
                        End_Object    

                        Object oTextBox13 is a cRDSTextbox
                            Set Label to "->"
                            Set Location to 140 147
                            Set Size to 10 7
                            Set peAnchors to anTopRight
                        End_Object    // oTextBox13

                        Object oTextBox14 is a cRDSTextbox
                            Set Label to "->"
                            Set Location to 149 147
                            Set Size to 10 7
                            Set peAnchors to anTopRight
                        End_Object    

                        Procedure DoEnableDisable Integer iType
                            Set Enabled_State to (iType = 3)
                        End_Procedure 

                        Procedure Set Enabled_State Boolean bState
                            Handle ho
                            Forward Set Enabled_State to bState
                            Send Enable_Window of (Label_Object(oSelFromCount_fm(Self))) bState
                            Send Enable_Window of (Label_Object(oSelToCount_fm(Self)))   bState
                            Set Enabled_State  of oAppend_bn                          to bState
                        End_Procedure 

                        On_Key Key_Alt+Key_A Send KeyAction of oAppend_bn
                    End_Object    

                    Procedure DoUpdateData Integer iFromFile Integer iToFile Boolean bFrom
                        Set Enabled_State of oSnctable_Synchtype to (iFromFile and iToFile)
                    End_Procedure 

                    On_Key Key_Alt+Key_V Send KeyAction of oViewFromData_bn
                    On_Key Key_Alt+Key_D Send KeyAction of oViewToData_bn
                End_Object    

                Object oDbTabPage3 is a cRDSDbTabPage
                    Set Label to "Index/Sorting"
                    Set Tab_ToolTip_Value to "Index to use to finding an equal Destination table record"
                    Set piImageIndex to 6
                    
                    Object oFromIndex_grp is a cRDSDbGroup
                        Set Size to 146 540
                        Set Location to 1 3
                        Set peAnchors to anLeftRight
                        Set Label to "Source Database Table Index (Only available when 'Auto delete old records' is checked. See below)"
                    
                        Object oSnctable_FromdataTable_Index is a cRDSDbForm
                            Entry_Item Snctable.Fromdatatable
                            Set Label to "Table Name"
                            Set Size to 13 150
                            Set Location to 10 78
                            Set Label_Col_Offset to 2
                            Set Label_Justification_Mode to jMode_Right
                            Set Enabled_State to False

                            Procedure Set Enabled_State Boolean bState
                                Forward Set Enabled_State to False
                            End_Procedure 
                        End_Object    

                        Object oSnctable_Fromindex is a cDbIndexComboform
                            Entry_Item Snctable.Fromindex
                            Set Label to "Select Unique Index"
                            Set Size to 12 150
                            Set Location to 25 78
                            Set Form_Border to 0
                            Set Label_Row_Offset to 0
                            Set Label_Col_Offset to 2
                            Set Label_Justification_Mode to jMode_Right
                            Set Entry_State to False
                            Set Combo_Sort_State to True
                            Set Code_Display_Mode to cb_Code_Display_Both
                            Set pbFrom to True

                            Procedure OnChange
                                Forward Send OnChange
                                Send DoCreateTree of oChildToFields_tv
                                Send OnCreateTree of oFromIndexFields_tv
                            End_Procedure 
                        End_Object    

                        Object oViewFromData_bn is a cViewDataButton
                            Set Label to "&View Data"
                            Set Size to 13 60
                            Set Location to 66 78
                            Set Status_Help to "View data for the Source database table."
                            Set Bitmap to "ViewData16.bmp"
                            Set piTransparentColor to clFuchsia
                            Set pbFrom to True

                            Procedure OnClick
                                Send DoViewData True -1
                            End_Procedure 
                        End_Object    

                        Object oSnctable_Fridxselcount is a cRDSDbForm
                            Entry_Item Snctable.Fridxselcount
                            Set Label to "Select Count"
                            Set Size to 13 23
                            Set Location to 130 205
                            Set Label_Col_Offset to 2
                            Set Label_Justification_Mode to jMode_Right

                            Procedure Set Enabled_State Boolean bState
                                Forward Set Enabled_State to False
                            End_Procedure 
                        End_Object    

                        Object oParentToFields_tb is a cRDSTextbox
                            Set Label to "Available Target Field Numbers:"
                            Set Location to 14 246
                            Set Size to 10 101
                        End_Object    

                        Object oParentToFields_tv is a cParentFieldsTreeView
                            Set pbFrom to False
                            Set peAnchors to anTopLeftRight
                            Set Size to 54 140
                            Set Location to 25 246
                            Set Status_Help to "Double-click or press space-bar or the Ins key to select a Target field"
                            Set psToolTipTitle to (Label(oParentToFields_tb(Self)))

                            Procedure DoUpdateData Integer iFromFile Integer iToFile Boolean bFrom
                                Set piFile to iToFile
                            End_Procedure 
                        End_Object    

                        Object oInfo_tb is a cRDSTextbox
                            Set Label to "Select the fields that should be used to populate the Source table's index, to do a find equal search. Only used when 'Auto delete old records' is checked."
                            Set Auto_Size_State to False
                            Set Location to 25 394
                            Set Size to 54 140
                            Set Border_Style to Border_StaticEdge
                            Set Justification_Mode to jMode_Left
                            Set peAnchors to anTopRight
                        End_Object    

                        Object oChildToFields_tb is a cRDSTextbox
                            Set Label to "Selected Target Field Numbers:"
                            Set Location to 79 246
                            Set Size to 10 101
                        End_Object    

                        Object oChildToFields_tv is a cChildFieldsTreeView
                            Set peAnchors to anBottomLeftRight
                            Set Size to 54 140
                            Set Location to 89 246
                            Set phoParent to (oParentToFields_tv(Self))
                            Set psFieldName to "ToFieldsFromIdx"
                            Set Status_Help to "Double-click or press the Del key to de-select a Target field."
                            Set pbFrom to False
                            Set Server to (Main_DD(Self))
                            Set psToolTipTitle to (Label(oChildToFields_tb(Self)))

                            Property Handle phoCount (oSnctable_Fridxselcount(Self))

                            Procedure DoUpdateData Integer iFromFile Integer iToFile Boolean bFrom
                                Set piFile to iFromFile
                                Send OnCreateTree
                            End_Procedure 

                            Procedure UpdateDDO
                                Send DoUpdateDDBuffer (Main_DD(Self)) "ToFieldsFromIdx" "FrIdxSelCount" // Class procedure.
                            End_Procedure 

                            Procedure DoAddItem String sLabel Integer iData
                                Forward Send DoAddItem sLabel iData
                                Send UpdateDDO
                            End_Procedure 

                            Procedure DoInsertItem String sLabel Integer iData
                                Forward Send DoInsertItem sLabel iData
                                Send UpdateDDO
                            End_Procedure 

                            Procedure DoCutItem
                                Forward Send DoCutItem
                                Send UpdateDDO
                            End_Procedure 
                        End_Object    

                        Object oFromIndexFields_tb is a cRDSTextbox
                            Set Label to "Source Index Segments:"
                            Set Location to 79 397
                            Set Size to 10 79
                            Set peAnchors to anTopRight
                        End_Object    

                        Object oFromIndexFields_tv is a cRDSTreeView
                            Set peAnchors to anBottomRight
                            Set Size to 54 140
                            Set Location to 89 394
                            Set piBackColor to clLtGray
                            Set TreeRootLinesState to False
                            Set TreeLinesState to False
                            Set TreeButtonsState to False
                            Set psToolTipTitle to (Label(oFromIndexFields_tb(Self)))
                            Set Status_Help to "The segments (or fields) that the selected Source index consist of."

                            Procedure DoDeleteAllData
                                Handle hRootItem
                                Get RootItem to hRootItem
                                While (hRootItem <> 0)
                                    Send DoDeleteItem hRootItem
                                    Get RootItem to hRootItem
                                Loop
                            End_Procedure 

                            Procedure OnCreateTree
                                Handle hItem
                                Integer iFile iIndex iFields iField iCount iType iLength iPrec iOpen
                                String sFieldName sSpace sChar sType
                                Get Field_Current_Value of (Main_DD(Self)) Field SncTable.FromFile  to iFile
                                Get Field_Current_Value of (Main_DD(Self)) Field SncTable.FromIndex to iIndex
                                Send DoDeleteAllData
                                If iFile Get_Attribute DF_FILE_OPENED of iFile to iOpen
                                If not iOpen Procedure_Return
                                Get_Attribute DF_INDEX_NUMBER_SEGMENTS of iFile iIndex to iFields
                                For iCount From 1 to iFields
                                    Move "" to sSpace
                                    If (iFields >= 10 and iCount < 10) Move " "                 to sSpace
                                    Get_Attribute DF_INDEX_SEGMENT_FIELD of iFile iIndex iCount to iField
                                    Get FieldSpecs iFile iField                                 to sFieldName // Function in SyncFuncs.pkg
                                    Get AddTreeItem (sSpace + String(iCount) * "-" * sFieldName) 0 iCount 0 0 to hItem
                                Loop
                            End_Procedure 
                        End_Object    

                        Procedure DoUpdateData Integer iFromFile Integer iToFile Boolean bFrom
                            Handle ho
                            String sTable
                            Integer iOpen bState
                            Get Field_Current_Value of (Main_DD(Self)) Field SncTable.FromDataTable  to sTable
                            Get Field_Current_Value of (Main_DD(Self)) Field SncTable.Delete_Records to bState
                            If iFromFile Get_Attribute DF_FILE_OPENED of iFromFile                   to iOpen
                            Set Enabled_State to (iOpen and Length(sTable) > 0 and bState)
                        End_Procedure 

                        Procedure Set Enabled_State Boolean bState
                            Integer iColor
                            Forward Set Enabled_State to bState
                            If bState Move clNone     to iColor
                            Else      Move clLtGray   to iColor
                            Set piBackColor of oParentToFields_tv to iColor
                            Set piBackColor of oChildToFields_tv  to iColor
                        End_Procedure  
                    End_Object 

                    Object oToIndex_grp is a cRDSDbGroup
                        Set Size to 148 540
                        Set Location to 148 3
                        Set peAnchors to anAll
                        Set Label to "Target Database Table Index"
                        Object oSnctable_TodataTable_Index is a cRDSDbForm
                            Entry_Item Snctable.Todatatable
                            Set Label to "Table Name"
                            Set Size to 13 150
                            Set Location to 10 78
                            Set Label_Col_Offset to 2
                            Set Label_Justification_Mode to jMode_Right
                            Set Enabled_State to False

                            Procedure Set Enabled_State Boolean bState
                                Forward Set Enabled_State to False
                            End_Procedure 
                        End_Object    

                        Object oSnctable_Toindex is a cDbIndexComboform
                            Entry_Item Snctable.Toindex
                            Set Label to "Select Unique Index"
                            Set Size to 13 150
                            Set Location to 25 78
                            Set Form_Border to 0
                            Set Label_Row_Offset to 0
                            Set Label_Col_Offset to 2
                            Set Label_Justification_Mode to jMode_Right
                            Set Entry_State to False
                            Set Combo_Sort_State to True
                            Set Code_Display_Mode to cb_Code_Display_Both
                            Set pbFrom to False

                            Procedure OnChange
                                Forward Send OnChange
                                Send DoCreateTree of oChildFromFields_tv
                                Send OnCreateTree of oToIndexFields_tv
                            End_Procedure 
                        End_Object    

                        Object oSnctable_DeleteSourceRecords is a cRDSDbCheckBox
                            Entry_Item Snctable.DeleteSourceRecords
                            Set Label to "Auto delete Source table records"
                            Set Size to 13 115
                            Set Location to 41 78     
                            Procedure OnChange
                                Boolean bState             
                                Get Checked_State to bState  
                                Set Enabled_State of oSnctable_DeleteTargetRecords to (not(bState))
                            End_Procedure
                        End_Object    

                        Object oSnctable_DeleteTargetRecords is a cRDSDbCheckBox
                            Entry_Item Snctable.Delete_records
                            Set Label to "Auto delete old Target table records"
                            Set Size to 13 115
                            Set Location to 53 78

                            Procedure OnChange
                                Handle ho
                                Boolean bState
                                Get Checked_State  to bState
                                Set Enabled_State  of oSnctable_DeleteSourceRecords to (not(bState))
                                Set Enabled_State  of oFromIndex_grp                           to bState
                                Set Enabled_State  of (oViewFromData_bn(oFromIndex_grp(Self))) to bState
                                Get Label_Object   of (oSnctable_FromdataTable_Index(Self))    to ho
                                Send Enable_Window of ho bState
                                Get Label_Object   of (oSnctable_FrIdxSelCount(Self))          to ho
                                Send Enable_Window of ho bState
                            End_Procedure

                            Function Next_Object_Id Returns Integer
                                Handle ho
                                Move (oParentFromFields_tv(Self)) to ho
                                Function_Return ho
                            End_Function  
                        End_Object    

                        Object oViewToData_bn is a cViewDataButton
                            Set Label to "View &Data"
                            Set Size to 13 60
                            Set Location to 66 78
                            Set Status_Help to "View data for the Target database table."
                            Set Bitmap to "ViewData16.bmp"
                            Set Enabled_State to False
                            Set piTransparentColor to clFuchsia
                            Set pbFrom to False

                            Procedure OnClick
                                Send DoViewData True -1
                            End_Procedure 
                        End_Object    

                        Object oSnctable_Toidxselcount is a cRDSDbForm
                            Entry_Item Snctable.Toidxselcount
                            Set Label to "Select Count"
                            Set Size to 13 23
                            Set Location to 130 204
                            Set peAnchors to anBottomLeft
                            Set Label_Col_Offset to 2
                            Set Label_Justification_Mode to jMode_Right

                            Procedure Set Enabled_State Boolean bState
                                Forward Set Enabled_State to False
                            End_Procedure 
                        End_Object    

                        Object oParentFromFields_tb is a cRDSTextbox
                            Set Label to "Available Source Field Numbers:"
                            Set Location to 14 246
                            Set Size to 10 103
                        End_Object    

                        Object oParentFromFields_tv is a cParentFieldsTreeView
                            Set pbFrom to True
                            Set peAnchors to anTopLeftRight
                            Set Size to 54 140
                            Set Location to 25 246
                            Set pbFullRowSelect to True
                            Set TreeButtonsState to False
                            Set TreeRetainSelState to True
                            Set Status_Help to "Double-click or press space-bar or the Ins key to select a Source field"
                            Set psToolTipTitle to (Label(oParentFromFields_tb(Self)))

                            Procedure DoUpdateData Integer iFromFile Integer iToFile Boolean bFrom
                                Set piFile to iFromFile
                            End_Procedure 
                        End_Object    

                        Object oInfo_tb is a cRDSTextbox
                            Set Label to "Select the fields that should be used to populate the Target table's index, to do a find equal search."
                            Set Auto_Size_State to False
                            Set Location to 25 394
                            Set Size to 54 140
                            Set Border_Style to Border_StaticEdge
                            Set Justification_Mode to jMode_Left
                            Set peAnchors to anTopRight
                        End_Object    

                        Object oChildFromFields_tb is a cRDSTextbox
                            Set Label to "Selected Source Field Numbers:"
                            Set Location to 79 246
                            Set Size to 10 103
                        End_Object    

                        Object oChildFromFields_tv is a cChildFieldsTreeView
                            Property Handle phoCount (oSnctable_Toidxselcount(Self))

                            Set peAnchors to anAll
                            Set Size to 54 140
                            Set Location to 89 246
                            Set phoParent to (oParentFromFields_tv(Self))
                            Set psFieldName to "FromFieldsToIdx"
                            Set Status_Help to "Double-click or press the Del key to de-select a Source field."
                            Set pbFrom to True
                            Set Server to (Main_DD(Self))
                            Set psToolTipTitle to (Label(oChildFromFields_tb(Self)))

                            Procedure DoUpdateData Integer iFromFile Integer iToFile Boolean bFrom
                                Set piFile to iFromFile
                                Send OnCreateTree
                            End_Procedure 

                            Procedure UpdateDDO
                                Send DoUpdateDDBuffer (Main_DD(Self)) "FromFieldsToIdx" "ToIdxSelCount"
                            End_Procedure 

                            Procedure DoAddItem String sLabel Integer iData
                                Boolean bOk
                                Get IsCheckSegmentCount to bOk
                                If not bOk Procedure_Return
                                Forward Send DoAddItem sLabel iData
                                Send UpdateDDO
                            End_Procedure 

                            Procedure DoInsertItem String sLabel Integer iData
                                Boolean bOk
                                Get IsCheckSegmentCount to bOk
                                If not bOk Procedure_Return
                                Forward Send DoInsertItem sLabel iData
                                Send UpdateDDO
                            End_Procedure 

                            Procedure DoCutItem
                                Forward Send DoCutItem
                                Send UpdateDDO
                            End_Procedure 

                            Function IsCheckSegmentCount Returns Boolean
                                Integer iItems iSegments
                                Get Value     of (phoCount(Self))          to iItems
                                Get ItemCount of (oToIndexFields_tv(Self)) to iSegments
                                If (iItems >= iSegments) Send Info_Box "The number of fields to fill the selected index has already been reached. If you want to add another field, you first need to delete a field by pressing the 'Del' key, in this list."
                                Function_Return (iItems < iSegments)
                            End_Function 
                        End_Object    

                        Object oToIndexFields_tb is a cRDSTextbox
                            Set Label to "Target Index Segments:"
                            Set Location to 79 394
                            Set Size to 10 77
                            Set peAnchors to anTopRight
                        End_Object    

                        Object oToIndexFields_tv is a cRDSTreeView
                            Set peAnchors to anTopBottomRight
                            Set Size to 54 140
                            Set Location to 89 394
                            Set piBackColor to clLtGray
                            Set TreeRootLinesState to False
                            Set TreeLinesState to False
                            Set TreeButtonsState to False
                            Set psToolTipTitle to (Label(oToIndexFields_tb(Self)))
                            Set Status_Help to "The segments (or fields) that the selected Target index consist of."

                            Procedure DoDeleteAllData
                                Handle hRootItem
                                Get RootItem to hRootItem
                                While (hRootItem <> 0)
                                    Send DoDeleteItem hRootItem
                                    Get RootItem to hRootItem
                                Loop
                            End_Procedure 

                            Procedure OnCreateTree
                                Handle hItem
                                Integer iFile iIndex iFields iField iCount iType iLength iPrec iOpen
                                String sFieldName sSpace sChar sType
                                Get Field_Current_Value of (Main_DD(Self)) Field SncTable.ToFile  to iFile
                                Get Field_Current_Value of (Main_DD(Self)) Field SncTable.ToIndex to iIndex
                                Send DoDeleteAllData
                                If iFile Get_Attribute DF_FILE_OPENED of iFile to iOpen
                                If not iOpen Procedure_Return
                                Get_Attribute DF_INDEX_NUMBER_SEGMENTS of iFile iIndex to iFields
                                For iCount From 1 to iFields
                                    Move "" to sSpace
                                    If (iFields >= 10 and iCount < 10) Move " "                 to sSpace
                                    Get_Attribute DF_INDEX_SEGMENT_FIELD of iFile iIndex iCount to iField
                                    Get FieldSpecs iFile iField                                 to sFieldName
                                    Get AddTreeItem (sSpace + String(iCount) * "-" * sFieldName) 0 iCount 0 0 to hItem
                                Loop
                            End_Procedure 
                        End_Object    

                        Object oTextBox8 is a cRDSTextbox
                            Set Label to "->"
                            Set Location to 90 386
                            Set Size to 10 7
                            Set peAnchors to anTopRight
                        End_Object    

                        Object oTextBox9 is a cRDSTextbox
                            Set Label to "->"
                            Set Location to 99 386
                            Set Size to 10 7
                            Set peAnchors to anTopRight
                        End_Object    

                        Object oTextBox10 is a cRDSTextbox
                            Set Label to "->"
                            Set Location to 108 386
                            Set Size to 10 7
                            Set peAnchors to anTopRight
                        End_Object    

                        Object oTextBox11 is a cRDSTextbox
                            Set Label to "->"
                            Set Location to 116 386
                            Set Size to 10 7
                            Set peAnchors to anTopRight
                        End_Object    

                        Object oTextBox12 is a cRDSTextbox
                            Set Label to "->"
                            Set Location to 124 386
                            Set Size to 10 7
                            Set peAnchors to anTopRight
                        End_Object    

                        Object oTextBox16 is a cRDSTextbox
                            Set Label to "->"
                            Set Location to 133 386
                            Set Size to 10 7
                            Set peAnchors to anTopRight
                        End_Object    

                        Procedure DoUpdateData Integer iFromFile Integer iToFile Boolean bFrom
                            Handle ho
                            String sTable
                            Integer iOpen
                            Get Field_Current_Value of (Main_DD(Self)) Field SncTable.ToDataTable to sTable
                            If iToFile Get_Attribute DF_FILE_OPENED of iToFile                    to iOpen
                            Set Enabled_State  to (iOpen and Length(sTable) > 0)
                        End_Procedure 

                        Procedure Set Enabled_State Boolean bState
                            Handle ho
                            Integer iColor
                            Forward Set Enabled_State to bState
                            Get Label_Object of (oSnctable_TodataTable_Index(Self)) to ho
                            Send Enable_Window of ho bState
                            Get Label_Object of (oSnctable_ToDatabase(Self)) to ho
                            Send Enable_Window of ho bState
                            Get Label_Object of (oSnctable_FrIdxSelCount(Self)) to ho
                            Send Enable_Window of ho bState
                            Get Label_Object of (oSnctable_ToIdxSelCount(Self)) to ho
                            Send Enable_Window of ho bState
                            If bState Move clNone   to iColor
                            Else      Move clLtGray to iColor
                            Set piBackColor of oParentFromFields_tv to iColor
                            Set piBackColor of oChildFromFields_tv  to iColor
                        End_Procedure 
                    End_Object    

                    On_Key Key_Alt+Key_V Send KeyAction of oViewFromData_bn
                    On_Key Key_Alt+Key_D Send KeyAction of oViewToData_bn
                End_Object    

                Object oDbTabPage4 is a cRDSDbTabPage
                    Set Label to "Filters"
                    Set Tab_ToolTip_Value to "Filters or selections for the source table"
                    Set piImageIndex to 7
                    
                    Object oConstraints_grp is a cRDSDbGroup
                        Set Size to 295 540
                        Set Location to 1 3
                        Set peAnchors to anAll
                        Set Label to "Filters/Selections for the source table. Use it if only some records for the source table should be selected"
                    
                        Object oFields_cf is a cDbFieldComboform
                            Set Label to "Field/Column Number"
                            Set Size to 13 150
                            Set Location to 25 78
                            Set Status_Help to "Fields/columns for the selected Source data table"
                            Set Form_Border to 0
                            Set Label_Row_Offset to 0
                            Set Label_Col_Offset to 2
                            Set Label_Justification_Mode to jMode_Right
                            Set Entry_State to False
                            Set Combo_Sort_State to False
                            Set Code_Display_Mode to cb_Code_Display_Description
                            Set pbFrom to True

                            Procedure OnChange
                                Handle hoList
                                String sType sField
                                Integer iLength iPrec iField iFile iType iOpen
                                Move -1 to iType
                                Get Value Item 0    to sField
                                Get FileFieldNumber to iField     // Class function.
                                Move (Trim(sField)) to sField
                                If (sField contains "<None>" or sField = "") Begin
                                    Set Value   of oValue_fm                        to ""
                                    Set Value   of oType_fm                         to ""
                                    Set Value   of oLength_fm                       to ""
                                    Set Enabled_State of oSelect_bn                 to False
                                    Procedure_Return
                                End 

                                Get Field_Current_Value of (Main_DD(Self)) Field SncTable.FromFile to iFile
                                Get_Attribute DF_FILE_OPENED     of iFile         to iOpen
                                If not iOpen Procedure_Return
                                Get_Attribute DF_FIELD_TYPE      of iFile iField  to iType
                                Get_Attribute DF_FIELD_LENGTH    of iFile iField  to iLength
                                Get_Attribute DF_FIELD_PRECISION of iFile iField  to iPrec
                                If (iType = DF_BCD) Move (iLength - iPrec)        to iLength
                                Else                Move 0                        to iPrec
                                Get_Attribute DF_FIELD_NAME      of iFile iField  to sField
                                Get UpperFirstChar sField                         to sField
                                Get FieldType iType                               to sType
                                Set Value   of oType_fm                           to sType
                                Set Value   of oLength_fm                         to (String(iLength) + "," + String(iPrec))
                                Set psField of oConstraints_lst                   to sField
                                Set piType  of oConstraints_lst                   to iType
                                Send DoEnableDisable of oSelect_bn 0
                            End_Procedure 

                            // This is a dbComboform but not attached to a db field.
                            // We kill these two procedures so the DDO doesn't get triggered:
                            Procedure Set Changed_Value Integer iField String sValue
                            End_Procedure
                            Procedure Set Changed_State Boolean bState
                            End_Procedure
                        End_Object    

                        Object oMode_cf is a cRDSComboForm
                            Set Label to "Mode"
                            Set Size to 13 47
                            Set Location to 25 256
                            Set Status_Help to "Logical operators to use for the filter"
                            Set Form_Border to 0
                            Set Label_Col_Offset to 2
                            Set Label_Justification_Mode to jMode_Right
                            Set Entry_State Item 0 to False
                            Set Combo_Sort_State to False

                            Procedure OnChange
                                Integer iItem
                                String sMode
                                Get WinCombo_Current_Item      to iItem
                                Get WinCombo_Value Item iItem  to sMode
                                If (Trim(sMode) = "") Move "<" to sMode
                                Set psMode of oConstraints_lst to sMode
                            End_Procedure  

                            Procedure Combo_Fill_List
                                Send Combo_Add_Item "<"
                                Send Combo_Add_Item "<="
                                Send Combo_Add_Item "="
                                Send Combo_Add_Item "<>"
                                Send Combo_Add_Item ">"
                                Send Combo_Add_Item ">="
                                Send Combo_Add_Item "Matches"
                                Send Combo_Add_Item "Contains"
                                Set Value Item 0 to "<"
                            End_Procedure  

                            Procedure DoFillList
                                Send Combo_Delete_Data
                                Send Combo_Fill_List
                            End_Procedure

                            Procedure DoCheckClear
                                Send DoFillList
                            End_Procedure 
                        End_Object    

                        Object oValue_fm is a cRDSForm
                            Set Label to "Value"
                            Set Size to 13 119
                            Set Location to 25 330
                            Set Status_Help to "The value to filter the selected Source data field."
                            Set Label_Col_Offset to 2
                            Set Label_Justification_Mode to jMode_Right

                            Procedure OnChange
                                String sValue
                                Get Value Item 0 to sValue
                                Set psValue of oConstraints_lst to sValue
                            End_Procedure  

                            Procedure DoCheckClear
                                Set Value to ""
                            End_Procedure 
                        End_Object    

                        Object oSelect_bn is a cBitmapButton
                            Set Label to "&Select"
                            Set Size to 13 60
                            Set Location to 24 451
                            Set Status_Help to "Add the entered filter to the list below"
                            Set Bitmap to "Ok16.bmp"
                            Set piTransparentColor to clFuchsia

                            Procedure OnClick
                                Handle ho
                                String sValue sField sText
                                Integer iType iRetval
                                Move (oConstraints_lst(Self)) to ho
                                Get piType  of ho to iType
                                Get psValue of ho to sValue
                                Get psField of ho to sField
                                If (sField = "") Begin
                                    Send Info_Box "You need to select a field first."
                                    Procedure_Return
                                End 
                                If (iType = DF_DATE or iType = DF_BCD) Begin
                                    If (iType = DF_DATE) Begin
                                        Get IsDate    sValue to iRetval
                                        If not iRetval Move "Incorrect date format. Hint: Press the 'View Data' button and press Enter on a date." to sText
                                    End 
                                    If (iType = DF_BCD)  Begin
                                        Get IsNumeric sValue to iRetval
                                        If not iRetval Move "Value should be numeric." to sText
                                    End 
                                    If not iRetval Begin
                                        Send Info_Box sText
                                        Procedure_Return
                                    End 
                                End 
                                Send DoAddToList      of ho
                                Send DoUpdateDDBuffer of ho
                            End_Procedure 

                            Procedure DoEnableDisable Integer iValue
                                String sTable sField
                                Integer iFile iOpen
                                Get psField of oConstraints_lst to sField
                                Get Field_Current_Value of (Main_DD(Self)) Field SncTable.FromFile      to iFile
                                Get Field_Current_Value of (Main_DD(Self)) Field SncTable.FromDataTable to sTable
                                Move (Trim(sTable)) to sTable
                                If iFile Get_Attribute DF_FILE_OPENED of iFile to iOpen
                                Set Enabled_State to (Length(sField) > 0 and Length(sTable) > 0 and iOpen)
                            End_Procedure 

                            Procedure DoCheckClear
                                Send DoEnableDisable 0
                            End_Procedure 
                        End_Object    

                        Object oType_fm is a cRDSForm
                            Set Label to "Field/Column Type"
                            Set Size to 13 56
                            Set Location to 40 330
                            Set Status_Help to "The selected field/column type"
                            Set Label_Col_Offset to 1
                            Set Label_Justification_Mode to jMode_Right
                            Set Enabled_State to False

                            Procedure Set Enabled_State Boolean bState
                                Forward Set Enabled_State to False
                            End_Procedure 
                        End_Object    

                        Object oLength_fm is a cRDSForm
                            Set Label to "Length"
                            Set Size to 13 33
                            Set Location to 40 416
                            Set Status_Help to "The selected field/column length and precision"
                            Set Label_Col_Offset to 1
                            Set Label_Justification_Mode to jMode_Right
                            Set Enabled_State to False

                            Procedure Set Enabled_State Boolean bState
                                Forward Set Enabled_State to False
                            End_Procedure 
                        End_Object    

                        Object oViewFromData_bn is a cViewDataButton
                            Set Label to "&View Data"
                            Set Size to 13 60
                            Set Location to 40 451
                            Set Status_Help to "View data for the Source database table."
                            Set Bitmap to "ViewData16.bmp"
                            Set Enabled_State to False
                            Set piTransparentColor to clFuchsia
                            Set pbFrom to True

                            Procedure OnClick
                                Integer iItem
                                String sRetval
                                Get FileFieldNumber of oFields_cf to iItem // Class function.
                                Get msg_DoViewData True iItem to sRetval
                                If (Length(sRetval) > 0) Set Value of oValue_fm to sRetval
                            End_Procedure 
                        End_Object    

                        Object oConstraints_lst is a cRDSList
                            Property Integer piType  -1
                            Property String  psField ""
                            Property String  psValue ""
                            Property String  psMode  "<"

                            Set Label to "Selected Filters (Filters are additive)"
                            Set Size to 190 371
                            Set Location to 58 78
                            Set Status_Help to "List with entered filters/selections. Press Del or Ctrl+X to remove an item."
                            Set peAnchors to anAll
                            Set Label_Col_Offset to 0
                            Set Label_Justification_Mode to jMode_Top

                            Procedure DoAddToList
                                Integer iType
                                String sTable sField sMode sValue sText
                                Get piType  to iType
                                Get Field_Current_Value of (Main_DD(Self)) Field SncTable.Fromdatatable to sTable
                                Get StripExt sTable                                                     to sTable
                                Get psField to sField
                                Get psMode  to sMode
                                Get psValue to sValue
                                Move ("Constrain" * String(sTable) + "." + String(sField) * String(sMode))         to sText
                                If (iType = DF_ASCII or iType = DF_TEXT) Move (sText * '"' + String(sValue) + '"') to sText
                                Else Begin
                                    If (Trim(sValue) = "") Move 0 to sValue
                                    Move (sText * String(sValue)) to sText
                                End 
                                Send Add_Item msg_None sText
                            End_Procedure 

                            Procedure DoDeleteItem
                                Integer iItem
                                Get Item_Count to iItem
                                If not iItem Procedure_Return
                                Get Current_Item to iItem
                                Send Delete_Item iItem
                                Send DoUpdateDDBuffer
                            End_Procedure 

                            Procedure DoFillList
                                Handle hoDD
                                Boolean bTableChanged
                                Integer iCount iFile iField iType iPos iConstr iMode iOpen
                                String sTable sField sConstr sMode sValue sText sSrc sChar

                                Set Dynamic_Update_State to False
                                Send Delete_Data
                                Delegate Get Main_DD to hoDD
                                Get Field_Current_Value of hoDD Field SncTable.Constraints    to sConstr
                                Move (Trim(sConstr)) to sConstr
                                If (Length(sConstr) = 0) Begin
                                    Set Dynamic_Update_State to True
                                    Procedure_Return
                                End 
                                Move (sConstr + "|")                                          to sConstr // Format: "Field_Number|Mode|Value"
                                Get Field_Current_Value of hoDD Field SncTable.FromFile       to iFile
                                Send Ignore_Error of Error_Info_Object 4105 // 'Bad file number'
                                Get_Attribute DF_FILE_OPENED of iFile                         to iOpen
                                Send Trap_Error   of Error_Info_Object 4105 // 'Bad file number'
                                If not iOpen Begin
                                    Set Dynamic_Update_State to True
                                    Procedure_Return
                                End 

                                // This will take care of a special situation.
                                // The user has created a record and has also specified Selfields, and then changes the
                                // datatable comboform to another table...
                                Get Field_Changed_State of hoDD Field SncTable.FromDataTable  to bTableChanged
                                If bTableChanged Begin
                                    // Reset DDO buffer value in case user saves the new config.
                                    Set Field_Changed_Value of hoDD Field SncTable.Constraints  to ""
                                    Set Dynamic_Update_State to True
                                    Procedure_Return
                                End 

                                Get Field_Current_Value of hoDD Field SncTable.Fromdatatable  to sTable
                                Get StripExt sTable                                           to sTable
                                Get Field_Current_Value of hoDD Field SncTable.ConstrainCount to iConstr

                                For iCount From 1 to iConstr
                                    Get ExtractValue sConstr " "                 to iField     // Extract Field Value. (From SyncFuncs.pkg)
                                    Move (Replace((String(iField) + " "), sConstr, "")) to sConstr
                                    Get_Attribute DF_FIELD_NAME of iFile iField  to sField
                                    Get_Attribute DF_FIELD_TYPE of iFile iField  to iType
                                    Set piType                                   to iType
                                    Move (Uppercase(Left(sField, 1)))            to sChar
                                    Move (sChar + Right(Lowercase(sField), (Length(sField) -1))) to sField // Uppercase first letter.
                                    Set psField                                  to sField
                                    Move (Left(sConstr, 1))                      to iMode
                                    Get ExtractMode sConstr                      to sMode
                                    Move (Replace((String(iMode) + " "), sConstr, ""))  to sConstr
                                    Set psMode                                   to sMode
                                    Get ExtractValue sConstr "|"                 to sValue
                                    Move (Replace((sValue + "|"), sConstr, ""))  to sConstr
                                    Set psValue                                  to sValue
                                    Send DoAddToList
                                Loop 
                                Set Dynamic_Update_State to True
                            End_Procedure  

                            Procedure DoUpdateDDBuffer
                                Handle hoDD
                                Integer iCount iFile iField iPos iItems iMode
                                String sTable sField sConstr sMode sValue sText sSrc
                                Delegate Get Main_DD to hoDD
                                Get Field_Current_Value of hoDD Field SncTable.FromFile to iFile
                                If not iFile Procedure_Return
                                Get Item_Count       to iItems
                                For iCount From 0 to (iItems - 1)
                                    Get Value Item iCount                     to sText
                                    Move (sText - " ")                        to sText
                                    Move (Pos(".", sText))                    to iPos
                                    Move (Left(sText, iPos))                  to sTable   // File:
                                    Move (Replace(sTable, sText, ""))         to sText
                                    Get ExtractValue sText " "                to sField   // Function in SysFuncs.pkg
                                    Field_Map iFile sField                    to iField   // Field:
                                    Move (Replace((sField + " "), sText, "")) to sText
                                    Get ExtractMode sText                     to iMode    // Mode (Operator)
                                    Move (Pos(" ", sText))                    to iPos
                                    Move (Right(sText, (Length(sText) - iPos))) to sText
                                    Get ExtractValue sText " "                to sValue
                                    Move (Replace((sValue + " "), sText, "")) to sText
                                    Move (Replaces('"', sValue, ''))          to sValue   // Value
                                    Move (String(iField) * String(iMode) * String(sValue)) to sText
                                    If (iCount < (iItems -1)) Move (sText + "|") to sText
                                    Move (sConstr + String(sText))               to sConstr
                                Loop 
                                Get Field_Current_Value of hoDD Field SncTable.Constraints      to sText
                                If (Trim(sText) <> sConstr) Begin
                                    Set Field_Changed_Value of hoDD Field SncTable.Constraints    to sConstr
                                    Set Field_Changed_Value of hoDD Field SncTable.ConstrainCount to iItems
                                End 
                            End_Procedure  

                            On_Key kDelete_Character Send DoDeleteItem
                            On_Key Key_Shift+Key_F2  Send DoDeleteItem
                            On_Key Key_Ctrl+Key_X    Send DoDeleteItem
                        End_Object    

                        Object oSnctable_Constraincount is a cRDSDbForm
                            Entry_Item Snctable.Constraincount
                            Set Label to "Selected No of Filters"
                            Set Size to 13 18
                            Set Location to 278 431
                            Set peAnchors to anBottomRight
                            Set Label_Col_Offset to 2
                            Set Label_Justification_Mode to jMode_Right

                            Procedure Set Enabled_State Boolean bState
                                Forward Set Enabled_State to False
                            End_Procedure 
                        End_Object    

                        Object oSnctable_FromdataTable_Filter is a cRDSDbForm
                            Entry_Item Snctable.Fromdatatable
                            Set Label to "Source Table Name"
                            Set Size to 13 150
                            Set Location to 10 78
                            Set Label_Row_Offset to 2
                            Set Label_Col_Offset to 0
                            Set Label_Justification_Mode to jMode_Right

                            Set Enabled_State to False
                            Procedure DoUpdateData Integer iFromFile Integer iToFile Boolean bFrom
                                Set Enabled_State of (Label_Object(Self)) to (iFromFile and iToFile)
                                Send Enable_Window of (Label_Object(Self)) (iFromFile and iToFile)
                            End_Procedure 

                            Procedure Set Enabled_State Boolean bState
                                Forward Set Enabled_State to False
                            End_Procedure 
                        End_Object    

                        Procedure DoUpdateData Integer iFromFile Integer iToFile Boolean bFrom
                            Handle ho
                            String sTable
                            Integer iOpen
                            Get Field_Current_Value of (Main_DD(Self)) Field SncTable.Fromdatatable to sTable
                            If iFromFile Get_Attribute DF_FILE_OPENED of iFromFile to iOpen
                            Set Enabled_State  to (Length(sTable) > 0 and iOpen)
                            Move (oConstraints_lst(Self))      to ho
                            If (Enabled_State(Self)) Set Color of ho to clWindow
                            Else                     Set Color of ho to clLtGray
                            Send DoFillList   of ho
                            Set Enabled_State of (Label_Object(ho))                       to (Length(sTable) > 0 and iOpen)
                            Set Enabled_State of (Label_Object(oType_fm))                 to (Length(sTable) > 0 and iOpen)
                            Set Enabled_State of (Label_Object(oLength_fm))               to (Length(sTable) > 0 and iOpen)
                            Set Enabled_State of (Label_Object(oSnctable_Constraincount)) to (Length(sTable) > 0 and iOpen)
                        End_Procedure 

                        On_Key Key_Alt+Key_S Send KeyAction of oSelect_bn
                        On_Key Key_Alt+Key_V Send KeyAction of oViewFromData_bn
                    End_Object    

                    On_Key Key_Alt+Key_S  Send KeyAction to oSelect_bn
                End_Object    

                Object oDbTabPage5 is a cRDSDbTabPage
                    Property Integer piFile      0
                    Property Boolean pbUpdateOk  True
                    Property String  psDefaults  ''
                    Set Label to "Null Defaults"
                    Set Tab_ToolTip_Value to "Null defaults for the Destination table to use for undefined Source table values."
                    Set piImageIndex to 8

                    Object oNullDefaults_grp is a cRDSDbGroup
                        Set Size to 295 540
                        Set Location to 1 3
                        Set peAnchors to anTopBottom
                        Set Label to "Null Defaults"

                        Object oInfo_tb is a cRDSTextbox
                            Set Label to " Used when a source table's field value is undefined. It is suggested that you specify Default Values for formats other than the DataFlex Embedded Database."
                            Set Location to 28 6
                            Set Size to 10 495
                            Set peAnchors to anTopLeft
                        End_Object    

                        Object oValues_grd is a cRDSGrid
                            Set Size to 245 352
                            Set Location to 42 78
                            Set Highlight_Row_state to True
                            Set peAnchors to anAll
                            Set peResizeColumn to rcAll
                            Set GridLine_Mode to GRID_VISIBLE_VERT

                            Set Line_Width to 6 0

                            Set Form_Width    Item 0 to 80
                            Set Header_Label  Item 0 to "Field/Column Name"

                            Set Form_Width    Item 1 to 42
                            Set Header_Label  Item 1 to "Type"

                            Set Form_Width    Item 2 to 36
                            Set Header_Label  Item 2 to "Length"

                            Set Form_Width    Item 3 to 48
                            Set Header_Label  Item 3 to "Null Allowed"

                            Set Form_Width    Item 4 to 60
                            Set Header_Label  Item 4 to "Defined Default"

                            Set Form_Width    Item 5 to 80
                            Set Header_Label  Item 5 to "Use Default Value"

                            Set psToolTipTitle to "Null Default Values"
                            Set psToolTip to "Enter default values in the 'Use Default Value' column. The entered default value will be used if source data is considered to be Null or 'undefined' by the target database. Note: The entered single quotes ' will not get inserted. They are only used to make it easier to distinguish entered space characters."

                            Procedure DoFillGrid
                                Handle hoDD
                                Boolean bTableChanged
                                Integer iFile iCount iFields iType iLength iPrec
                                Integer iNul iOpen iItmCnt iItem iDbType
                                String sDefaults sValue sField sType sDefaultValue sLength
                                Set Dynamic_Update_State to False
                                Send Delete_Data
                                Get Main_DD             to hoDD
                                Get Field_Current_Value of hoDD Field SncTable.ToFile     to iFile
                                If iFile Get_Attribute DF_FILE_OPENED of iFile            to iOpen
                                If not iOpen Begin
                                    Set Dynamic_Update_State to True
                                    Procedure_Return
                                End  

                                Get Field_Current_Value of hoDD Field SncTable.ToDbType   to iDbType
                                Get Field_Changed_State of hoDD Field SncTable.ToDataTable  to bTableChanged
                                If bTableChanged Begin
                                    // Reset DDO buffer value in case user saves the new config.
                                    Set Field_Changed_Value of hoDD Field SncTable.ToDefaults to ""
                                End  

                                Send Default_Value of oDate_fm iDbType // Sets proper default date depending on selected driver.
                                Get Field_Current_Value of hoDD Field SncTable.ToDefaults to sDefaults
                                Move (Trim(sDefaults))  to sDefaults
                                Get_Attribute DF_FILE_NUMBER_FIELDS of iFile to iFields
                                Get Item_Count to iItmCnt
                                Decrement iItmCnt
                                Move 0 to iItem
                                Send Ignore_Error of Error_Info_Object 77
                                Indicate Err False
                                Set Select_Mode to Multi_Select

                                For iCount From 1 to iFields
                                    // Field name:
                                    Get_Attribute DF_FIELD_NAME            of iFile iCount to sField
                                    Get UpperFirstChar sField                              to sField
                                    If (iItem > iItmCnt) Send Add_Item Msg_None sField
                                    Else If (Value(Current_Object, iItem) <> sField) ;
                                        Set Value Item iItem                                 to sField
                                    Set Entry_State Item iItem                             to False
                                    Set ItemColor   Item iItem                             to clBtnFace
                                    Increment iItem

                                    // Type:
                                    Get_Attribute DF_FIELD_TYPE            of iFile iCount to iType
                                    Get FieldType iType                                    to sType
                                    If (iItem > iItmCnt) Send Add_Item Msg_None sType
                                    Else If (Value(Current_Object, iItem) <> sType) ;
                                        Set Value Item iItem                                to sType
                                    Set Entry_State Item iItem                             to False
                                    Set ItemColor   Item iItem                             to clBtnFace
                                    Increment iItem

                                    // Length:
                                    Get_Attribute DF_FIELD_LENGTH          of iFile iCount to iLength
                                    Get_Attribute DF_FIELD_PRECISION       of iFile iCount to iPrec
                                    If (iType = DF_BCD) Move (iLength - iPrec)             to iLength
                                    Else                Move 0                             to iPrec
                                    Move (String(iLength) + "," + String(iPrec))           to sLength
                                    If (iItem > iItmCnt) Send Add_Item msg_None sLength
                                    Else If (Value(Current_Object, iItem) <> sLength) ;
                                        Set Value Item iItem to sLength
                                    Set Entry_State Item iItem                             to False
                                    Set ItemColor   Item iItem                             to clBtnFace
                                    Increment iItem

                                    // Nullable:
                                    Get_Attribute DF_FIELD_NULL_ALLOWED    of iFile iCount to iNul
                                    If (iItem > iItmCnt) Send Add_Item Msg_None ""
                                    Set Checkbox_Item_State Item iItem                     to True
                                    Set Select_State        Item iItem                     to iNul
                                    Set Entry_State         Item iItem                     to False
                                    Set ItemColor           Item iItem                     to clBtnFace
                                    Increment iItem

                                    // Default Value:
                                    Get_Attribute DF_FIELD_DEFAULT_VALUE   of iFile iCount to sDefaultValue
                                    If (iItem > iItmCnt) Send Add_Item msg_None sDefaultValue
                                    Set Entry_State  Item iItem                            to False
                                    Set ItemColor    Item iItem                            to clBtnFace
                                    Set Shadow_State Item iItem                            to True
                                    Increment iItem

                                    // Null Default Value to be entered:
                                    If (Length(sDefaults)) ;
                                        Get ExtractFieldValue sDefaults iCount               to sValue
                                    Else Move ""                                           to sValue
                                    Send Add_Item msg_None sValue
                                    Increment iItem
                                    If (Err) Break // Has been set to False before the loop.
                                Loop 

                                Send Trap_Error of Error_Info_Object 77
                                Set Dynamic_Update_State to True
                                Set Select_Mode to No_Select
                            End_Procedure  

                            Function ExtractFieldValue String sDefaults Integer iField Returns String
                                Integer iStart iEnd iCount
                                For iCount From 1 to (iField - 1)
                                    Move (Replace("|", sDefaults, "")) to sDefaults
                                Loop 
                                Move (Pos("|", sDefaults))                     to iStart
                                Move (Replace("|", sDefaults, ""))             to sDefaults
                                Move (Pos("|", sDefaults))                     to iEnd
                                Function_Return (Mid(sDefaults, (iEnd - iStart), iStart))
                            End_Function 

                            Procedure DoApplyNewValues String sAscii String sText String sNumeric String sDate String sBinary
                                Integer iItems iCount iCols
                                String sType
                                If (sAscii contains "|" or sText contains "|" or sNumeric contains "|" or sDate contains "|" or sBinary contains "|") Begin
                                    Send Info_Box ("Sorry, the vertical bar character (|) cannot be used for a default value. It is used as a divider when the defaults are saved to the SncTable record.")
                                    Procedure_Return
                                End
                                Get Item_Count to iItems
                                Get Line_Size  to iCols
                                Decrement iCols
                                Set Dynamic_Update_State to False
                                For iCount From 0 to (iItems - 1)
                                    Get Value Item (iCount + 1) to sType
                                    If      (sType = "ASCII")   Set Value Item (iCount + 5) to sAscii
                                    Else If (sType = "Numeric") Set Value Item (iCount + 5) to sNumeric
                                    Else If (sType = "Date")    Set Value Item (iCount + 5) to sDate
                                    Else If (sType = "Text")    Set Value Item (iCount + 5) to sText
                                    Else If (sType = "Binary")  Set Value Item (iCount + 5) to sBinary
                                    Move (iCount + iCols) to iCount
                                Loop
                                Set Dynamic_Update_State to True
                            End_Procedure 

                            Procedure DoRemoveValues
                                Integer iItems iCount iCols
                                Get Item_Count to iItems
                                Get Line_Size  to iCols
                                Decrement iCols
                                Set Dynamic_Update_State to False
                                For iCount From 0 to (iItems - 1)
                                    Set Value Item (iCount + 5) to ''
                                    Move (iCount + iCols) to iCount
                                Loop
                                Set Dynamic_Update_State to True
                            End_Procedure 

                            Procedure DoUpdateDDBuffer
                                Handle hoDD
                                Integer iItems iCount iCols
                                String sValue sDefaults sCrntDefaults sCheck
                                Delegate Get Main_DD    to hoDD
                                Get Item_Count          to iItems
                                Get Line_Size           to iCols
                                Move "|"                to sDefaults

                                For iCount From 0 to (iItems - 1)
                                    Get Value Item (iCount + 5) to sValue
                                    If (sValue contains "|") Begin
                                        Send Info_Box ("Sorry, the vertical bar character (|) cannot be used for a default value. It is used as a divider when the defaults are saved to the SncTable record.")
                                        Procedure_Return
                                    End 
                                    Move (sDefaults + String(sValue) + "|") to sDefaults
                                    Move (iCount + iCols -1) to iCount
                                Loop
                                Move (Trim(sDefaults))                    to sDefaults
                                Move (Repeat("|", (iItems / iCols + 1)))  to sCheck
                                If (sCheck = sDefaults) Move " "          to sDefaults // Must be a space to be able to save the change to the DDO
                                Get Field_Current_Value   of hoDD Field SncTable.ToDefaults to sCrntDefaults
                                If (Trim(sCrntDefaults) <> sDefaults) Begin
                                    Set Field_Changed_Value of hoDD Field SncTable.ToDefaults   to sDefaults
                                    Set Field_Changed_Value of hoDD Field SncTable.ZeroLengthOk to (sDefaults <> "")
                                End
                            End_Procedure 

                            Procedure OnChange
                                Send DoUpdateDDBuffer
                            End_Procedure 

                            Function Next_Object_Id Integer bNoDescend Returns Integer
                                Handle ho
                                Move (oASCII_fm(oDefaults_grp(Self))) to ho
                                Function_Return ho
                            End_Function 

                            On_Key Key_Ctrl+Key_S   Send DoSave
                            On_Key Key_F2           Send DoSave
                        End_Object    

                        Object oDefaults_grp is a cRDSGroup
                            Set Size to 248 103
                            Set Location to 39 433
                            Set peAnchors to anTopBottomRight
                            Set Label to "Default Values"
                            
                            Object oASCII_fm is a cRDSForm
                                Set Label to "ASCII Fields"
                                Set Size to 13 97
                                Set Location to 23 3
                                Set Status_Help to "Default value to apply for all fields/columns of type ASCII. Surround the value with single quotes."
                                Set peAnchors to anLeftRight
                                Set Label_Col_Offset to 0
                                Set Label_Justification_Mode to jMode_Top
                                Set Value Item 0 to "' '"
                            End_Object    

                            Object oText_fm is a cRDSForm
                                Set Label to "Text Fields"
                                Set Size to 13 97
                                Set Location to 50 3
                                Set Status_Help to "Default value to apply for all fields/columns of type Text or Note"
                                Set peAnchors to anLeftRight
                                Set Label_Col_Offset to 0
                                Set Label_Justification_Mode to jMode_Top
                                Set Value Item 0 to "' '"
                            End_Object    

                            Object oNumeric_fm is a cRDSForm
                                Set Label to "Numeric Fields"
                                Set Size to 13 97
                                Set Location to 79 3
                                Set Status_Help to "Default value to apply for all fields/columns of type Number"
                                Set Label_Col_Offset to 0
                                Set Label_Justification_Mode to jMode_Top
                                Set Value Item 0 to "0"
                            End_Object    

                            Object oDate_fm is a cRDSForm
                                Set Label to "Date Fields"
                                Set Size to 13 97
                                Set Location to 106 3
                                Set Status_Help to "Default value to apply for all fields/columns of type Date"
                                Set Label_Col_Offset to 0
                                Set Label_Justification_Mode to jMode_Top
                                Set Value Item 0 to "1900-01-01"

                                Procedure Default_Value Integer iDbType
                                    Integer iDateFormat
                                    String  sDefaultDate
                                    If (iDbType = 2) Set Value Item 0 to "0001-01-01" // IBM DB2
                                    If (iDbType = 3) Set Value Item 0 to "1753-01-01" // MS SQL
                                    If (iDbType = 4) Set Value Item 0 to "1900-01-01" // ODBC
                                    If (iDbType = 5) Set Value Item 0 to "1900-01-01" // Oracle
                                    If (iDbType = 1 or iDbType = 6) Begin             // Pervasive.SQL
                                        Get_Attribute DF_DATE_FORMAT to iDateFormat
                                        If (iDateFormat = DF_DATE_USA)      Move "01-01-1900" to sDefaultDate
                                        If (iDateFormat = DF_DATE_EUROPEAN) Move "01-01-1900" to sDefaultDate
                                        If (iDateFormat = DF_DATE_MILITARY) Move "1900-01-01" to sDefaultDate
                                        Set Value Item 0                                      to sDefaultDate
                                    End 
                                End_Procedure 
                            End_Object    

                            Object oBinary_fm is a cRDSForm
                                Set Label to "Binary Fields"
                                Set Size to 13 97
                                Set Location to 135 3
                                Set Status_Help to "Default value to apply for all fields/columns of type Binary"
                                Set Label_Col_Offset to 0
                                Set Label_Justification_Mode to jMode_Top
                                Set Value Item 0 to "0"
                            End_Object    

                            Object oApplyAllRows_bn is a cBitmapButton
                                Set Label to "&Apply for All Rows"
                                Set Size to 13 97
                                Set Location to 213 3
                                Set Status_Help to "Apply for All rows in the grid to the left"
                                Set peAnchors to anBottom
                                Set Bitmap to "Ok16.bmp"
                                Set piTransparentColor to clFuchsia

                                Procedure OnClick
                                    String sAscii sText sNumeric sDate sBinary
                                    Get Value of oAscii_fm   to sAscii
                                    Get Value of oText_fm    to sText
                                    Get Value of oNumeric_fm to sNumeric
                                    Get Value of oDate_fm    to sDate
                                    Get Value of oBinary_fm  to sBinary
                                    Send DoApplyNewValues of oValues_grd sAscii sText sNumeric sDate sBinary
                                End_Procedure 
                            End_Object    

                            Object oRemoveAllRows_bn is a cBitmapButton
                                Set Label to "&Remove all Defaults"
                                Set Size to 13 97
                                Set Location to 230 3
                                Set Status_Help to "Remove all 'Use Default Value(s)' from the grid to the left"
                                Set peAnchors to anBottom
                                Set Bitmap to "Delete16.bmp"
                                Set piTransparentColor to clFuchsia

                                Procedure OnClick
                                    Send DoRemoveValues of oValues_grd
                                End_Procedure 
                            End_Object    

                        End_Object    

                        Object oSnctable_TodataTable_Null is a cRDSDbForm
                            Entry_Item Snctable.Todatatable
                            Set Label to "Target Table Name"
                            Set Size to 13 150
                            Set Location to 10 78
                            Set Label_Col_Offset to 2
                            Set Label_Justification_Mode to jMode_Right
                            Set Enabled_State to False

                            Procedure DoUpdateData Integer iFromFile Integer iToFile Boolean bFrom
                                Set Enabled_State of (Label_Object(Self)) to (iFromFile and iToFile)
                                Send Enable_Window of (Label_Object(Self)) (iFromFile and iToFile)
                            End_Procedure 

                            Procedure Set Enabled_State Boolean bState
                                Forward Set Enabled_State to False
                            End_Procedure 
                        End_Object    

                        Object oViewFromDataNullDefaults_bn is a cViewDataButton
                            Set Label to "&View Data"
                            Set Size to 13 60
                            Set Location to 10 231
                            Set Status_Help to "View data for the Source database table."
                            Set Bitmap to "ViewData16.bmp"
                            Set piTransparentColor to clFuchsia
                            Set pbFrom to True

                            Procedure OnClick
                                Send DoViewData True -1
                            End_Procedure 
                        End_Object    

                        Procedure DoUpdateData Integer iFromFile Integer iToFile Boolean bFrom
                            Handle ho
                            String sTable
                            Integer iOpen iDbType
                            Get Field_Current_Value of (Main_DD(Self)) Field SncTable.ToDatatable to sTable
                            If iToFile Get_Attribute DF_FILE_OPENED of iToFile to iOpen
                            Get Field_Current_Value of (Main_DD(Self)) Field SncTable.ToDbType    to iDbType
                            Set Enabled_State  to (Length(sTable) > 0 and iOpen)
                            Set Enabled_State  of oDefaults_grp     to (Length(sTable) > 0 and iOpen)
                            Move (oValues_grd(Self)) to ho
                            If (Enabled_State(Self)) Set Color of ho to clWindow
                            Else                     Set Color of ho to clLtGray
                            If ho Send DoFillGrid of ho
                        End_Procedure 

                        On_Key Key_Alt+Key_V Send KeyAction of oViewFromDataNullDefaults_bn
                    End_Object    

                    On_Key Key_Alt+Key_A  Send KeyAction to oApplyAllRows_bn
                    On_Key Key_Alt+Key_R  Send KeyAction to oRemoveAllRows_bn
                End_Object    

                Object oDbTabPage6 is a cRDSDbTabPage
                    Set Label to "Value Conversion"
                    Set Tab_ToolTip_Value to "Change a Source field value into something else for the Target table"
                    Set piImageIndex to 9
                    
                    Object oSncTRow_grp is a cRDSDbGroup
                        Set Size to 295 540
                        Set Location to 1 3
                        Set peAnchors to anAll
                        Set Label to "Field Value Conversions"
                    
                        Object oSnctable_FromdataTable_Conv is a cRDSDbForm
                            Entry_Item Snctable.Fromdatatable
                            Set Label to "Source Table Name"
                            Set Size to 13 150
                            Set Location to 10 78
                            Set Label_Col_Offset to 2
                            Set Label_Justification_Mode to jMode_Right

                            Set Enabled_State to False
                            Procedure DoUpdateData Integer iFromFile Integer iToFile Boolean bFrom
                                Set Enabled_State of (Label_Object(Self)) to (iFromFile and iToFile)
                                Send Enable_Window of (Label_Object(Self)) (iFromFile and iToFile)
                                Set Enabled_State of (oViewFromData_bn(Self)) to iFromFile
                            End_Procedure 

                            Procedure Set Enabled_State Boolean bState
                                Forward Set Enabled_State to False
                            End_Procedure 
                        End_Object    

                        Object oFromField_cf is a cDbFieldComboform
                            Entry_Item Sncthea.Fromfield
                            Set Server to Sncthea_DD
                            Set Label to "Source Field"
                            Set Size to 13 150
                            Set Location to 25 78
                            Set Form_Border to 0
                            Set Label_Row_Offset to 0
                            Set Label_Col_Offset to 2
                            Set Label_Justification_Mode to jMode_Right
                            Set Entry_State to False
                            Set Combo_Sort_State to False
                            Set Code_Display_Mode to cb_Code_Display_Description
                            Set pbFrom to True
                        End_Object  

                        Object oSnctable_TodataTable_Conv is a cRDSDbForm
                            Entry_Item Snctable.Todatatable
                            Set Label to "Target Table Name"
                            Set Size to 13 150
                            Set Location to 40 78
                            Set Label_Col_Offset to 2
                            Set Label_Justification_Mode to jMode_Right

                            Set Enabled_State to False
                            Procedure DoUpdateData Integer iFromFile Integer iToFile Boolean bFrom
                                Set Enabled_State of (Label_Object(Self)) to (iFromFile and iToFile)
                                Send Enable_Window of (Label_Object(Self)) (iFromFile and iToFile)
                            End_Procedure 

                            Procedure Set Enabled_State Boolean bState
                                Forward Set Enabled_State to False
                            End_Procedure 
                        End_Object 

                        Object oToField_cf is a cDbFieldComboform
                            Entry_Item Sncthea.Tofield
                            Set Server to Sncthea_DD
                            Set Label to "Target Field"
                            Set Size to 13 150
                            Set Location to 55 78
                            Set Form_Border to 0
                            Set Label_Row_Offset to 0
                            Set Label_Col_Offset to 2
                            Set Label_Justification_Mode to jMode_Right
                            Set Entry_State to False
                            Set Combo_Sort_State to False
                            Set Code_Display_Mode to cb_Code_Display_Description
                            Set pbFrom to False
                        End_Object 

                        Object oSncTRow_Grid is a cRDSDbGrid
                            Set Main_File to Snctrow.File_Number
                            Set Server to Snctrow_DD
                            Set Ordering to 1
                            Set Size to 190 280
                            Set Location to 70 78
                            Set peAnchors to anAll
                            Set Autosize_height_state to True
                            Set peResizeColumn to rcAll
                            Set Wrap_State to True
                            Set Prompt_Button_Mode to pb_PromptOff
                            Set Prompt_Button_Value to ""

                            Begin_Row
                                Entry_Item Snctrow.Fromvalue
                                Entry_Item Snctrow.Tovalue
                                Entry_Item Snctrow.Ignorecase
                            End_Row

                            Set Form_Width   Item 0 to 113
                            Set Header_Label Item 0 to "If Source Field Value Equals:"

                            Set Form_Width   Item 1 to 113
                            Set Header_Label Item 1 to "Update Target Field with:"

                            Set Form_Width   Item 2 to 47
                            Set Header_Label Item 2 to "Ignore Case"
                            Set Column_Checkbox_State Item 2 to True

                            Set Child_Table_State to True
                            Set psToolTipTitle    to "Conversion Table"
                            Set psToolTip         to "Enter the value in the first column that if found should be changed into the value in the second column. If you check the 'Ignore Case' characters for the Source and Target will be compared in uppercase."

                            // First check that both a From and to field has been selected
                            // with the combos. Else display info to user and refuse entering.
                            // If this is a new validation table autosave the header (SncTHea) before
                            // entering the grid (SncTRow).
                            // This way we hide the fact from the user that this a header/details
                            // construct that is related to the views main_dd (SncTable).
                            Function Child_Entering Returns Integer
                                Handle hoDD hoDD2
                                Integer iFrom iTo iSncTableRecid iRetval iSncTHeaRecnum iSncTRowRecnum
                                Boolean bState

                                Move (SncTHea_DD(Self))  to hoDD
                                Move (SncTable_DD(Self)) to hoDD2

                                // This is so odd. The Get Field_Current_Value for SncTHea.FromField
                                // will generate a status 54 even though it works. The ToField works just fine.
                                // I don't have a clue what's going on. So cheat and simply ignore it:
                                Send Ignore_Error of Error_Info_Object 54 // "Invalid symbol in expression"
                                Get Field_Current_Value of hoDD Field SncTHea.FromField      to iFrom
                                Get Field_Current_Value of hoDD Field SncTHea.ToField        to iTo
                                Get Field_Current_Value of hoDD Field SncTHea.SncTable_Recid to iSncTableRecid
                                Send Trap_Error of Error_Info_Object 54

                                Move (False)          to bState
                                Move SncTHea.Recnum   to iSncTHeaRecnum
                                Clear SncTHea
                                Move iSncTableRecid   to SncTHea.SncTable_Recid
                                Move iFrom            to SncTHea.FromField
                                Move iTo              to SncTHea.ToField
                                Find Eq SncTHea by Index.1
                                If (Found) Begin
                                    Move SncTRow.Recnum to iSncTRowRecnum
                                    Clear SncTRow
                                    Move SncTHea.Recid  to SncTRow.TransHea_Recid
                                    Find Gt SncTRow by Index.2  // Index.2 = TransHea_Recid + Recid
                                    If (Found) Move (SncTRow.Transhea_Recid = SncTHea.Recid) to bState
                                End  
                                If (bState = False) Begin
                                    Clear SncTHea
                                    Move iSncTHeaRecnum   to SncTHea.Recnum
                                    Find Eq SncTHea by Recnum               // Reset record buffer.
                                    Clear SncTRow
                                    Move iSncTRowRecnum   to SncTRow.Recnum
                                    Find Eq SncTRow by Recnum               // Reset record buffer.
                                End  

                                If (bState = True) Begin
                                    Send Request_Assign of hoDD             // Auto-find the existing transformation table.
                                End  
                                If (iFrom < 1 or iTo < 1) Begin
                                    Send Info_Box "You need to select both a Source and a Destination field from the comboforms above. Please adjust and try again."
                                    Function_Return True // Do not enter.
                                End 
                                If not (pbGetHasCurrRowId(hoDD2)) Begin
                                    Indicate Err False
                                    Get YesNo_Box "You are creating a new 'Database Tables Setup record'. It needs to be saved before a Transformation table can be entered. Save record now?" to iRetval
                                    If (iRetval = MBR_NO) Function_Return True
                                    Send Request_Save of hoDD2
                                    If (Err) Function_Return True // Do not enter.
                                End  
                                If not (pbGetHasCurrRowId(hoDD)) Begin
                                    Indicate Err False
                                    Send Request_Save of hoDD
                                    If (Err) Function_Return True // Do not enter.
                                End  
                                Function_Return False
                            End_Function  

                            Procedure Refresh Integer iMode
                                Integer iRecnum
                                Forward Send Refresh iMode
                                Get pbGetHasCurrRowId of SncTHea_DD to iRecnum
                                Set Enabled_State of oDeleteValueTable_bn to iRecnum
                            End_Procedure 

                            On_Key Key_F8            Send OnClick of (oNext_bn(oFindToolbar(oFindButton_c3d(Self))))
                            On_Key Key_F7            Send OnClick of (oPrev_bn(oFindToolbar(oFindButton_c3d(Self))))
                            On_Key Key_Ctrl+Key_Home Send OnClick of (oFirst_bn(oFindToolbar(oFindButton_c3d(Self))))
                            On_Key Key_Ctrl+Key_End  Send OnClick of (oLast_bn(oFindToolbar(oFindButton_c3d(Self))))
                        End_Object  

                        Object oSnctable_Sncthea_Count is a cRDSDbForm
                            Entry_Item Snctable.Sncthea_count
                            Set Label to "Number of created Conversion Tables"
                            Set Size to 13 24
                            Set Location to 262 334
                            Set peAnchors to anBottomRight
                            Set Label_Col_Offset to 2
                            Set Label_Justification_Mode to jMode_Right

                            Procedure Set Enabled_State Boolean bState
                                Forward Set Enabled_State to False
                            End_Procedure  
                        End_Object  

                        Object oNewValueTable_bn is a cBitmapButton
                            Set Label to "Create &New Table"
                            Set Size to 13 87
                            Set Location to 276 78
                            Set Status_Help to "Create a new Transformation Table for a different set of Source and Target fields."
                            Set peAnchors to anBottomLeft
                            Set Bitmap to "New16.bmp"
                            Set piTransparentColor to clFuchsia

                            Procedure OnClick
                                Send DoCreateNewRecord of SncTHea_DD
                                Send Activate          of oFromField_cf
                            End_Procedure  

                            Procedure DoUpdateData Integer iFromFile Integer iToFile Boolean bFrom
                                Forward Send DoUpdateData iFromFile iToFile bFrom
                                Set Enabled_State to (iFromFile and iToFile)
                            End_Procedure  
                        End_Object  

                        Object oViewToData_bn is a cViewDataButton
                            Set Label to "View &Data"
                            Set Size to 13 60
                            Set Location to 40 230
                            Set Status_Help to "View data for the Target database table."
                            Set Bitmap to "ViewData16.bmp"
                            Set Enabled_State to False
                            Set piTransparentColor to clFuchsia
                            Set pbFrom to False

                            Procedure OnClick
                                Send DoViewData True -1
                            End_Procedure 
                        End_Object 

                        Object oViewFromData_bn is a cViewDataButton
                            Set Label to "&View Data"
                            Set Size to 13 60
                            Set Location to 10 230
                            Set Status_Help to "View data for the Source database table."
                            Set Bitmap to "ViewData16.bmp"
                            Set Enabled_State to False
                            Set piTransparentColor to clFuchsia
                            Set pbFrom to True

                            Procedure OnClick
                                Send DoViewData True -1
                            End_Procedure  
                        End_Object  

                        Object oFindButton_c3d is a cRDSContainer3d
                            Set Size to 15 62
                            Set Location to 276 166
                            Set peAnchors to anBottomLeft

                            Object oFindToolbar is a cToolbar
                                Set pbInMDIPanel  to False
                                Set pbWrapable    to False
                                Set pbNoDivider   to True
                                Set piIndent      to 0

                                Object oImages is an cImageList
                                    Set piMaxImages to 4
                                    Procedure OnCreate
                                        Integer iVoid
                                        Get AddTransparentImage "Bgn.bmp"   clFuchsia to iVoid
                                        Get AddTransparentImage "Prev.bmp"  clFuchsia to iVoid
                                        Get AddTransparentImage "Next.bmp"  clFuchsia to iVoid
                                        Get AddTransparentImage "End.bmp"   clFuchsia to iVoid
                                    End_Procedure  
                                End_Object 

                                Object oImagesHot is a cRDScImageList
                                    // These images are shown when the mouse cursor hovers over the button
                                    // There must be a matching number of images in all imagelists.
                                    Set piMaxImages to 4
                                    Procedure OnCreate
                                        Integer iVoid
                                        Get AddTransparentImage "BgnHot.bmp"  clLtGray  to iVoid
                                        Get AddTransparentImage "PrevHot.bmp" clLtGray  to iVoid
                                        Get AddTransparentImage "NextHot.bmp" clLtGray  to iVoid
                                        Get AddTransparentImage "EndHot.bmp"  clLtGray  to iVoid
                                    End_Procedure
                                End_Object

                                Set phoImageList to (oImages(Self))

                                Object oFirst_bn is a cToolbarButton
                                    Set pbAutoSize to True
                                    Set psTooltip to "Find the first transformation table (Ctrl+Home)"
                                    Set piImage to 0
                                    Procedure OnClick
                                        Send DoFindRecord of SncTHea_DD -1
                                    End_Procedure
                                End_Object

                                Object oPrev_bn is a cToolbarButton
                                    Set pbAutoSize to True
                                    Set psToolTip to "Find previous conversion table (F7)"
                                    Set piImage   to 1
                                    Procedure OnClick
                                        Send DoFindRecord of SncTHea_DD Lt
                                    End_Procedure 
                                End_Object  

                                Object oNext_bn is a cToolbarButton
                                    Set pbAutoSize to True
                                    Set psTooltip to "Find next conversion table (F8)"
                                    Set piImage   to 2
                                    Procedure OnClick
                                        Send DoFindRecord of SncTHea_DD Gt
                                    End_Procedure 
                                End_Object 

                                Object oLast_bn is a cToolbarButton
                                    Set pbAutoSize to True
                                    Set psTooltip to "Find the last conversion table (Ctrl+End)"
                                    Set piImage to 3
                                    Procedure OnClick
                                        Send DoFindRecord of SncTHea_DD -2
                                    End_Procedure
                                End_Object

                                Procedure Add_Focus Integer hoBase Returns Integer
                                    Integer iRetVal
                                    Integer iSize
                                    Get GuiSize of (Parent(Self))    to iSize
                                    Set GuiSize                      to (Hi(iSize)) (Low(iSize))
                                    Set piButtonWidthMin             to (Low(iSize) -5)
                                    Forward Get Msg_Add_Focus hoBase to iRetVal
                                End_Procedure
                            End_Object  

                            Set Border_Style to Border_None
                            Get GuiSize      to Windowindex
                            Set GuiSize      to (Hi(Windowindex) + 4) (Low(Windowindex) +5)

                            Procedure DoUpdateData Integer iFromFile Integer iToFile Boolean bFrom
                                Forward Send DoUpdateData iFromFile iToFile bFrom
                                Set Enabled_State of (oFindToolbar(Self)) to (iFromFile and iToFile)
                            End_Procedure 
                        End_Object  

                        Object oDeleteValueTable_bn is a cBitmapButton
                            Set Label to "D&elete Table"
                            Set Size to 13 69
                            Set Location to 276 230
                            Set Status_Help to "Delete current Transformation Table"
                            Set peAnchors to anBottomLeft
                            Set Bitmap to "Delete16.bmp"
                            Set piTransparentColor to clFuchsia

                            Procedure OnClick
                                Integer iRecord hoDD iRetval
                                Move (SncTHea_DD(Self)) to hoDD
                                Get pbGetHasCurrRowId of hoDD to iRecord
                                If not iRecord Begin
                                    Send Info_Box "No Value Transformation table to delete."
                                    Procedure_Return
                                End  
                                Get YesNo_Box "Are you sure you want to delete the current Value Transformation table?" to iRetval
                                If (iRetval = MBR_NO) Procedure_Return
                                Send Request_Delete    of SncTHea_DD  // Will delete header and all rows
                                Send DoCreateNewRecord of SncTHea_DD  // Init DDO's for creating a new record.
                                Send Activate of oFromField_cf        // Do not stay in the grid.
                            End_Procedure  
                        End_Object   

                        Object oInfoValue_tb is a cRDSTextbox
                            Set Label to "An example of a conversion field value could be a source field that contains 'Y' or 'N' but the target field value needs to be a 0 or 1. One table can be used for each pair of selected fields."
                            Set Auto_Size_State to False
                            Set Location to 70 364
                            Set Size to 44 169
                            Set Border_Style to Border_StaticEdge
                            Set Justification_Mode to jMode_Left
                            Set peAnchors to anTopRight
                        End_Object   

                        Procedure DoUpdateData Integer iFromFile Integer iToFile Boolean bFrom
                            Handle ho
                            Move (oSncTRow_Grid(Self)) to ho
                            Set Enabled_State to (iFromFile and iToFile)
                            If (Enabled_State(Self)) Set Color of ho to clWindow
                            Else                     Set Color of ho to clLtGray
                        End_Procedure  

                        Procedure DoEnableDisable Integer iValue
                            Handle ho
                            Set Enabled_State                                                       to iValue
                            Set Enabled_State of oInfoValue_tb                                      to iValue
                            Set Enabled_State of (Label_Object(oSnctable_FromdataTable_Conv(Self))) to iValue
                            Set Enabled_State of (Label_Object(oSnctable_Sncthea_Count(Self)))      to iValue
                            Set Enabled_State of oNewValueTable_bn                                  to iValue
                            Set Enabled_State of oDeleteValueTable_bn                               to iValue
                            Move (oSncTRow_Grid(Self)) to ho
                            If (Enabled_State(Self)) Set Color of ho  to clWindow
                            Else                     Set Color of ho  to clLtGray
                        End_Procedure 

                        On_Key Key_Alt+Key_V Send KeyAction of oViewFromData_bn
                        On_Key Key_Alt+Key_D Send KeyAction of oViewToData_bn
                        On_Key Key_Alt+Key_N     Send KeyAction of oNewValueTable_bn
                        On_Key Key_Alt+Key_E     Send KeyAction of oDeleteValueTable_bn
                        On_Key Key_F8            Send OnClick   of (oNext_bn(oFindToolbar(oFindButton_c3d(Self))))
                        On_Key Key_F7            Send OnClick   of (oPrev_bn(oFindToolbar(oFindButton_c3d(Self))))
                        On_Key Key_Ctrl+Key_Home Send OnClick   of (oFirst_bn(oFindToolbar(oFindButton_c3d(Self))))
                        On_Key Key_Ctrl+Key_End  Send OnClick   of (oLast_bn(oFindToolbar(oFindButton_c3d(Self))))
                    End_Object 

                End_Object 

                Object oDbTabPage8 is a cRDSDbTabPage
                    Set Label to "Mark Source Rows"
                    Set Tab_ToolTip_Value to "Set field values for the source table records when a new Target record is created"
                    Set piImageIndex to 10
                    
                    Object oFlagField_grp is a cRDSDbGroup
                        Property String psFuncDateTxt     "Today's Date"
                        Property String psFuncDate        "##1##"
                        Property String psFuncTimeTxt     "Current Time"
                        Property String psFuncTime        "##2##"
                        Property String psFuncDateTimeTxt "Today's Date and Current Time"
                        Property String psFuncDateTime    "##3##"

                        Set Size to 295 540
                        Set Location to 1 3
                        Set peAnchors to anAll
                        Set Label to "Mark fields for the Source Table. When a source record is connected with a target record the selected source field value will be set."
                        
                        Object oFieldsMark_cf is a cDbFieldComboform
                            Set Label to "Field/Column Number"
                            Set Size to 13 150
                            Set Location to 25 78
                            Set Status_Help to "Available Fields/columns for the selected Source data table"
                            Set Form_Border to 0
                            Set Label_Row_Offset to 0
                            Set Label_Col_Offset to 2
                            Set Label_Justification_Mode to jMode_Right
                            Set Entry_State to False
                            Set Combo_Sort_State to False
                            Set Code_Display_Mode to cb_Code_Display_Description
                            Set pbFrom to True

                            Procedure OnChange
                                Handle hoList
                                String sType sField
                                Integer iLength iPrec iField iFile iType iOpen
                                Move -1 to iType
                                Get Value Item 0    to sField
                                Get FileFieldNumber to iField     // Class function.
                                Move (Trim(sField)) to sField
                                If (sField contains "<None>" or sField = "") Begin
                                    Set Value   of oValueFunction_cf                to ""
                                    Set Value   of oTypeMark_fm                     to ""
                                    Set Value   of oLengthMark_fm                   to ""
                                    Set Enabled_State of oSelectMark_bn             to False
                                    Procedure_Return
                                End 

                                Get Field_Current_Value of (Main_DD(Self)) Field SncTable.FromFile to iFile
                                Get_Attribute DF_FILE_OPENED     of iFile         to iOpen
                                If not iOpen Procedure_Return
                                Get_Attribute DF_FIELD_TYPE      of iFile iField  to iType
                                Get_Attribute DF_FIELD_LENGTH    of iFile iField  to iLength
                                Get_Attribute DF_FIELD_PRECISION of iFile iField  to iPrec
                                If (iType = DF_BCD) Move (iLength - iPrec)        to iLength
                                Else Move 0                                       to iPrec
                                Get_Attribute DF_FIELD_NAME      of iFile iField  to sField
                                Get UpperFirstChar sField                         to sField
                                Get FieldType iType                               to sType
                                Set Value   of oTypeMark_fm                       to sType
                                Set Value   of oLengthMark_fm                     to (String(iLength) + "," + String(iPrec))
                                Move (oFlags_lst(Self))                           to hoList
                                Set psField of hoList                             to sField
                                Set piType  of hoList                             to iType
                                Set piLength of hoList                            to iLength
                                Set Enabled_State of oSelectMark_bn               to True
                            End_Procedure  

                            // This is a dbComboform but not attached to a db field.
                            // We kill these two procedures so the DDO doesn't get triggered:
                            Procedure Set Changed_Value Integer iField String sValue
                            End_Procedure
                            Procedure Set Changed_State Boolean bState
                            End_Procedure
                        End_Object  

                        Object oValueFunction_cf is a cRDSForm
                            Set Label to "Value"
                            Set Size to 13 119
                            Set Location to 25 330
                            Set Status_Help to "Enter a value to set the selected field/column to."
                            Set Label_Col_Offset to 2
                            Set Label_Justification_Mode to jMode_Right

                            Procedure OnChange
                                Integer iItem
                                String sValue
                                Get Value Item 0    to sValue
                                Move (Trim(sValue)) to sValue
                                If      (sValue = (psFuncDateTxt(Self)))     Move (psFuncDate(Self))     to sValue // dbGroup properties.
                                Else If (sValue = (psFuncTimeTxt(Self)))     Move (psFuncTime(Self))     to sValue
                                Else If (sValue = (psFuncDateTimeTxt(Self))) Move (psFuncDateTime(Self)) to sValue
                                Set psValue of oFlags_lst to sValue
                            End_Procedure  

                            Procedure Combo_Fill_List
                                //  Send Combo_Add_Item (psFuncDateTxt(Self))
                                //  Send Combo_Add_Item (psFuncTimeTxt(Self))
                                //  Send Combo_Add_Item (psFuncDateTimeTxt(Self))
                            End_Procedure 

                            Procedure DoFillList
                                Set Value to ""
                                //  Send Combo_Delete_Data
                                //  Send Combo_Fill_List
                            End_Procedure 
                        End_Object  

                        Object oTypeMark_fm is a cRDSForm
                            Set Label to "Field/Column Type"
                            Set Size to 13 56
                            Set Location to 40 330
                            Set Status_Help to "The selected field/column type"
                            Set Label_Col_Offset to 1
                            Set Label_Justification_Mode to jMode_Right

                            Set Enabled_State to False
                            Procedure DoUpdateData Integer iFromFile Integer iToFile Boolean bFrom
                                Send Enable_Window of (Label_Object(Self)) (iFromFile and iToFile)
                            End_Procedure  

                            Procedure Set Enabled_State Boolean bState
                                Forward Set Enabled_State to False
                            End_Procedure  
                        End_Object  

                        Object oLengthMark_fm is a cRDSForm
                            Set Label to "Length"
                            Set Size to 13 33
                            Set Location to 40 416
                            Set Status_Help to "The selected field/column length and precision"
                            Set Label_Col_Offset to 1
                            Set Label_Justification_Mode to jMode_Right

                            Set Enabled_State to False
                            Procedure DoUpdateData Integer iFromFile Integer iToFile Boolean bFrom
                                Send Enable_Window of (Label_Object(Self)) (iFromFile and iToFile)
                            End_Procedure 

                            Procedure Set Enabled_State Boolean bState
                                Forward Set Enabled_State to False
                            End_Procedure  
                        End_Object   

                        Object oFlags_lst is a cRDSList
                            Property Integer piType  -1
                            Property String  psField ""
                            Property String  psValue ""
                            Property Integer piLength 0

                            Set Label to "Selected Fields and Values"
                            Set Size to 190 371
                            Set Location to 58 78
                            Set Status_Help to "List with Source data table fields that should be updated with specified values during a connection with a Target data table. Press Del or Ctrl+X to remove an item"
                            Set peAnchors to anAll
                            Set Label_Col_Offset to 0
                            Set Label_Justification_Mode to jMode_Top
                            Set Label_Shadow_Display_Mode to TBSHADOW_ON_LOCAL

                            Procedure DoAddToList Boolean bUpdate
                                Integer iType iLength
                                String sTable sField sValue sText sFlags

                                Get piType   to iType
                                Get piLength to iLength
                                Get Field_Current_Value of (Main_DD(Self)) Field SncTable.Fromdatatable         to sTable
                                Get StripExt sTable                                                             to sTable
                                Get psField                                                                     to sField
                                Get psValue                                                                     to sValue
                                Move ("Source Row Field Value" * String(sTable) + "." + String(sField) + " = ") to sText
                                If (sValue = psFuncDate(Self))          Get psFuncDateTxt     to sFlags
                                Else If (sValue = psFuncTime(Self))     Get psFuncTimeTxt     to sFlags
                                Else If (sValue = psFuncDateTime(Self)) Get psFuncDateTimeTxt to sFlags
                                Else Move sValue                                               to sFlags

                                If (iType = DF_ASCII or iType = DF_TEXT) Begin
                                    If (sValue = psFuncDate(Self) and iLength < 10) Begin
                                        Send Info_Box "The length of the field/column needs to be at least 10 characters for this function."
                                        If (iLength < 10) Procedure_Return
                                    End
                                    If (sValue = psFuncTime(Self) and iLength < 8) Begin
                                        Send Info_Box "The length of the field/column needs to be at least 8 characters for this function."
                                        Procedure_Return
                                    End
                                    If (sValue = psFuncDateTime(Self) and iLength < 19) Begin
                                        Send Info_Box "The length of the field/column needs to be at least 19 characters for this function."
                                        Procedure_Return
                                    End
                                    Move (sText * '"' + String(sFlags) + '"') to sText
                                End  
                                Else Begin
                                    If (iType <> DF_DATE and sValue = psFuncDate(Self)) Begin
                                        Send Info_Box "The selected function can only be applied to a field/column of type Ascii, Text or Date."
                                        Procedure_Return
                                    End 
                                    Else If (sValue = psFuncDateTime(Self) or sValue = psFuncDateTime(Self)) Begin
                                        Send Info_Box "The selected function can only be applied to a field/column of type Ascii."
                                        Procedure_Return
                                    End  
                                    If (Trim(sFlags) = "") Move 0 to sFlags
                                    Move (sText * String(sFlags)) to sText
                                End  
                                Send Add_Item msg_None sText
                                If bUpdate Send DoUpdateDDBuffer
                            End_Procedure 

                            Procedure DoDeleteItem
                                Integer iItem
                                Get Item_Count to iItem
                                If not iItem Procedure_Return
                                Get Current_Item to iItem
                                Send Delete_Item iItem
                                Send DoUpdateDDBuffer
                            End_Procedure 

                            Procedure DoFillList
                                Handle hoDD
                                Boolean bTableChanged
                                Integer iCount iFile iField iType iPos iFlags iOpen
                                String sTable sField sFlags sMode sValue sText sSrc
                                Set Dynamic_Update_State to False
                                Send Delete_Data
                                Delegate Get Main_DD to hoDD
                                Get Field_Current_Value of hoDD Field SncTable.SynchFlags    to sFlags
                                Move (Trim(sFlags)) to sFlags
                                If (Length(sFlags) = 0) Begin
                                    Set Dynamic_Update_State to True
                                    Procedure_Return
                                End  
                                Move (sFlags + "|")                                            to sFlags // Format: "Field_Number|Mode|Value"
                                Get Field_Current_Value of hoDD Field SncTable.FromFile        to iFile
                                Get_Attribute DF_FILE_OPENED of iFile                          to iOpen
                                If not iOpen Begin
                                    Set Dynamic_Update_State to True
                                    Procedure_Return
                                End  

                                // This will take care of a special situation.
                                // The user has created a record and has also specified Selfields, he then changes the
                                // datatable comboform to another table...
                                Get Field_Changed_State of hoDD Field SncTable.FromDataTable   to bTableChanged
                                If bTableChanged Begin
                                    // Reset DDO buffer value in case user saves the new config.
                                    Set Field_Changed_Value of hoDD Field SncTable.SynchFlags    to ""
                                    Set Dynamic_Update_State to True
                                    Procedure_Return
                                End 

                                Get Field_Current_Value of hoDD Field SncTable.Fromdatatable   to sTable
                                Get StripExt sTable                                            to sTable
                                Get Field_Current_Value of hoDD Field SncTable.SynchFlagCount  to iFlags

                                For iCount From 1 to iFlags
                                    Get ExtractValue sFlags " "                                  to iField // Extract Field Value. (From SyncFuncs.pkg)
                                    Move (Replace((String(iField) + " "), sFlags, ""))           to sFlags
                                    Get_Attribute DF_FIELD_NAME of iFile iField                  to sField
                                    Get UpperFirstChar sField                                    to sField
                                    Set psField                                                  to sField
                                    Get_Attribute DF_FIELD_TYPE of iFile iField                  to iType
                                    Set piType                                                   to iType
                                    Get ExtractValue sFlags "|"                                  to sValue
                                    Move (Replace((sValue + "|"), sFlags, ""))                   to sFlags
                                    If (sValue = psFuncDate(Self))          Move (psFuncDateTxt(Self))  to sValue
                                    Else If (sValue = psFuncTime(Self))     Move (psFuncTimeTxt(Self))  to sValue
                                    Else If (sValue = psFuncDateTime(Self)) Move (psFuncDateTime(Self)) to sValue
                                    Set psValue                                                         to sValue
                                    Send DoAddToList False
                                Loop  
                                Set Dynamic_Update_State to True
                            End_Procedure 

                            Procedure DoUpdateDDBuffer
                                Handle hoDD
                                Integer iCount iFile iField iPos iItems
                                String sTable sField sFlags sValue sText sSrc sCurrent
                                Delegate Get Main_DD to hoDD
                                Get Field_Current_Value of hoDD Field SncTable.FromFile   to iFile
                                Get Item_Count to iItems
                                For iCount From 0 to (iItems - 1)
                                    Get Value Item iCount                                   to sText
                                    Move (sText + " ")                                      to sText
                                    Move (Pos(".", sText))                                  to iPos
                                    Move (Left(sText, iPos))                                to sTable   // Table:
                                    Move (Replace(sTable, sText, ""))                       to sText
                                    Get ExtractValue sText " "                              to sField   // Function in SysFuncs.pkg
                                    Field_Map iFile sField                                  to iField   // Field:
                                    Move (Replace((sField + " "), sText, ""))               to sText
                                    Move (Pos("=", sText))                                  to iPos
                                    Move (Right(sText, (Length(sText) - iPos)))             to sText
                                    Move sText                                              to sValue
                                    Move (Replace((sValue + " "), sText, ""))               to sText
                                    Move (Replaces('"', sValue, ''))                        to sValue   // Value
                                    Move (Trim(sValue))                                     to sValue
                                    If (sValue = psFuncDateTxt(Self))          Move (psFuncDate(Self))     to sValue
                                    Else If (sValue = psFuncTimeTxt(Self))     Move (psFuncTime(Self))     to sValue
                                    Else If (sValue = psFuncDateTimeTxt(Self)) Move (psFuncDateTime(Self)) to sValue
                                    Move (String(iField) * String(sValue))                  to sText
                                    If (iCount < (iItems -1)) Move (sText + "|")            to sText
                                    Move (sFlags + String(sText))                           to sFlags
                                Loop  
                                Get Field_Current_Value of hoDD Field SncTable.SynchFlags       to sText
                                Move (Trim(sText))                                              to sText
                                Get Field_Current_Value of hoDD Field SncTable.SynchFlagCount   to iCount
                                If (sText <> sFlags) Begin
                                    Set Field_Changed_Value of hoDD Field SncTable.SynchFlags     to sFlags
                                    Set Field_Changed_Value of hoDD Field SncTable.SynchFlagCount to iItems
                                End  
                            End_Procedure  

                            Procedure DoUpdateData Integer iFromFile Integer iToFile Boolean bFrom
                                Send Enable_Window of (Label_Object(Self)) (iFromFile and iToFile)
                            End_Procedure  

                            On_Key kDelete_Character Send DoDeleteItem
                            On_Key Key_Shift+Key_F2  Send DoDeleteItem
                            On_Key Key_Ctrl+Key_X    Send DoDeleteItem
                            On_Key Key_F2            Send Request_Save of (Main_DD(Self))
                            On_Key Key_Ctrl+Key_S    Send Request_Save of (Main_DD(Self))
                        End_Object  

                        Object oSnctable_Synchflagcount is a cRDSDbForm
                            Entry_Item Snctable.Synchflagcount
                            Set Label to "Number of Selected Fields"
                            Set Size to 13 18
                            Set Location to 278 431
                            Set peAnchors to anBottomRight
                            Set Label_Col_Offset to 2
                            Set Label_Justification_Mode to jMode_Right

                            Procedure Set Enabled_State Boolean bState
                                Forward Set Enabled_State to False
                            End_Procedure 
                        End_Object  

                        Object oSelectMark_bn is a cBitmapButton
                            Set Label to "&Select"
                            Set Size to 13 60
                            Set Location to 24 451
                            Set Status_Help to "Add the entered selection to the list below"
                            Set Bitmap to "Ok16.bmp"
                            Set piTransparentColor to clFuchsia

                            Procedure OnClick
                                Handle ho
                                String sValue sField
                                Integer iType iRetval
                                Move (oFlags_lst(Self)) to ho
                                Get piType  of ho to iType
                                Get psValue of ho to sValue
                                Get psField of ho to sField
                                If (sField = "") Begin
                                    Send Info_Box "You need to select a field first."
                                    Procedure_Return
                                End  
                                Get psValue       of ho to sValue
                                If (iType = DF_DATE or iType = DF_BCD) Begin
                                    Get IsNumeric sValue to iRetval
                                    If not iRetval Begin
                                        Send Info_Box "Value should be numeric."
                                        Procedure_Return
                                    End  
                                End  
                                Send DoAddToList of ho True
                            End_Procedure 

                            Procedure DoEnableDisable Integer iValue
                                String sTable sField
                                Integer iFile iOpen
                                Get psField of oConstraints_lst to sField
                                Get Field_Current_Value of (Main_DD(Self)) Field SncTable.FromFile      to iFile
                                Get Field_Current_Value of (Main_DD(Self)) Field SncTable.FromDataTable to sTable
                                Move (Trim(sTable)) to sTable
                                If iFile Get_Attribute DF_FILE_OPENED of iFile to iOpen
                                Set Enabled_State to (Length(sField) > 0 and Length(sTable) > 0 and iOpen)
                            End_Procedure 

                            Procedure DoCheckClear
                                Send DoEnableDisable 0
                            End_Procedure 
                        End_Object  

                        Object oViewFromData_bn is a cViewDataButton
                            Set Label to "&View Data"
                            Set Size to 13 60
                            Set Location to 40 451
                            Set Status_Help to "View data for the Source database table."
                            Set Bitmap to "ViewData16.bmp"
                            Set Enabled_State to False
                            Set piTransparentColor to clFuchsia
                            Set pbFrom to True

                            Procedure OnClick
                                Integer iItem
                                String sRetval
                                Get FileFieldNumber of oFieldsMark_cf to iItem // Class function.
                                Get msg_DoViewData True iItem to sRetval
                                If (Length(sRetval) > 0) Set Value of oValueFunction_cf to sRetval
                            End_Procedure 
                        End_Object 

                        Object oSnctable_FromdataTable_Mark is a cRDSDbForm
                            Entry_Item Snctable.Fromdatatable
                            Set Label to "Source Table Name"
                            Set Size to 13 150
                            Set Location to 10 78
                            Set Label_Col_Offset to 2
                            Set Label_Justification_Mode to jMode_Right
                            Set Enabled_State to False

                            Procedure Set Enabled_State Boolean bState
                                Forward Set Enabled_State to False
                            End_Procedure 
                        End_Object    

                        Procedure DoUpdateData Integer iFromFile Integer iToFile Boolean bFrom
                            Handle ho
                            String sTable
                            Integer iOpen
                            Get Field_Current_Value of (Main_DD(Self)) Field SncTable.Fromdatatable to sTable
                            If iFromFile Get_Attribute DF_FILE_OPENED of iFromFile to iOpen
                            Set Enabled_State  to (Length(sTable) > 0 and iOpen)
                            Move (oFlags_lst(Self))            to ho
                            If (Enabled_State(Self)) Set Color of ho to clWindow
                            Else                     Set Color of ho to clLtGray
                            Send DoFillList of ho
                            Set Enabled_State of (Label_Object(oSnctable_FromdataTable_Mark)) to (Length(sTable) > 0 and iOpen)
                            Set Enabled_State of (Label_Object(oTypeMark_fm))                 to (Length(sTable) > 0 and iOpen)
                            Set Enabled_State of (Label_Object(oLengthMark_fm))               to (Length(sTable) > 0 and iOpen)
                            Set Enabled_State of (Label_Object(oSnctable_Synchflagcount))     to (Length(sTable) > 0 and iOpen)
                        End_Procedure 

                        On_Key Key_Alt+Key_S Send KeyAction of oSelectMark_bn
                        On_Key Key_Alt+Key_V Send KeyAction of oViewFromData_bn
                    End_Object  

                End_Object    

                Object oDbTabPage7 is a cRDSDbTabPage
                    Set Label to "Other"
                    Set Tab_ToolTip_Value to "Miscellaneous settings."
                    Set piImageIndex to 11
                    
                    Object oSnctable_Checkintegrity is a cRDSDbCheckBox
                        Entry_Item Snctable.Checkintegrity
                        Set Label to "Check For Database Table Layout Changes before Connecting Data"
                        Set Size to 10 233
                        Set Location to 10 78
                        Set peAnchors to anTopLeft
                    End_Object    

                    Object oSnctable_Notes is a cRDSDbEdit
                        Entry_Item Snctable.Notes
                        Set Label to "Notes"
                        Set Size to 130 374
                        Set Location to 22 78
                        Set peAnchors to anAll
                        Set Label_Col_Offset to 2
                        Set Label_Justification_Mode to jMode_Right
                    End_Object    

                    Procedure DoUpdateData Integer iFromFile Integer iToFile Boolean bFrom
                        Set Enabled_State of oSnctable_Checkintegrity to (iFromFile and iToFile)
                        Set Enabled_State of oSnctable_Notes          to (iFromFile and iToFile)
                    End_Procedure 
                End_Object    

            End_Object    

        End_Object    

        Object oCollections_tb is a cRDSDbTabPage
            Set Label to "2. Collections of Database Connections"
            Set Tab_ToolTip_Value to "Create/Edit Collections of Database Connection records for the CrossMerge Engine."
            Set piImageIndex to 1
            
            Object oCollections_grp is a cRDSDbGroup
                Set Size to 345 546
                Set Location to 1 3
                Set Label to "Collections"
                
                Object oInfo_tb is a cRDSTextbox
                    Set Label to "The CrossMerge Engine can..."
                    Set Auto_Size_State to False
                    Set Location to 13 7
                    Set Size to 18 533
                    Set Border_Style to Border_StaticEdge
                    Set Justification_Mode to jMode_Left

                    Procedure OnStartUp
                        String sText
                        Move "The CrossMerge Engine can be started with a Collection Name as a parameter on the command line. This is very useful when Windows Scheduled tasks is used to start the Engine at a predefined time." to sText
                        Move (sText * "A default Collection Name can be set on the 'CrossMerge Engine' tab-page.") to sText
                        Set Label to sText
                    End_Procedure 
                    Send OnStartUp

                End_Object    

                Object oSncSchem_grd is a cSyncTableCheckBoxGrid
                    Set Size to 289 454
                    Set Location to 33 7
                    Set peAnchors to anAll
                    Set peResizeColumn to rcAll
                    Set piResizeColumn to 2
                    Set phoDD to (SncTable_DD(Self))

                    Set Line_Width to 5 0

                    Set Form_Width    Item 0 to 37
                    Set Header_Label  Item 0 to "Selected"

                    Set Form_Width    Item 1 to 50
                    Set Header_Label  Item 1 to "Sort Name"

                    Set Form_Width    Item 2 to 260
                    Set Header_Label  Item 2 to "Database Connection Record (Description)"

                    Set Form_Width    Item 3 to 50
                    Set Header_Label  Item 3 to "Delete Source"

                    Set Form_Width    Item 4 to 50
                    Set Header_Label  Item 4 to "Delete Target"

                    Set pbSynchSetup   to True
                    Set psToolTipTitle to "Collections"
                    Set psToolTip      to "Select the connection records that should belong to the named or selected collection name in the combo below, and press the 'Save' button."

                    Procedure Select_Toggling Integer iItem Integer bState
                        Handle hoDD
                        Forward Send Select_Toggling iItem bState
                        Move (SncSchem_DD(Self)) to hoDD
                        // Do this to trigger a change in this DDO to auto save before
                        // the Engine is started.
                        Set Changed_State of hoDD to True
                    End_Procedure 
                End_Object    

                Object oSncSchem_cb is a cRDSComboForm
                    Set Label to "Collection Name"
                    Set Size to 13 220
                    Set Location to 326 66
                    Set Status_Help to "Create a new Collection Name; 1. Press the Clear button 2. Select items from the grid 3. Enter a descriptive Name 4. Press Save"
                    Set peAnchors to anBottomLeft
                    Set Form_Border to 0
                    Set Label_Col_Offset to 2
                    Set Label_Justification_Mode to jMode_Right

                    Procedure Combo_Fill_List
                        Send Combo_Delete_Data
                        Clear SncSchem
                        Find Gt SncSchem by Index.1
                        While (Found)
                            Send Combo_Add_Item (Trim(SncSchem.Name))
                            Find Gt SncSchem by Index.1
                        Loop 
                        Clear SncSchem
                    End_Procedure  

                    Procedure OnCloseUp
                        Integer iItem
                        String sValue
                        Handle hoDD
                        Forward Send OnCloseUp
                        Send StartWorkingMessage "Displaying Collection..."
                        Get WinCombo_Current_Item         to iItem
                        Get WinCombo_Value Item iItem     to sValue
                        Send DoFillGrid      of oSncSchem_grd
                        Send DoDisplayScheme of oSncSchem_grd sValue
                        Send StopWorkingMessage
                        Move (SncSchem_DD(Self)) to hoDD
                        Set Changed_State of hoDD to True
                    End_Procedure  

                    // Display default Collection Name on program startup.
                    Procedure OnStartup
                        Clear SncSchem
                        Move SncSys.Default_Scheme to SncSchem.Name
                        Find Eq SncSchem by Index.1
                        If (Found) Set Value Item 0 to (Trim(SncSchem.Name))
                        Clear SncSchem
                    End_Procedure  
                    Send OnStartup

                End_Object  

                Object oSelectAll_bn is a cBitmapButton
                    Set Label to "Select &All"
                    Set Size to 13 80
                    Set Location to 44 463
                    Set Status_Help to "Select all items in the grid"
                    Set peAnchors to anTopRight
                    Set Bitmap to "SelectAll16.bmp"
                    Set piTransparentColor to clFuchsia

                    Procedure OnClick
                        Send DoToggleAll of oSncSchem_grd 1
                    End_Procedure  
                End_Object   

                Object oDeselectAll_bn is a cBitmapButton
                    Set Label to "Select &None"
                    Set Size to 13 80
                    Set Location to 60 463
                    Set Status_Help to "De-select all items in the grid"
                    Set peAnchors to anTopRight
                    Set Bitmap to "SelectNone16.bmp"
                    Set piTransparentColor to clFuchsia

                    Procedure OnClick
                        Send DoToggleAll of oSncSchem_grd 0
                    End_Procedure 
                End_Object   

                Object oInvertSelection_bn is a cBitmapButton
                    Set Label to "&Invert Selection"
                    Set Size to 13 80
                    Set Location to 76 463
                    Set Status_Help to "Invert the selection order"
                    Set peAnchors to anTopRight
                    Set Bitmap to "SelectInvert16.bmp"
                    Set piTransparentColor to clFuchsia

                    Procedure OnClick
                        Send DoToggleAll of oSncSchem_grd -1
                    End_Procedure 
                End_Object    

                Object oSave_bn is a cBitmapButton
                    Set Label to "&Save"
                    Set Size to 13 54
                    Set Location to 326 291
                    Set Status_Help to "Save the entered Collection Name and it's grid selections"
                    Set peAnchors to anBottomLeft
                    Set Bitmap to "Save16.bmp"
                    Set piTransparentColor to clFuchsia

                    Procedure OnClick
                        Handle hoGrid hoSncSchem_cb hoDD
                        String sSncTables sName
                        Integer iRetval
                        Move (oSncSchem_grd(Self))    to hoGrid
                        Move (oSncSchem_cb(Self))     to hoSncSchem_cb
                        Move (SncSchem_DD(Self))      to hoDD
                        Get SelectedItems             of hoGrid to sSncTables
                        Get Value of hoSncSchem_cb Item 0       to sName
                        Move (Trim(sName))                      to sName
                        If (Length(sName) > 0) Begin
                            Send Clear                  of hoDD
                            Move sName                  to SncSchem.Name
                            Send Find                   of hoDD Eq Index.1
                            If not (Found) Send Clear   of hoDD
                        End 
                        Set File_Field_Changed_Value  of hoDD File_Field SncSchem.Name   to sName
                        Set File_Field_Changed_Value  of hoDD File_Field SncSchem.Tables to sSncTables
                        Get  Request_Validate         of hoDD to iRetval
                        If (iRetval <> 0) Procedure_Return
                        Send Request_Save             of hoDD
                        Send Combo_Fill_List          of hoSncSchem_cb          // Refill combo with new data.
                        Send Combo_Fill_List          of oDefaultSchemeName_cf  // On Default synch. settings tab-page.
                        Set Value                     of hoSncSchem_cb Item 0 to sName
                    End_Procedure 
                End_Object    

                Object oClear_bn is a cBitmapButton
                    Set Label to "New/&Clear"
                    Set Size to 13 60
                    Set Location to 326 347
                    Set Status_Help to "Clear selections and Collection name to create a new Collection Name"
                    Set peAnchors to anBottomLeft
                    Set Bitmap to "New16.bmp"
                    Set piTransparentColor to clFuchsia

                    Procedure OnClick
                        Send DoToggleAll of oSncSchem_grd (False)
                        Set Value        of oSncSchem_cb Item 0 to ""
                    End_Procedure 
                End_Object    

                Object oDelete_bn is a cBitmapButton
                    Set Label to "&Delete"
                    Set Size to 13 54
                    Set Location to 326 408
                    Set Status_Help to "Delete the selected Collection Name and it's grid selections"
                    Set peAnchors to anBottomLeft
                    Set Bitmap to "Delete16.bmp"
                    Set piTransparentColor to clFuchsia

                    Procedure OnClick
                        Integer hoDD ho
                        String sValue
                        Move (SncSchem_DD(Self))  to hoDD
                        Move (oSncSchem_cb(Self)) to ho
                        Get Value of ho Item 0    to sValue
                        Send Request_Clear        of hoDD
                        Move (Trim(sValue))       to SncSchem.Name
                        Send Find                 of hoDD Eq Index.1
                        If (Found) Begin
                            Send Request_Delete     of hoDD
                            Send Combo_Fill_List    of ho
                            Send DoDisplayScheme    of oSncSchem_grd ""
                        End 
                    End_Procedure 
                End_Object    

            End_Object    

            On_Key Key_Alt+Key_A Send KeyAction of oSelectAll_bn
            On_Key Key_Alt+Key_N Send KeyAction of oDeselectAll_bn
            On_Key Key_Alt+Key_I Send KeyAction of oInvertSelection_bn

            On_Key Key_Alt+Key_S Send KeyAction of oSave_bn
            On_Key Key_F2        Send KeyAction of oSave_bn
            On_Key Key_Alt+Key_C Send KeyAction of oClear_bn
            On_Key Key_F5        Send KeyAction of oClear_bn
            On_Key Key_Alt+Key_D Send KeyAction of oDelete_bn
            On_Key Key_Shift+Key_F2 Send KeyAction of oDelete_bn
        End_Object    

        Object oRun_TP is a cRDSDbTabPage
            Set Label to "3. CrossMerge Engine"
            Set Tab_ToolTip_Value to "Set up defaults for and schedule when to run the CrossMerge Engine."
            Set piImageIndex to 2
            
            Object oGlobal_grp is a cRDSDbGroup
                Set Size to 116 546
                Set Location to 1 3
                Set peAnchors to anTopLeftRight
                Set Label to "Default CrossMerge Engine Settings"
                Property String psWarning "WARNING!\n If you un-check this choice, there will be no way of cancelling the synchronize process until it has finished."

                Object oDefaultSchemeName_cf is a cRDSComboForm
                    Set Label to "Default Collection"
                    Set Size to 13 200
                    Set Location to 10 78
                    Set Status_Help to "Use this default Collection Name for the CrossMerge Engine program"
                    Set Form_Border to 0
                    Set Label_Col_Offset to 2
                    Set Label_Justification_Mode to jMode_Right
                    Set Entry_State Item 0 to False
                    Set Combo_Sort_State to False
                    Set Entry_State Item 0 to False
                    Property Boolean pbFirst True

                    // Combo_Fill_List is called when the list needs filling
                    Procedure Combo_Fill_List
                        Handle hoDD
                        Move (SncSchem_DD(Self)) to hoDD
                        Send Combo_Delete_Data
                        Send Combo_Add_Item " <None>"
                        Send Clear               of hoDD
                        Send Find                of hoDD First_Record Index.1
                        While (Found)
                            Send Combo_Add_Item (Trim(SncSchem.Name))
                            Send Find              of hoDD Next_Record Index.1
                        Loop
                        Send Clear               of hoDD
                        Set Value Item 0 to (Trim(SncSys.Default_Scheme))
                    End_Procedure  

                    // We may need to refresh the list if new records
                    // have been created with the Scheme program.
                    Procedure OnDropDOwn
                        Send Combo_Fill_List
                    End_Procedure

                    // Notification of a selection change.
                    Procedure OnChange
                        Handle hoDD
                        Integer iItem
                        String sValue
                        If (pbFirst(Self)) Begin // Do not set Enabled_State of oApply_bn on program startup.
                            Set pbFirst to False
                            Procedure_Return
                        End  
                        Move (SncSys_DD(Self))        to hoDD
                        Get WinCombo_Current_Item     to iItem
                        Get WinCombo_Value Item iItem to sValue
                        If (Trim(SncSys.Default_Scheme) <> Trim(sValue)) Begin
                            Set Field_Changed_Value of hoDD Field SncSys.Default_Scheme to sValue
                            Set Enabled_State of oApply_bn to True
                        End
                    End_Procedure  
                End_Object    

                Object oSncsys_Dsn_Names is a cRDSDbForm
                    Entry_Item Sncsys.Dsn_names
                    Set Server to Sncsys_DD
                    Set Label to "Check ODBC DSN's"
                    Set Size to 13 432
                    Set Location to 25 78
                    Set peAnchors to anLeftRight
                    Set Label_Col_Offset to 2
                    Set Label_Justification_Mode to jMode_Right

                    Procedure OnChange
                        Boolean bState
                        Get Changed_State of (SncSys_DD(Self)) to bState
                        Set Enabled_State of oApply_bn to bState
                    End_Procedure 
                End_Object    

                Object oSncsys_Allowtblchange is a cSysDbCheckBox
                    Entry_Item Sncsys.Allowtblchange
                    Set Server to Sncsys_DD
                    Set Label to "Allow user to change selections of Database Table items (left checkbox column)"
                    Set Size to 10 268
                    Set Location to 40 78
                End_Object    

                Object oSncsys_Allowautodelete is a cSysDbCheckBox
                    Entry_Item Sncsys.Allowautodelete
                    Set Server to Sncsys_DD
                    Set Label to "Allow user to change ' Auto Delete' (right checkbox column)"
                    Set Size to 10 204
                    Set Location to 52 78
                End_Object    

                Object oSncsys_Show_Info is a cSysDbCheckBox
                    Entry_Item Sncsys.Show_info
                    Set Server to Sncsys_DD
                    Set Label to "Display status panel with info while CrossMerge Engine is running"
                    Set Size to 10 221
                    Set Location to 64 78

                    Procedure Select_Toggling Integer iItem Integer bState
                        Forward Send Select_Toggling iItem bState
                        Get Select_State Item 0 to bState
                        If not bState Send Info_Box (psWarning(Self)) // Group property
                        Set Enabled_State of oSncSys_AllowCancelSent to bState
                    End_Procedure
                End_Object    

                Object oSncsys_Allowcancelsent is a cSysDbCheckBox
                    Entry_Item Sncsys.Allowcancelsent
                    Set Server to Sncsys_DD
                    Set Label to "Allow to cancel running of the CrossMerge Engine"
                    Set Size to 10 173
                    Set Location to 76 78
                    Set Enabled_State to SncSys.Show_Info

                    Procedure Select_Toggling Integer iItem Integer bState
                        Forward Send Select_Toggling iItem bState
                        Get Select_State Item 0 to bState
                        If not bState Send Info_Box (psWarning(Self)) // Group property
                    End_Procedure
                End_Object    

                Object oSncsys_Allowdeletelog is a cSysDbCheckBox
                    Entry_Item Sncsys.Allowdeletelog
                    Set Server to Sncsys_DD
                    Set Label to "Allow delete of the connection log"
                    Set Size to 10 123
                    Set Location to 88 78
                End_Object    

                Object oSncsys_Runminimized is a cSysDbCheckBox
                    Entry_Item Sncsys.Runminimized
                    Set Server to Sncsys_DD
                    Set Label to "Run Program Minimized when scheduled to Autorun"
                    Set Size to 10 179
                    Set Location to 100 78
                End_Object    

                Object oApply_bn is a cBitmapButton
                    Set Label to "&Apply"
                    Set Size to 13 50
                    Set Location to 95 480
                    Set Status_Help to "Apply/Save changes"
                    Set peAnchors to anBottomRight
                    Set Bitmap to "Ok16.bmp"
                    Set piTransparentColor to clFuchsia

                    Set Enabled_State to False

                    Procedure OnClick
                        Handle hoDD
                        Boolean bChanged
                        Move (SncSys_DD(Self))   to hoDD
                        Get Changed_State        of hoDD to bChanged
                        If not bChanged Procedure_Return
                        Send Request_Save        of hoDD
                        Set Enabled_State to False
                    End_Procedure 

                End_Object    

                On_Key Key_F2         Send KeyAction of oApply_bn
                On_Key Key_Alt+Key_A  Send KeyAction of oApply_bn
                On_Key Key_Ctrl+Key_S Send KeyAction of oApply_bn
            End_Object    

            Object oProgramStart_grp is a cRDSDbGroup
                Set Size to 100 546
                Set Location to 122 3
                Set peAnchors to anTopLeftRight
                Set Label to "Start Programs"
                
                Object oScheduledTasksHelp_Bn is a cBitmapButton
                    Set Label to "Help on how to Create a Win&dows Scheduled Task"
                    Set Size to 25 219
                    Set Location to 11 98
                    Set Status_Help to "Display Help on how to Auto Start the CrossMerge Engine program with Windows Scheduled tasks."
                    Set Help_Id to WinScheduledTask
                    Set Bitmap to "Help32.bmp"
                    Set piTransparentColor to clFuchsia

                    Procedure OnClick
                        Send DoShowMapID of ghoHtmlHelp WinScheduledTask
                    End_Procedure 
                End_Object    

                Object oScheduledTasks_bn is a cBitmapButton
                    Set Label to "Start Windows Scheduled &Tasks"
                    Set Size to 25 219
                    Set Location to 40 98
                    Set Status_Help to "Create a scheduled activity to automatically run the CrossMerge Engine program"
                    Set Bitmap to "SchedTask32.bmp"
                    Set piTransparentColor to clFuchsia

                    Procedure OnClick
                        Handle hoPanel
                        Get Create U_cControlPanel to hoPanel
                        If (hoPanel <> 0) Begin
                            Send OpenScheduledTasks  of hoPanel
                            Send Destroy             of hoPanel
                        End 
                    End_Procedure 
                End_Object    

                Object oSynchronizeProgram_bn is a cBitmapButton
                    Set Label to "Start the CrossMerge &Engine"
                    Set Size to 25 219
                    Set Location to 69 98
                    Set Status_Help to "Start the CrossMerge Engine program manually to synchronize data."
                    Set Bitmap to "CmEngine32.bmp"
                    Set piTransparentColor to clFuchsia

                    Procedure OnClick
                        Boolean bSave
                        String sPath
                        Integer iRetval
                        Get Should_Save of (Main_DD(Self)) to bSave
                        If (bSave = False) Get Should_Save of (SncSys_DD(Self))   to bSave
                        If (bSave = False) Get Should_Save of (SncSchem_DD(Self)) to bSave
                        If (bSave = True) Begin
                            Get YesNo_Box "Changes exist. Save them first?" to iRetval
                            If (iRetval = Mbr_Yes) Send Request_Save
                        End 
                        Move (psProgramPath(phoWorkspace(ghoApplication))) to sPath
                        Send vShellExecute "open" "CMEngine.exe" "" sPath
                    End_Procedure 
                End_Object    

                Object oDummy_fm is a cRDSForm
                    Set Size to 13 2
                    Set Location to 150 444
                    Set Label_Col_Offset to 2
                    Set Label_Justification_Mode to jMode_Right
                End_Object    

            End_Object    

            On_Key Key_Alt+Key_D  Send KeyAction of oScheduledTasksHelp_Bn
            On_Key Key_Alt+Key_T  Send KeyAction of oScheduledTasks_bn
            On_Key Key_Alt+Key_E  Send KeyAction of oSynchronizeProgram_bn
        End_Object    

        Object oLog_tp is a cRDSDbTabPage
            Set Label to "4. View Log"
            Set Tab_ToolTip_Value to "View Log records created by the CrossMerge Engine"
            Set piImageIndex to 3
            
            Object oSncLog_grd is a cRDSDbList
                Set Entry_msg to DoDisableToolbarButtons
                Set Exit_msg  to DoEnableToolbarButtons
                Set Main_File to Snclog.File_Number
                Set Server to Snclog_DD
                Set Ordering to 1
                Set Size to 258 544
                Set Location to 4 4
                Set peDisabledTextColor to clWindowText
                Set peAnchors to anAll
                Set peResizeColumn to rcSelectedColumn
                Set piResizeColumn to 2
                Set pbHeaderTogglesDirection to True
                Set pbReverseOrdering to True
                Set Auto_Column_State to False
                Set Move_Value_Out_State to False

                Begin_Row
                    Entry_Item Snclog.Recid
                    Entry_Item (Snclog.Recid)
                    Entry_Item Snclog.Statustext
                    Entry_Item Snclog.Tablename
                    Entry_Item Snclog.DateTime
                    Entry_Item Snclog.Networkusername
                End_Row

                Set Form_Width   Item 0 to 30
                Set Header_Label Item 0 to "Log ID"

                Set Form_Width   Item 1 to 29
                Set Header_Label Item 1 to "Status"

                Set Form_Width   Item 2 to 189
                Set Header_Label Item 2 to "Status Text"

                Set Form_Width   Item 3 to 170
                Set Header_Label Item 3 to "Database Connection"

                Set Form_Width   Item 4 to 72
                Set Header_Label Item 4 to "Date and Time"

                Set Form_Width   Item 5 to 49
                Set Header_Label Item 5 to "User Name"

                Set Popup_State to False
                Set psToolTipTitle to "Connection Log"
                Set psToolTip to "Each activity by the CrossMerge Engine is logged automatically to a log file. The latest entry is shown at the top of the list. For details about a selected log record, see the bottom part."

                Procedure Entry_Display Integer iFile Integer iType
                    Integer iBase_Item iItem
                    String sValue
                    Forward Send Entry_Display iFile iType
                    Get Base_Item to iBase_Item
                    If (iBase_Item < 0) Procedure_Return
                    Increment iBase_Item
                    Set Value Item iBase_Item to ""
                    Get Value Item (iBase_Item + 1) to sValue
                    If (Uppercase(sValue) contains "ERROR") ;
                        Set Form_Bitmap Item iBase_Item to "Error.bmp/t"
                    Else If (Uppercase(sValue) contains "WARNING") ;
                        Set Form_Bitmap Item iBase_Item to "Warning.bmp/t"
                    Else ;
                        Set Form_Bitmap Item iBase_Item to "Info.bmp/t"
                End_Procedure 

                // Do this when reordering so the first column doesn't always take the focus:
                //Procedure OnBeginningofPanel
                //  Send DoMakeColumnVisible 0
                //End_Procedure

                Procedure DoEnableToolbarButtons
                    Handle ho
                    Move (oToolBar(Self)) to ho
                    If ho Begin
                        Get phoCut          to ho
                        If ho Set pbEnabled of ho to True
                        Get phoCopy         to ho
                        If ho Set pbEnabled of ho to True
                        Get phoPaste        to ho
                        If ho Set pbEnabled of ho to True
                    End 
                End_Procedure 

                Procedure DoDisableToolbarButtons
                    Handle ho
                    Move (oToolBar(Self)) to ho
                    If ho Begin
                        Get phoCut          to ho
                        If ho Set pbEnabled of ho to False
                        Get phoCopy         to ho
                        If ho Set pbEnabled of ho to False
                        Get phoPaste        to ho
                        If ho Set pbEnabled of ho to False
                    End 
                End_Procedure 

                Procedure DoDeleteRecord
                    Integer iRow
                    Get Current_Row  to iRow
                    Set Dynamic_Update_State to False
                    Send Request_Delete of SncLog_DD
                    If (iRow = 0) Send Beginning_Of_Data
                    Else Begin
                        Send Up_Row
                        Send Refresh_Page iRow 0
                    End 
                    Set Dynamic_Update_State to True
                    Send DoSetRecordCount of oCurrentRecords_fm
                End_Procedure 

                On_Key Key_Ctrl+Key_X Send DoDeleteRecord
                On_Key kDelete_Record Send DoDeleteRecord
                On_Key kEnter         Send msg_None
            End_Object    

            Object oSnclog_Statustext is a cRDSDbEdit
                Entry_Item Snclog.Statustext
                Set Server to Snclog_DD
                Set Label to "Status Text"
                Set Size to 33 471
                Set Location to 266 78
                Set peAnchors to anBottomLeftRight
                Set Label_Row_Offset to 0
                Set Label_Col_Offset to 2
                Set Label_Justification_Mode to jMode_Right
                Set Enabled_State to False
            End_Object    

            Object oSnclog_Tablename is a cRDSDbForm
                Entry_Item Snclog.Tablename
                Set Server to Snclog_DD
                Set Label to "Database Connection"
                Set Size to 13 471
                Set Location to 301 78
                Set peAnchors to anBottomLeftRight
                Set Label_Col_Offset to 2
                Set Label_Justification_Mode to jMode_Right
                Set Enabled_State to False
            End_Object    

            Object oSnclog_Datetime is a cRDSDbForm
                Entry_Item Snclog.DateTime
                Set Server to Snclog_DD
                Set Label to "Date and Time"
                Set Size to 13 75
                Set Location to 316 78
                Set peAnchors to anBottomLeft
                Set Label_Col_Offset to 2
                Set Label_Justification_Mode to jMode_Right
                Set Enabled_State to False
            End_Object    

            Object oSnclog_Networkusername is a cRDSDbForm
                Entry_Item Snclog.Networkusername
                Set Server to Snclog_DD
                Set Label to "User Name"
                Set Size to 13 95
                Set Location to 316 198
                Set peAnchors to anBottomLeft
                Set Label_Col_Offset to 2
                Set Label_Justification_Mode to jMode_Right
                Set Enabled_State to False
            End_Object    

            Object oCurrentRecords_fm is a cRDSForm
                Set Label to "Number of Log Records"
                Set Size to 13 43
                Set Location to 316 393
                Set Status_Help to "Current number of Log records."
                Set peAnchors to anBottomRight
                Set Label_Col_Offset to 2
                Set Label_Justification_Mode to jMode_Right
                Set Form_Datatype Item 0 to Mask_Numeric_Window
                Set Form_Mask     Item 0 to "#,###########"
                Set Enabled_State to False

                Procedure DoSetRecordCount
                    Integer iRecords
                    Get_Attribute DF_FILE_RECORDS_USED of SncLog.File_Number to iRecords
                    Set Value Item 0 to iRecords
                End_Procedure  
                Send DoSetRecordCount

            End_Object    

            Object oMaxRecords_fm is a cRDSForm
                Set Label to "Max no of Records"
                Set Size to 13 43
                Set Location to 316 506
                Set Status_Help to "Maximum number of records the log can contain."
                Set peAnchors to anBottomRight
                Set Label_Col_Offset to 2
                Set Label_Justification_Mode to jMode_Right
                Set Form_Datatype Item 0 to Mask_Numeric_Window
                Set Form_Mask     Item 0 to "#,###########"
                Set Enabled_State to False

                Procedure DoSetRecordCount
                    Integer iRecords
                    Get_Attribute DF_FILE_MAX_RECORDS of SncLog.File_Number to iRecords
                    Set Value Item 0 to iRecords
                End_Procedure  
                Send DoSetRecordCount

            End_Object    

            Object oDeleteLog_bn is a cZeroLogBn
                Set Label to "&Delete Log"
                Set Size to 13 63
                Set Location to 332 486
                Set Status_Help to "Press to delete all records in the log."
                Set peAnchors to anBottomRight
                Set Bitmap to "Delete16.bmp"
            End_Object    

            Set Popup_State to False
            On_Key Key_Alt+Key_D Send KeyAction of oDeleteLog_bn

        End_Object    

        Procedure Request_Switch_To_Tab Integer iPageNumber Integer iMode
            Handle hoDD ho
            Integer iRecnum
            // Collection tab page:
            If (iPageNumber = 1) Begin
                Send DoInitGrid of oSncSchem_grd
                Send OnStartup  of oSncSchem_cb
            End 
            // Tell sysfile DDO to reread on tab page changes.
            // Needed if changes have been made in other programs:
            Else If (iPageNumber = 2) Begin
                Move (SncSys_DD(Self)) to hoDD
                If hoDD Begin
                    Get Field_Current_Value of hoDD Field SncSys.Recnum to iRecnum
                    Send Find_By_Recnum     of hoDD SncSys.File_Number iRecnum
                End
            Else End 
            Else If (iPageNumber = 3) Begin
                Move (oSncLog_grd(oLog_tp(Self))) to ho
                If ho Begin
                    Send Beginning_Of_Data of ho
                    Broadcast Recursive Send DoSetRecordCount // Will update SncLog counter fields.
                End 
            End 
            Forward Send Request_Switch_To_Tab iPageNumber iMode
        End_Procedure 
    
    End_Object    

    Procedure DoSave
        Handle hoDD
        Get Main_DD       to hoDD
        Send Request_Save
    End_Procedure

    Procedure Request_Save
        Boolean bSave
        Forward Send Request_Save
        Get Should_Save of (SncSys_DD(Self)) to bSave
        If (bSave = True) Send Request_Save of (Sncsys_DD(Self))
        Get Should_Save of (SncSchem_DD(Self)) to bSave
        If (bSave = True) Send KeyAction of (oSave_bn(oCollections_tb(oRDS_td(Self))))
    End_Procedure 

    Procedure Request_Clear
        Forward Send Request_Clear
        Send Activate of oSnctable_Recid
    End_Procedure 

    Function DisplayDeleteWaring Returns Boolean
        String sText
        Integer iRetval
        Move "If you delete a record that has been included in a Collection name it will 'mess up' the Collection data for selected Table Setup records." to sText
        Move (sText * "If you do, you might need to edit selections for each Collection name .") to sText
        Move (sText + "\n\nActually, the last selected record for each Collection name will be removed automatically.")       to sText
        Move (sText + "\nNote:  If this is the last record for a Collection name the Collection record itself will be deleted.\n\nContinue to Delete Record?") to sText
        Get YesNo_Box sText "Delete question" to iRetval
        Function_Return (iRetval <> MBR_YES)
    End_Function 

    Set Verify_Delete_msg    to get_DisplayDeleteWaring
    Set Verify_Save_msg      to msg_None

    // Do not allow to close panel:
    Procedure Request_Cancel
    End_Procedure 

    Procedure CancelWizard // This is needed by the cdbComboFormat & cdbComboDriver classes.
    End_Procedure 

    Function RdsMain_Panel_Id Returns Integer
        Function_Return Self
    End_Function

    Procedure DoStartWizard
        //Send Popup of (oConnectDbWizard(Self))
    End_Procedure 

    Procedure DoStartEngine
        String sPath
        Move (psProgramPath(phoWorkspace(ghoApplication))) to sPath
        Send vShellExecute "open" "CMEngine.exe" "" sPath
    End_Procedure 

    Procedure DoHelp
        Send DoShowMapID of ghoHtmlHelp GeneralHelpId
    End_Procedure 

    Function Item_Count Returns Integer
    End_Function 

    On_Key Key_Ctrl+Key_S Send DoSave
    On_Key Key_F1         Send DoHelp
    On_Key Key_Alt+Key_H  Send DoHelp
    On_Key Key_Alt+Key_P  Send DoPopupProperties //Popup of oProperties_dg
    On_Key Key_Alt+Key_E  Send DoStartEngine
    On_Key Key_Alt+Key_B  Send Activate_About

    Set phoClient of ghoApplication to Self

    //    End_Object

Use SDIStatusbar.pkg  //  Status-Bar object.

    Procedure Activate_About
        //      Send Popup of (oAboutDialog(oClientArea(Self)))
    End_Procedure 

    // Function override.
    // This has been changed into getting data_loss confirmation of the
    // SDI view of this application. This is needed since the
    // Procedure Request_Cancel has been killed in the view to avoid
    // user closing the view, which makes no sense in a SDI application.
    Function Verify_Exit_Application Returns Integer
        Integer iRetval
        //      Get xExit_Loss_Confirmation of (oRdcView(oClientArea(Self))) to iRetval
        Function_Return iRetval
    End_Function 

    Object oHtmlHelp is A cHtmlHelpNew
        Set psHelpFile          to "CrossMerge.chm"
    End_Object 

    //Set View_Mode of (oRdcView(Client_Id(Self))) to Viewmode_Zoom
    //  // Old logic:
    //Use RDSPanelSizeLoc.pkg // Auto size and location of program container to the SDI view.
    //Send DoSetPanelSize 0 (oPropertiesToolBar(oPropertiesRebarBand(oToolBar(Self)))) (oProperties_bn(oPropertiesToolBar(oPropertiesRebarBand(oToolBar(Self))))) (oRdcView(oClientArea(Self))) (oStatusbar(Self))

End_Object   

// We need this right after Main panel has been activated.
// For some reason it jumps a bit to the lower right, hence the adjustment.
//Send DoReLocateSplashScreen of (oSplashScreen(Self))
//Send Activate_oRdcView      of (oClientArea(oMain(Self)))
//Send Destroy                of (oSplashScreen(Self))  // Remove splash screen.

//If (phoLfile(ghoApplication) = 0) Begin
//  Send Info_Box "A reboot of the machine is necessary if this is the first time CrossMerge is started after installation. Else an important component of CrossMerge is missing and the program will be aborted and you will need to re-install CrossMerge."
//  Abort
//End // If (phoLfile(ghoApplication) = 0) Begin

Procedure DoInitLabel Global
    String  sText
    Set Label of oMain to ;
    (psProduct(ghoApplication) * psProgram(ghoApplication))
    //     * "-" * psLicenseType(ghoApplication) * ;
    //    "*** Registered to" * psName(ghoApplication) * "***" * "Serial number" * String(psSerial(ghoApplication)))
End_Procedure // DoInitLabel
Send DoInitLabel

//If (SncSys.UseLogin = 1) Send Popup of (oPassword_dg(oClientArea(oMain(Self))))

// About dialog update procedure.
// Must be placed after activation of the main view because it is there
// the Protection Plus logic is activated and info from there is used
// in the about object:
//Send DoUpdateAbout    of (oClientArea(oMain(Self)))

// Only allow one instance of the program running on a machine. Auto-close the second instance.
Start_UI_Exclusive 
